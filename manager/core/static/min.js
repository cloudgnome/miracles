/*! jQuery v1.11.2 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l="1.11.2",m=function(a,b){return new m.fn.init(a,b)},n=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,o=/^-ms-/,p=/-([\da-z])/gi,q=function(a,b){return b.toUpperCase()};m.fn=m.prototype={jquery:l,constructor:m,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=m.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return m.each(this,a,b)},map:function(a){return this.pushStack(m.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},m.extend=m.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||m.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(m.isPlainObject(c)||(b=m.isArray(c)))?(b?(b=!1,f=a&&m.isArray(a)?a:[]):f=a&&m.isPlainObject(a)?a:{},g[d]=m.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},m.extend({expando:"jQuery"+(l+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===m.type(a)},isArray:Array.isArray||function(a){return"array"===m.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!m.isArray(a)&&a-parseFloat(a)+1>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==m.type(a)||a.nodeType||m.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(k.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(b){b&&m.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(o,"ms-").replace(p,q)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=r(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(n,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(r(Object(a))?m.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=r(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),m.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||m.guid++,e):void 0},now:function(){return+new Date},support:k}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function r(a){var b=a.length,c=m.type(a);return"function"===c||m.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var s=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=hb(),z=hb(),A=hb(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ab=/[+~]/,bb=/'|\\/g,cb=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),db=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},eb=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fb){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function gb(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(bb,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+rb(o[l]);w=ab.test(a)&&pb(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function hb(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ib(a){return a[u]=!0,a}function jb(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function kb(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function lb(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function mb(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function nb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function ob(a){return ib(function(b){return b=+b,ib(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pb(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=gb.support={},f=gb.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=gb.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",eb,!1):e.attachEvent&&e.attachEvent("onunload",eb)),p=!f(g),c.attributes=jb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=jb(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=jb(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(cb,db);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(jb(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),jb(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&jb(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return lb(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?lb(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},gb.matches=function(a,b){return gb(a,null,null,b)},gb.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return gb(b,n,null,[a]).length>0},gb.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},gb.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},gb.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},gb.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=gb.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=gb.selectors={cacheLength:50,createPseudo:ib,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(cb,db),a[3]=(a[3]||a[4]||a[5]||"").replace(cb,db),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||gb.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&gb.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(cb,db).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=gb.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||gb.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ib(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ib(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ib(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ib(function(a){return function(b){return gb(a,b).length>0}}),contains:ib(function(a){return a=a.replace(cb,db),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ib(function(a){return W.test(a||"")||gb.error("unsupported lang: "+a),a=a.replace(cb,db).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:ob(function(){return[0]}),last:ob(function(a,b){return[b-1]}),eq:ob(function(a,b,c){return[0>c?c+b:c]}),even:ob(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:ob(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:ob(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:ob(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=mb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=nb(b);function qb(){}qb.prototype=d.filters=d.pseudos,d.setFilters=new qb,g=gb.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?gb.error(a):z(a,i).slice(0)};function rb(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function tb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ub(a,b,c){for(var d=0,e=b.length;e>d;d++)gb(a,b[d],c);return c}function vb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wb(a,b,c,d,e,f){return d&&!d[u]&&(d=wb(d)),e&&!e[u]&&(e=wb(e,f)),ib(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ub(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:vb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=vb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=vb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xb(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sb(function(a){return a===b},h,!0),l=sb(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sb(tb(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wb(i>1&&tb(m),i>1&&rb(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xb(a.slice(i,e)),f>e&&xb(a=a.slice(e)),f>e&&rb(a))}m.push(c)}return tb(m)}function yb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=vb(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&gb.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ib(f):f}return h=gb.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xb(b[c]),f[u]?d.push(f):e.push(f);f=A(a,yb(e,d)),f.selector=a}return f},i=gb.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(cb,db),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(cb,db),ab.test(j[0].type)&&pb(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&rb(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,ab.test(a)&&pb(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=jb(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),jb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||kb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&jb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||kb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),jb(function(a){return null==a.getAttribute("disabled")})||kb(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),gb}(a);m.find=s,m.expr=s.selectors,m.expr[":"]=m.expr.pseudos,m.unique=s.uniqueSort,m.text=s.getText,m.isXMLDoc=s.isXML,m.contains=s.contains;var t=m.expr.match.needsContext,u=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,v=/^.[^:#\[\.,]*$/;function w(a,b,c){if(m.isFunction(b))return m.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return m.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(v.test(b))return m.filter(b,a,c);b=m.filter(b,a)}return m.grep(a,function(a){return m.inArray(a,b)>=0!==c})}m.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?m.find.matchesSelector(d,a)?[d]:[]:m.find.matches(a,m.grep(b,function(a){return 1===a.nodeType}))},m.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(m(a).filter(function(){for(b=0;e>b;b++)if(m.contains(d[b],this))return!0}));for(b=0;e>b;b++)m.find(a,d[b],c);return c=this.pushStack(e>1?m.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(w(this,a||[],!1))},not:function(a){return this.pushStack(w(this,a||[],!0))},is:function(a){return!!w(this,"string"==typeof a&&t.test(a)?m(a):a||[],!1).length}});var x,y=a.document,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=m.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||x).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof m?b[0]:b,m.merge(this,m.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:y,!0)),u.test(c[1])&&m.isPlainObject(b))for(c in b)m.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=y.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return x.find(a);this.length=1,this[0]=d}return this.context=y,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):m.isFunction(a)?"undefined"!=typeof x.ready?x.ready(a):a(m):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),m.makeArray(a,this))};A.prototype=m.fn,x=m(y);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};m.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!m(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),m.fn.extend({has:function(a){var b,c=m(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(m.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=t.test(a)||"string"!=typeof a?m(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&m.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?m.unique(f):f)},index:function(a){return a?"string"==typeof a?m.inArray(this[0],m(a)):m.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(m.unique(m.merge(this.get(),m(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}m.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return m.dir(a,"parentNode")},parentsUntil:function(a,b,c){return m.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return m.dir(a,"nextSibling")},prevAll:function(a){return m.dir(a,"previousSibling")},nextUntil:function(a,b,c){return m.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return m.dir(a,"previousSibling",c)},siblings:function(a){return m.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return m.sibling(a.firstChild)},contents:function(a){return m.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:m.merge([],a.childNodes)}},function(a,b){m.fn[a]=function(c,d){var e=m.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=m.filter(d,e)),this.length>1&&(C[a]||(e=m.unique(e)),B.test(a)&&(e=e.reverse())),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return m.each(a.match(E)||[],function(a,c){b[c]=!0}),b}m.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):m.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){m.each(b,function(b,c){var d=m.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&m.each(arguments,function(a,c){var d;while((d=m.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?m.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},m.extend({Deferred:function(a){var b=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return m.Deferred(function(c){m.each(b,function(b,f){var g=m.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&m.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?m.extend(a,d):d}},e={};return d.pipe=d.then,m.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&m.isFunction(a.promise)?e:0,g=1===f?a:m.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&m.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;m.fn.ready=function(a){return m.ready.promise().done(a),this},m.extend({isReady:!1,readyWait:1,holdReady:function(a){a?m.readyWait++:m.ready(!0)},ready:function(a){if(a===!0?!--m.readyWait:!m.isReady){if(!y.body)return setTimeout(m.ready);m.isReady=!0,a!==!0&&--m.readyWait>0||(H.resolveWith(y,[m]),m.fn.triggerHandler&&(m(y).triggerHandler("ready"),m(y).off("ready")))}}});function I(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",J,!1),a.removeEventListener("load",J,!1)):(y.detachEvent("onreadystatechange",J),a.detachEvent("onload",J))}function J(){(y.addEventListener||"load"===event.type||"complete"===y.readyState)&&(I(),m.ready())}m.ready.promise=function(b){if(!H)if(H=m.Deferred(),"complete"===y.readyState)setTimeout(m.ready);else if(y.addEventListener)y.addEventListener("DOMContentLoaded",J,!1),a.addEventListener("load",J,!1);else{y.attachEvent("onreadystatechange",J),a.attachEvent("onload",J);var c=!1;try{c=null==a.frameElement&&y.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!m.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}I(),m.ready()}}()}return H.promise(b)};var K="undefined",L;for(L in m(k))break;k.ownLast="0"!==L,k.inlineBlockNeedsLayout=!1,m(function(){var a,b,c,d;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",k.inlineBlockNeedsLayout=a=3===b.offsetWidth,a&&(c.style.zoom=1)),c.removeChild(d))}),function(){var a=y.createElement("div");if(null==k.deleteExpando){k.deleteExpando=!0;try{delete a.test}catch(b){k.deleteExpando=!1}}a=null}(),m.acceptData=function(a){var b=m.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute("classid")===b};var M=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,N=/([A-Z])/g;function O(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(N,"-$1").toLowerCase();if(c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:M.test(c)?m.parseJSON(c):c}catch(e){}m.data(a,b,c)}else c=void 0}return c}function P(a){var b;for(b in a)if(("data"!==b||!m.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function Q(a,b,d,e){if(m.acceptData(a)){var f,g,h=m.expando,i=a.nodeType,j=i?m.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||m.guid++:h),j[k]||(j[k]=i?{}:{toJSON:m.noop}),("object"==typeof b||"function"==typeof b)&&(e?j[k]=m.extend(j[k],b):j[k].data=m.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[m.camelCase(b)]=d),"string"==typeof b?(f=g[b],null==f&&(f=g[m.camelCase(b)])):f=g,f}}function R(a,b,c){if(m.acceptData(a)){var d,e,f=a.nodeType,g=f?m.cache:a,h=f?a[m.expando]:m.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){m.isArray(b)?b=b.concat(m.map(b,m.camelCase)):b in d?b=[b]:(b=m.camelCase(b),b=b in d?[b]:b.split(" ")),e=b.length;while(e--)delete d[b[e]];if(c?!P(d):!m.isEmptyObject(d))return}(c||(delete g[h].data,P(g[h])))&&(f?m.cleanData([a],!0):k.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return a=a.nodeType?m.cache[a[m.expando]]:a[m.expando],!!a&&!P(a)},data:function(a,b,c){return Q(a,b,c)},removeData:function(a,b){return R(a,b)},_data:function(a,b,c){return Q(a,b,c,!0)},_removeData:function(a,b){return R(a,b,!0)}}),m.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=m.data(f),1===f.nodeType&&!m._data(f,"parsedAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=m.camelCase(d.slice(5)),O(f,d,e[d])));m._data(f,"parsedAttrs",!0)}return e}return"object"==typeof a?this.each(function(){m.data(this,a)}):arguments.length>1?this.each(function(){m.data(this,a,b)}):f?O(f,a,m.data(f,a)):void 0},removeData:function(a){return this.each(function(){m.removeData(this,a)})}}),m.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=m._data(a,b),c&&(!d||m.isArray(c)?d=m._data(a,b,m.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=m.queue(a,b),d=c.length,e=c.shift(),f=m._queueHooks(a,b),g=function(){m.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return m._data(a,c)||m._data(a,c,{empty:m.Callbacks("once memory").add(function(){m._removeData(a,b+"queue"),m._removeData(a,c)})})}}),m.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?m.queue(this[0],a):void 0===b?this:this.each(function(){var c=m.queue(this,a,b);m._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&m.dequeue(this,a)})},dequeue:function(a){return this.each(function(){m.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=m.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=m._data(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var S=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===m.css(a,"display")||!m.contains(a.ownerDocument,a)},V=m.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===m.type(c)){e=!0;for(h in c)m.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,m.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(m(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},W=/^(?:checkbox|radio)$/i;!function(){var a=y.createElement("input"),b=y.createElement("div"),c=y.createDocumentFragment();if(b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",k.leadingWhitespace=3===b.firstChild.nodeType,k.tbody=!b.getElementsByTagName("tbody").length,k.htmlSerialize=!!b.getElementsByTagName("link").length,k.html5Clone="<:nav></:nav>"!==y.createElement("nav").cloneNode(!0).outerHTML,a.type="checkbox",a.checked=!0,c.appendChild(a),k.appendChecked=a.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,c.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,k.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){k.noCloneEvent=!1}),b.cloneNode(!0).click()),null==k.deleteExpando){k.deleteExpando=!0;try{delete b.test}catch(d){k.deleteExpando=!1}}}(),function(){var b,c,d=y.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(k[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),k[b+"Bubbles"]=d.attributes[c].expando===!1);d=null}();var X=/^(?:input|select|textarea)$/i,Y=/^key/,Z=/^(?:mouse|pointer|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=/^([^.]*)(?:\.(.+)|)$/;function ab(){return!0}function bb(){return!1}function cb(){try{return y.activeElement}catch(a){}}m.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=m.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof m===K||a&&m.event.triggered===a.type?void 0:m.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||"").match(E)||[""],h=b.length;while(h--)f=_.exec(b[h])||[],o=q=f[1],p=(f[2]||"").split(".").sort(),o&&(j=m.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=m.event.special[o]||{},l=m.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&m.expr.match.needsContext.test(e),namespace:p.join(".")},i),(n=g[o])||(n=g[o]=[],n.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,l):n.push(l),m.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r=m.hasData(a)&&m._data(a);if(r&&(k=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=_.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=m.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,n=k[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=n.length;while(f--)g=n[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(n.splice(f,1),g.selector&&n.delegateCount--,l.remove&&l.remove.call(a,g));i&&!n.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||m.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)m.event.remove(a,o+b[j],c,d,!0);m.isEmptyObject(k)&&(delete r.handle,m._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,n,o=[d||y],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||y,3!==d.nodeType&&8!==d.nodeType&&!$.test(p+m.event.triggered)&&(p.indexOf(".")>=0&&(q=p.split("."),p=q.shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,b=b[m.expando]?b:new m.Event(p,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:m.makeArray(c,[b]),k=m.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!m.isWindow(d)){for(i=k.delegateType||p,$.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||y)&&o.push(l.defaultView||l.parentWindow||a)}n=0;while((h=o[n++])&&!b.isPropagationStopped())b.type=n>1?i:k.bindType||p,f=(m._data(h,"events")||{})[b.type]&&m._data(h,"handle"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&m.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&m.acceptData(d)&&g&&d[p]&&!m.isWindow(d)){l=d[g],l&&(d[g]=null),m.event.triggered=p;try{d[p]()}catch(r){}m.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=m.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(m._data(this,"events")||{})[a.type]||[],k=m.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=m.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((m.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+" ",void 0===e[c]&&(e[c]=d.needsContext?m(c,this).index(i)>=0:m.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[m.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=Z.test(e)?this.mouseHooks:Y.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new m.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||y),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||y,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==cb()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===cb()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return m.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return m.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=m.extend(new m.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?m.event.trigger(e,null,b):m.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},m.removeEvent=y.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]===K&&(a[d]=null),a.detachEvent(d,c))},m.Event=function(a,b){return this instanceof m.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?ab:bb):this.type=a,b&&m.extend(this,b),this.timeStamp=a&&a.timeStamp||m.now(),void(this[m.expando]=!0)):new m.Event(a,b)},m.Event.prototype={isDefaultPrevented:bb,isPropagationStopped:bb,isImmediatePropagationStopped:bb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=ab,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=ab,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=ab,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){m.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!m.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.submitBubbles||(m.event.special.submit={setup:function(){return m.nodeName(this,"form")?!1:void m.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=m.nodeName(b,"input")||m.nodeName(b,"button")?b.form:void 0;c&&!m._data(c,"submitBubbles")&&(m.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),m._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&m.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return m.nodeName(this,"form")?!1:void m.event.remove(this,"._submit")}}),k.changeBubbles||(m.event.special.change={setup:function(){return X.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(m.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),m.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,a,!0)})),!1):void m.event.add(this,"beforeactivate._change",function(a){var b=a.target;X.test(b.nodeName)&&!m._data(b,"changeBubbles")&&(m.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||m.event.simulate("change",this.parentNode,a,!0)}),m._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return m.event.remove(this,"._change"),!X.test(this.nodeName)}}),k.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){m.event.simulate(b,a.target,m.event.fix(a),!0)};m.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=m._data(d,b);e||d.addEventListener(a,c,!0),m._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=m._data(d,b)-1;e?m._data(d,b,e):(d.removeEventListener(a,c,!0),m._removeData(d,b))}}}),m.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=bb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return m().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=m.guid++)),this.each(function(){m.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,m(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=bb),this.each(function(){m.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){m.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?m.event.trigger(a,b,c,!0):void 0}});function db(a){var b=eb.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var eb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",fb=/ jQuery\d+="(?:null|\d+)"/g,gb=new RegExp("<(?:"+eb+")[\\s/>]","i"),hb=/^\s+/,ib=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jb=/<([\w:]+)/,kb=/<tbody/i,lb=/<|&#?\w+;/,mb=/<(?:script|style|link)/i,nb=/checked\s*(?:[^=]|=\s*.checked.)/i,ob=/^$|\/(?:java|ecma)script/i,pb=/^true\/(.*)/,qb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:k.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},sb=db(y),tb=sb.appendChild(y.createElement("div"));rb.optgroup=rb.option,rb.tbody=rb.tfoot=rb.colgroup=rb.caption=rb.thead,rb.th=rb.td;function ub(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==K?a.getElementsByTagName(b||"*"):typeof a.querySelectorAll!==K?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||m.nodeName(d,b)?f.push(d):m.merge(f,ub(d,b));return void 0===b||b&&m.nodeName(a,b)?m.merge([a],f):f}function vb(a){W.test(a.type)&&(a.defaultChecked=a.checked)}function wb(a,b){return m.nodeName(a,"table")&&m.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function xb(a){return a.type=(null!==m.find.attr(a,"type"))+"/"+a.type,a}function yb(a){var b=pb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function zb(a,b){for(var c,d=0;null!=(c=a[d]);d++)m._data(c,"globalEval",!b||m._data(b[d],"globalEval"))}function Ab(a,b){if(1===b.nodeType&&m.hasData(a)){var c,d,e,f=m._data(a),g=m._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)m.event.add(b,c,h[c][d])}g.data&&(g.data=m.extend({},g.data))}}function Bb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!k.noCloneEvent&&b[m.expando]){e=m._data(b);for(d in e.events)m.removeEvent(b,d,e.handle);b.removeAttribute(m.expando)}"script"===c&&b.text!==a.text?(xb(b).text=a.text,yb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),k.html5Clone&&a.innerHTML&&!m.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&W.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}}m.extend({clone:function(a,b,c){var d,e,f,g,h,i=m.contains(a.ownerDocument,a);if(k.html5Clone||m.isXMLDoc(a)||!gb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(tb.innerHTML=a.outerHTML,tb.removeChild(f=tb.firstChild)),!(k.noCloneEvent&&k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||m.isXMLDoc(a)))for(d=ub(f),h=ub(a),g=0;null!=(e=h[g]);++g)d[g]&&Bb(e,d[g]);if(b)if(c)for(h=h||ub(a),d=d||ub(f),g=0;null!=(e=h[g]);g++)Ab(e,d[g]);else Ab(a,f);return d=ub(f,"script"),d.length>0&&zb(d,!i&&ub(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,l,n=a.length,o=db(b),p=[],q=0;n>q;q++)if(f=a[q],f||0===f)if("object"===m.type(f))m.merge(p,f.nodeType?[f]:f);else if(lb.test(f)){h=h||o.appendChild(b.createElement("div")),i=(jb.exec(f)||["",""])[1].toLowerCase(),l=rb[i]||rb._default,h.innerHTML=l[1]+f.replace(ib,"<$1></$2>")+l[2],e=l[0];while(e--)h=h.lastChild;if(!k.leadingWhitespace&&hb.test(f)&&p.push(b.createTextNode(hb.exec(f)[0])),!k.tbody){f="table"!==i||kb.test(f)?"<table>"!==l[1]||kb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)m.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j)}m.merge(p,h.childNodes),h.textContent="";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),k.appendChecked||m.grep(ub(p,"input"),vb),q=0;while(f=p[q++])if((!d||-1===m.inArray(f,d))&&(g=m.contains(f.ownerDocument,f),h=ub(o.appendChild(f),"script"),g&&zb(h),c)){e=0;while(f=h[e++])ob.test(f.type||"")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=m.expando,j=m.cache,l=k.deleteExpando,n=m.event.special;null!=(d=a[h]);h++)if((b||m.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)n[e]?m.event.remove(d,e):m.removeEvent(d,e,g.handle);j[f]&&(delete j[f],l?delete d[i]:typeof d.removeAttribute!==K?d.removeAttribute(i):d[i]=null,c.push(f))}}}),m.fn.extend({text:function(a){return V(this,function(a){return void 0===a?m.text(this):this.empty().append((this[0]&&this[0].ownerDocument||y).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=wb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?m.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||m.cleanData(ub(c)),c.parentNode&&(b&&m.contains(c.ownerDocument,c)&&zb(ub(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&m.cleanData(ub(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&m.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return m.clone(this,a,b)})},html:function(a){return V(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(fb,""):void 0;if(!("string"!=typeof a||mb.test(a)||!k.htmlSerialize&&gb.test(a)||!k.leadingWhitespace&&hb.test(a)||rb[(jb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ib,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(m.cleanData(ub(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,m.cleanData(ub(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,n=this,o=l-1,p=a[0],q=m.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&nb.test(p))return this.each(function(c){var d=n.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(i=m.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=m.map(ub(i,"script"),xb),f=g.length;l>j;j++)d=i,j!==o&&(d=m.clone(d,!0,!0),f&&m.merge(g,ub(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,m.map(g,yb),j=0;f>j;j++)d=g[j],ob.test(d.type||"")&&!m._data(d,"globalEval")&&m.contains(h,d)&&(d.src?m._evalUrl&&m._evalUrl(d.src):m.globalEval((d.text||d.textContent||d.innerHTML||"").replace(qb,"")));i=c=null}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){m.fn[a]=function(a){for(var c,d=0,e=[],g=m(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),m(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Cb,Db={};function Eb(b,c){var d,e=m(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:m.css(e[0],"display");return e.detach(),f}function Fb(a){var b=y,c=Db[a];return c||(c=Eb(a,b),"none"!==c&&c||(Cb=(Cb||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=(Cb[0].contentWindow||Cb[0].contentDocument).document,b.write(),b.close(),c=Eb(a,b),Cb.detach()),Db[a]=c),c}!function(){var a;k.shrinkWrapBlocks=function(){if(null!=a)return a;a=!1;var b,c,d;return c=y.getElementsByTagName("body")[0],c&&c.style?(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),typeof b.style.zoom!==K&&(b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",b.appendChild(y.createElement("div")).style.width="5px",a=3!==b.offsetWidth),c.removeChild(d),a):void 0}}();var Gb=/^margin/,Hb=new RegExp("^("+S+")(?!px)[a-z%]+$","i"),Ib,Jb,Kb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Ib=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||m.contains(a.ownerDocument,a)||(g=m.style(a,b)),Hb.test(g)&&Gb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):y.documentElement.currentStyle&&(Ib=function(a){return a.currentStyle},Jb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Ib(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Hb.test(g)&&!Kb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"});function Lb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h;if(b=y.createElement("div"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=d&&d.style){c.cssText="float:left;opacity:.5",k.opacity="0.5"===c.opacity,k.cssFloat=!!c.cssFloat,b.style.backgroundClip="content-box",b.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===b.style.backgroundClip,k.boxSizing=""===c.boxSizing||""===c.MozBoxSizing||""===c.WebkitBoxSizing,m.extend(k,{reliableHiddenOffsets:function(){return null==g&&i(),g},boxSizingReliable:function(){return null==f&&i(),f},pixelPosition:function(){return null==e&&i(),e},reliableMarginRight:function(){return null==h&&i(),h}});function i(){var b,c,d,i;c=y.getElementsByTagName("body")[0],c&&c.style&&(b=y.createElement("div"),d=y.createElement("div"),d.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",c.appendChild(d).appendChild(b),b.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e=f=!1,h=!0,a.getComputedStyle&&(e="1%"!==(a.getComputedStyle(b,null)||{}).top,f="4px"===(a.getComputedStyle(b,null)||{width:"4px"}).width,i=b.appendChild(y.createElement("div")),i.style.cssText=b.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",b.style.width="1px",h=!parseFloat((a.getComputedStyle(i,null)||{}).marginRight),b.removeChild(i)),b.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=b.getElementsByTagName("td"),i[0].style.cssText="margin:0;border:0;padding:0;display:none",g=0===i[0].offsetHeight,g&&(i[0].style.display="",i[1].style.display="none",g=0===i[0].offsetHeight),c.removeChild(d))}}}(),m.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Mb=/alpha\([^)]*\)/i,Nb=/opacity\s*=\s*([^)]*)/,Ob=/^(none|table(?!-c[ea]).+)/,Pb=new RegExp("^("+S+")(.*)$","i"),Qb=new RegExp("^([+-])=("+S+")","i"),Rb={position:"absolute",visibility:"hidden",display:"block"},Sb={letterSpacing:"0",fontWeight:"400"},Tb=["Webkit","O","Moz","ms"];function Ub(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Tb.length;while(e--)if(b=Tb[e]+c,b in a)return b;return d}function Vb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=m._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=m._data(d,"olddisplay",Fb(d.nodeName)))):(e=U(d),(c&&"none"!==c||!e)&&m._data(d,"olddisplay",e?c:m.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Wb(a,b,c){var d=Pb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Xb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=m.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=m.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=m.css(a,"border"+T[f]+"Width",!0,e))):(g+=m.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=m.css(a,"border"+T[f]+"Width",!0,e)));return g}function Yb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ib(a),g=k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Jb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Hb.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Xb(a,b,c||(g?"border":"content"),d,f)+"px"}m.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Jb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":k.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=m.camelCase(b),i=a.style;if(b=m.cssProps[h]||(m.cssProps[h]=Ub(i,h)),g=m.cssHooks[b]||m.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,"string"===f&&(e=Qb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(m.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||m.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=m.camelCase(b);return b=m.cssProps[h]||(m.cssProps[h]=Ub(a.style,h)),g=m.cssHooks[b]||m.cssHooks[h],g&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Jb(a,b,d)),"normal"===f&&b in Sb&&(f=Sb[b]),""===c||c?(e=parseFloat(f),c===!0||m.isNumeric(e)?e||0:f):f}}),m.each(["height","width"],function(a,b){m.cssHooks[b]={get:function(a,c,d){return c?Ob.test(m.css(a,"display"))&&0===a.offsetWidth?m.swap(a,Rb,function(){return Yb(a,b,d)}):Yb(a,b,d):void 0},set:function(a,c,d){var e=d&&Ib(a);return Wb(a,c,d?Xb(a,b,d,k.boxSizing&&"border-box"===m.css(a,"boxSizing",!1,e),e):0)}}}),k.opacity||(m.cssHooks.opacity={get:function(a,b){return Nb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=m.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,(b>=1||""===b)&&""===m.trim(f.replace(Mb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Mb.test(f)?f.replace(Mb,e):f+" "+e)}}),m.cssHooks.marginRight=Lb(k.reliableMarginRight,function(a,b){return b?m.swap(a,{display:"inline-block"},Jb,[a,"marginRight"]):void 0}),m.each({margin:"",padding:"",border:"Width"},function(a,b){m.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},Gb.test(a)||(m.cssHooks[a+b].set=Wb)}),m.fn.extend({css:function(a,b){return V(this,function(a,b,c){var d,e,f={},g=0;if(m.isArray(b)){for(d=Ib(a),e=b.length;e>g;g++)f[b[g]]=m.css(a,b[g],!1,d);return f}return void 0!==c?m.style(a,b,c):m.css(a,b)},a,b,arguments.length>1)},show:function(){return Vb(this,!0)},hide:function(){return Vb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?m(this).show():m(this).hide()})}});function Zb(a,b,c,d,e){return new Zb.prototype.init(a,b,c,d,e)}m.Tween=Zb,Zb.prototype={constructor:Zb,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(m.cssNumber[c]?"":"px")},cur:function(){var a=Zb.propHooks[this.prop];return a&&a.get?a.get(this):Zb.propHooks._default.get(this)},run:function(a){var b,c=Zb.propHooks[this.prop];return this.pos=b=this.options.duration?m.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Zb.propHooks._default.set(this),this}},Zb.prototype.init.prototype=Zb.prototype,Zb.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=m.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){m.fx.step[a.prop]?m.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[m.cssProps[a.prop]]||m.cssHooks[a.prop])?m.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Zb.propHooks.scrollTop=Zb.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},m.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},m.fx=Zb.prototype.init,m.fx.step={};var $b,_b,ac=/^(?:toggle|show|hide)$/,bc=new RegExp("^(?:([+-])=|)("+S+")([a-z%]*)$","i"),cc=/queueHooks$/,dc=[ic],ec={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=bc.exec(b),f=e&&e[3]||(m.cssNumber[a]?"":"px"),g=(m.cssNumber[a]||"px"!==f&&+d)&&bc.exec(m.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,m.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function fc(){return setTimeout(function(){$b=void 0}),$b=m.now()}function gc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=T[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function hc(a,b,c){for(var d,e=(ec[b]||[]).concat(ec["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function ic(a,b,c){var d,e,f,g,h,i,j,l,n=this,o={},p=a.style,q=a.nodeType&&U(a),r=m._data(a,"fxshow");c.queue||(h=m._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,n.always(function(){n.always(function(){h.unqueued--,m.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=m.css(a,"display"),l="none"===j?m._data(a,"olddisplay")||Fb(a.nodeName):j,"inline"===l&&"none"===m.css(a,"float")&&(k.inlineBlockNeedsLayout&&"inline"!==Fb(a.nodeName)?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",k.shrinkWrapBlocks()||n.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],ac.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||m.style(a,d)}else j=void 0;if(m.isEmptyObject(o))"inline"===("none"===j?Fb(a.nodeName):j)&&(p.display=j);else{r?"hidden"in r&&(q=r.hidden):r=m._data(a,"fxshow",{}),f&&(r.hidden=!q),q?m(a).show():n.done(function(){m(a).hide()}),n.done(function(){var b;m._removeData(a,"fxshow");for(b in o)m.style(a,b,o[b])});for(d in o)g=hc(q?r[d]:0,d,n),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function jc(a,b){var c,d,e,f,g;for(c in a)if(d=m.camelCase(c),e=b[d],f=a[c],m.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=m.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function kc(a,b,c){var d,e,f=0,g=dc.length,h=m.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=$b||fc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:m.extend({},b),opts:m.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:$b||fc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=m.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(jc(k,j.opts.specialEasing);g>f;f++)if(d=dc[f].call(j,a,k,j.opts))return d;return m.map(k,hc,j),m.isFunction(j.opts.start)&&j.opts.start.call(a,j),m.fx.timer(m.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}m.Animation=m.extend(kc,{tweener:function(a,b){m.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],ec[c]=ec[c]||[],ec[c].unshift(b)},prefilter:function(a,b){b?dc.unshift(a):dc.push(a)}}),m.speed=function(a,b,c){var d=a&&"object"==typeof a?m.extend({},a):{complete:c||!c&&b||m.isFunction(a)&&a,duration:a,easing:c&&b||b&&!m.isFunction(b)&&b};return d.duration=m.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in m.fx.speeds?m.fx.speeds[d.duration]:m.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){m.isFunction(d.old)&&d.old.call(this),d.queue&&m.dequeue(this,d.queue)},d},m.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=m.isEmptyObject(a),f=m.speed(b,c,d),g=function(){var b=kc(this,m.extend({},a),f);(e||m._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=m.timers,g=m._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&cc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&m.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=m._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=m.timers,g=d?d.length:0;for(c.finish=!0,m.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),m.each(["toggle","show","hide"],function(a,b){var c=m.fn[b];m.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(gc(b,!0),a,d,e)}}),m.each({slideDown:gc("show"),slideUp:gc("hide"),slideToggle:gc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){m.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),m.timers=[],m.fx.tick=function(){var a,b=m.timers,c=0;for($b=m.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||m.fx.stop(),$b=void 0},m.fx.timer=function(a){m.timers.push(a),a()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){_b||(_b=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(_b),_b=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(a,b){return a=m.fx?m.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e;b=y.createElement("div"),b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",d=b.getElementsByTagName("a")[0],c=y.createElement("select"),e=c.appendChild(y.createElement("option")),a=b.getElementsByTagName("input")[0],d.style.cssText="top:1px",k.getSetAttribute="t"!==b.className,k.style=/top/.test(d.getAttribute("style")),k.hrefNormalized="/a"===d.getAttribute("href"),k.checkOn=!!a.value,k.optSelected=e.selected,k.enctype=!!y.createElement("form").enctype,c.disabled=!0,k.optDisabled=!e.disabled,a=y.createElement("input"),a.setAttribute("value",""),k.input=""===a.getAttribute("value"),a.value="t",a.setAttribute("type","radio"),k.radioValue="t"===a.value}();var lc=/\r/g;m.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=m.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,m(this).val()):a,null==e?e="":"number"==typeof e?e+="":m.isArray(e)&&(e=m.map(e,function(a){return null==a?"":a+""})),b=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=m.valHooks[e.type]||m.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(lc,""):null==c?"":c)}}}),m.extend({valHooks:{option:{get:function(a){var b=m.find.attr(a,"value");return null!=b?b:m.trim(m.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&m.nodeName(c.parentNode,"optgroup"))){if(b=m(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=m.makeArray(b),g=e.length;while(g--)if(d=e[g],m.inArray(m.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),m.each(["radio","checkbox"],function(){m.valHooks[this]={set:function(a,b){return m.isArray(b)?a.checked=m.inArray(m(a).val(),b)>=0:void 0}},k.checkOn||(m.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var mc,nc,oc=m.expr.attrHandle,pc=/^(?:checked|selected)$/i,qc=k.getSetAttribute,rc=k.input;m.fn.extend({attr:function(a,b){return V(this,m.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){m.removeAttr(this,a)})}}),m.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===K?m.prop(a,b,c):(1===f&&m.isXMLDoc(a)||(b=b.toLowerCase(),d=m.attrHooks[b]||(m.expr.match.bool.test(b)?nc:mc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=m.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void m.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=m.propFix[c]||c,m.expr.match.bool.test(c)?rc&&qc||!pc.test(c)?a[d]=!1:a[m.camelCase("default-"+c)]=a[d]=!1:m.attr(a,c,""),a.removeAttribute(qc?c:d)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&m.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),nc={set:function(a,b,c){return b===!1?m.removeAttr(a,c):rc&&qc||!pc.test(c)?a.setAttribute(!qc&&m.propFix[c]||c,c):a[m.camelCase("default-"+c)]=a[c]=!0,c}},m.each(m.expr.match.bool.source.match(/\w+/g),function(a,b){var c=oc[b]||m.find.attr;oc[b]=rc&&qc||!pc.test(b)?function(a,b,d){var e,f;return d||(f=oc[b],oc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,oc[b]=f),e}:function(a,b,c){return c?void 0:a[m.camelCase("default-"+b)]?b.toLowerCase():null}}),rc&&qc||(m.attrHooks.value={set:function(a,b,c){return m.nodeName(a,"input")?void(a.defaultValue=b):mc&&mc.set(a,b,c)}}),qc||(mc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},oc.id=oc.name=oc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},m.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:mc.set},m.attrHooks.contenteditable={set:function(a,b,c){mc.set(a,""===b?!1:b,c)}},m.each(["width","height"],function(a,b){m.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),k.style||(m.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var sc=/^(?:input|select|textarea|button|object)$/i,tc=/^(?:a|area)$/i;m.fn.extend({prop:function(a,b){return V(this,m.prop,a,b,arguments.length>1)},removeProp:function(a){return a=m.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),m.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!m.isXMLDoc(a),f&&(b=m.propFix[b]||b,e=m.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=m.find.attr(a,"tabindex");return b?parseInt(b,10):sc.test(a.nodeName)||tc.test(a.nodeName)&&a.href?0:-1}}}}),k.hrefNormalized||m.each(["href","src"],function(a,b){m.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),k.optSelected||(m.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){m.propFix[this.toLowerCase()]=this}),k.enctype||(m.propFix.enctype="encoding");var uc=/[\t\r\n\f]/g;m.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=m.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(m.isFunction(a))return this.each(function(b){m(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(E)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(uc," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?m.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(m.isFunction(a)?function(c){m(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=m(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===K||"boolean"===c)&&(this.className&&m._data(this,"__className__",this.className),this.className=this.className||a===!1?"":m._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(uc," ").indexOf(b)>=0)return!0;return!1}}),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){m.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),m.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var vc=m.now(),wc=/\?/,xc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=m.trim(b+"");return e&&!m.trim(e.replace(xc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():m.error("Invalid JSON: "+b)},m.parseXML=function(b){var c,d;if(!b||"string"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+b),c};var yc,zc,Ac=/#.*$/,Bc=/([?&])_=[^&]*/,Cc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Dc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ec=/^(?:GET|HEAD)$/,Fc=/^\/\//,Gc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Hc={},Ic={},Jc="*/".concat("*");try{zc=location.href}catch(Kc){zc=y.createElement("a"),zc.href="",zc=zc.href}yc=Gc.exec(zc.toLowerCase())||[];function Lc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(m.isFunction(c))while(d=f[e++])"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Mc(a,b,c,d){var e={},f=a===Ic;function g(h){var i;return e[h]=!0,m.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Nc(a,b){var c,d,e=m.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&m.extend(!0,a,c),a}function Oc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Pc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:zc,type:"GET",isLocal:Dc.test(yc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Jc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Nc(Nc(a,m.ajaxSettings),b):Nc(m.ajaxSettings,a)},ajaxPrefilter:Lc(Hc),ajaxTransport:Lc(Ic),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=m.ajaxSetup({},b),l=k.context||k,n=k.context&&(l.nodeType||l.jquery)?m(l):m.event,o=m.Deferred(),p=m.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Cc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||zc)+"").replace(Ac,"").replace(Fc,yc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=m.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(c=Gc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===yc[1]&&c[2]===yc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(yc[3]||("http:"===yc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=m.param(k.data,k.traditional)),Mc(Hc,k,b,v),2===t)return v;h=m.event&&k.global,h&&0===m.active++&&m.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Ec.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(wc.test(e)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=Bc.test(e)?e.replace(Bc,"$1_="+vc++):e+(wc.test(e)?"&":"?")+"_="+vc++)),k.ifModified&&(m.lastModified[e]&&v.setRequestHeader("If-Modified-Since",m.lastModified[e]),m.etag[e]&&v.setRequestHeader("If-None-Match",m.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Jc+"; q=0.01":""):k.accepts["*"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Mc(Ic,k,b,v)){v.readyState=1,h&&n.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Oc(k,v,c)),u=Pc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(m.lastModified[e]=w),w=v.getResponseHeader("etag"),w&&(m.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&n.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(n.trigger("ajaxComplete",[v,k]),--m.active||m.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return m.get(a,b,c,"json")},getScript:function(a,b){return m.get(a,void 0,b,"script")}}),m.each(["get","post"],function(a,b){m[b]=function(a,c,d,e){return m.isFunction(c)&&(e=e||d,d=c,c=void 0),m.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),m._evalUrl=function(a){return m.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},m.fn.extend({wrapAll:function(a){if(m.isFunction(a))return this.each(function(b){m(this).wrapAll(a.call(this,b))});if(this[0]){var b=m(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(m.isFunction(a)?function(b){m(this).wrapInner(a.call(this,b))}:function(){var b=m(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=m.isFunction(a);return this.each(function(c){m(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)}).end()}}),m.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!k.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||m.css(a,"display"))},m.expr.filters.visible=function(a){return!m.expr.filters.hidden(a)};var Qc=/%20/g,Rc=/\[\]$/,Sc=/\r?\n/g,Tc=/^(?:submit|button|image|reset|file)$/i,Uc=/^(?:input|select|textarea|keygen)/i;function Vc(a,b,c,d){var e;if(m.isArray(b))m.each(b,function(b,e){c||Rc.test(a)?d(a,e):Vc(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==m.type(b))d(a,b);else for(e in b)Vc(a+"["+e+"]",b[e],c,d)}m.param=function(a,b){var c,d=[],e=function(a,b){b=m.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,function(){e(this.name,this.value)});else for(c in a)Vc(c,a[c],b,e);return d.join("&").replace(Qc,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=m.prop(this,"elements");return a?m.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!m(this).is(":disabled")&&Uc.test(this.nodeName)&&!Tc.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=m(this).val();return null==c?null:m.isArray(c)?m.map(c,function(a){return{name:b.name,value:a.replace(Sc,"\r\n")}}):{name:b.name,value:c.replace(Sc,"\r\n")}}).get()}}),m.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&Zc()||$c()}:Zc;var Wc=0,Xc={},Yc=m.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Xc)Xc[a](void 0,!0)}),k.cors=!!Yc&&"withCredentials"in Yc,Yc=k.ajax=!!Yc,Yc&&m.ajaxTransport(function(a){if(!a.crossDomain||k.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Wc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Xc[g],b=void 0,f.onreadystatechange=m.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Xc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function Zc(){try{return new a.XMLHttpRequest}catch(b){}}function $c(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return m.globalEval(a),a}}}),m.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),m.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=y.head||m("head")[0]||y.documentElement;return{send:function(d,e){b=y.createElement("script"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var _c=[],ad=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=_c.pop()||m.expando+"_"+vc++;return this[a]=!0,a}}),m.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(ad.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&ad.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=m.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(ad,"$1"+e):b.jsonp!==!1&&(b.url+=(wc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||m.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,_c.push(e)),g&&m.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),m.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||y;var d=u.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m.buildFragment([a],b,e),e&&e.length&&m(e).remove(),m.merge([],d.childNodes))};var bd=m.fn.load;m.fn.load=function(a,b,c){if("string"!=typeof a&&bd)return bd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=m.trim(a.slice(h,a.length)),a=a.slice(0,h)),m.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(f="POST"),g.length>0&&m.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?m("<div>").append(m.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){m.fn[b]=function(a){return this.on(b,a)}}),m.expr.filters.animated=function(a){return m.grep(m.timers,function(b){return a===b.elem}).length};var cd=a.document.documentElement;function dd(a){return m.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}m.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=m.css(a,"position"),l=m(a),n={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=m.css(a,"top"),i=m.css(a,"left"),j=("absolute"===k||"fixed"===k)&&m.inArray("auto",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),m.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(n.top=b.top-h.top+g),null!=b.left&&(n.left=b.left-h.left+e),"using"in b?b.using.call(a,n):l.css(n)}},m.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){m.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,m.contains(b,e)?(typeof e.getBoundingClientRect!==K&&(d=e.getBoundingClientRect()),c=dd(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===m.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),m.nodeName(a[0],"html")||(c=a.offset()),c.top+=m.css(a[0],"borderTopWidth",!0),c.left+=m.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-m.css(d,"marginTop",!0),left:b.left-c.left-m.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||cd;while(a&&!m.nodeName(a,"html")&&"static"===m.css(a,"position"))a=a.offsetParent;return a||cd})}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);m.fn[a]=function(d){return V(this,function(a,d,e){var f=dd(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?m(f).scrollLeft():e,c?e:m(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),m.each(["top","left"],function(a,b){m.cssHooks[b]=Lb(k.pixelPosition,function(a,c){return c?(c=Jb(a,b),Hb.test(c)?m(a).position()[b]+"px":c):void 0})}),m.each({Height:"height",Width:"width"},function(a,b){m.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){m.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return V(this,function(b,c,d){var e;return m.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?m.css(b,c,g):m.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return m});var ed=a.jQuery,fd=a.$;return m.noConflict=function(b){return a.$===m&&(a.$=fd),b&&a.jQuery===m&&(a.jQuery=ed),m},typeof b===K&&(a.jQuery=a.$=m),m});/* == jquery mousewheel plugin == Version: 3.1.13, License: MIT License (MIT) */!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});/* == malihu jquery custom scrollbar plugin == Version: 3.1.5, License: MIT License (MIT) */!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,n="https:"==document.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";o||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E"))),t()}(function(){var t,o="mCustomScrollbar",a="mCS",n=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if("off"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),"once"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var n=o.data(a),i=n.opt,l=o.data("mcs-axis"),s=o.data("mcs-scrollbar-position"),c=o.data("mcs-theme");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),n&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),e("#mCSB_"+n.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container"),l=e("#mCSB_"+n.idx),s=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];if(!r.length)return;n.tweenRunning&&Q(t),o&&n&&i.callbacks.onBeforeUpdate&&"function"==typeof i.callbacks.onBeforeUpdate&&i.callbacks.onBeforeUpdate.call(this),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),l.css("max-height","none"),l.height()!==t.height()&&l.css("max-height",t.height()),_.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",x(r)),n.overflowed=y.call(this),M.call(this),i.autoDraggerLength&&S.call(this),b.call(this),T.call(this);var c=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(n.overflowed[0]?s[0].height()>s[0].parent().height()?B.call(this):(G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}),n.contentReset.y=null):(B.call(this),"y"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[1]&&G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(n.overflowed[1]?s[1].width()>s[1].parent().width()?B.call(this):(G(t,c[1].toString(),{dir:"x",dur:0,overwrite:"none"}),n.contentReset.x=null):(B.call(this),"x"===i.axis?k.call(this):"yx"===i.axis&&n.overflowed[0]&&G(t,c[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),N.call(this)}})},scrollTo:function(t,o){if("undefined"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=X.call(this,c[0],"y"),c[1]=X.call(this,c[1],"x"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=ne()?0:d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&i.overflowed[0]&&(s.dir="y",s.overwrite="all",G(n,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&i.overflowed[1]&&(s.dir="x",s.overwrite="none",G(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&Q(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){o.data(a);N.call(this,"remove"),k.call(this),t&&B.call(this),M.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx),s=e("#mCSB_"+i.idx+"_container"),c=e(".mCSB_"+i.idx+"_scrollbar");r.live&&m(r.liveSelector||e(t).selector),N.call(this,"remove"),k.call(this),B.call(this),n.removeData(a),$(this,"mcs"),c.remove(),s.find("img."+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+" _"+a+"_"+i.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},f=function(){return"object"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),$(l,e))},p=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},g=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+n.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+n.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===i.axis?l[0]+l[1]:"x"===i.axis?l[1]:l[0],u="yx"===i.axis?"<div id='mCSB_"+n.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",f=i.autoHideScrollbar?" "+d[6]:"",h="x"!==i.axis&&"rtl"===n.langDir?" "+d[7]:"";i.setWidth&&t.css("width",i.setWidth),i.setHeight&&t.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===n.langDir?"989999px":i.setLeft,t.addClass(o+" _"+a+"_"+n.idx+f+h).wrapInner("<div id='mCSB_"+n.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+s+"'><div id='mCSB_"+n.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir='"+n.langDir+"' /></div>");var m=e("#mCSB_"+n.idx),p=e("#mCSB_"+n.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css("width",x(p)),"outside"===i.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(u)),w.call(this);var g=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},x=function(t){var o=[t[0].scrollWidth,Math.max.apply(Math,t.children().map(function(){return e(this).outerWidth(!0)}).get())],a=t.parent().width();return o[0]>a?o[0]:o[1]>a?o[1]:"100%"},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx+"_container");if(n.advanced.autoExpandHorizontalScroll&&"y"!==n.axis){i.css({width:"auto","min-width":0,"overflow-x":"scroll"});var r=Math.ceil(i[0].scrollWidth);3===n.advanced.autoExpandHorizontalScroll||2!==n.advanced.autoExpandHorizontalScroll&&r>i.parent().width()?i.css({width:r,"min-width":"100%","overflow-x":"inherit"}):i.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(".mCSB_"+o.idx+"_scrollbar:first"),r=oe(n.scrollButtons.tabindex)?"tabindex='"+n.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+d[13]+"' "+r+" />","<a href='#' class='"+d[14]+"' "+r+" />","<a href='#' class='"+d[15]+"' "+r+" />","<a href='#' class='"+d[16]+"' "+r+" />"],s=["x"===n.axis?l[2]:l[0],"x"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},b=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},C=function(e,t,o){var a=o?d[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(d[0]+" "+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},y=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1),s=i[0].scrollHeight,c=i[0].scrollWidth;return s>r&&(r=s),c>l&&(l=c),[r>n.height(),l>n.width()]},B=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx),r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(Q(t),("x"!==n.axis&&!o.overflowed[0]||"y"===n.axis&&o.overflowed[0])&&(l[0].add(r).css("top",0),G(t,"_resetY")),"y"!==n.axis&&!o.overflowed[1]||"x"===n.axis&&o.overflowed[1]){var s=dx=0;"rtl"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),G(t,"_resetX")}},T=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(I.call(this),i.contentTouchScroll&&D.call(this),E.call(this),i.mouseWheel.enable){var r;t()}P.call(this),U.call(this),i.advanced.autoScrollOnFocus&&H.call(this),i.scrollButtons.enable&&F.call(this),i.keyboard.enable&&q.call(this),n.bindEvents=!0}},k=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",l=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),n.advanced.extraDraggableSelectors&&l.add(e(n.advanced.extraDraggableSelectors)),o.bindEvents&&(e(document).add(e(!A()||top.document)).unbind("."+i),l.each(function(){e(this).unbind("."+i)}),clearTimeout(t[0]._focusTimeout),$(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),$(o.sequential,"step"),clearTimeout(s[0].onCompleteTimeout),$(s[0],"onCompleteTimeout"),o.bindEvents=!1)},M=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+n.idx+"_container"),s=[e("#mCSB_"+n.idx+"_scrollbar_vertical"),e("#mCSB_"+n.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(d[8]+" "+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(d[10])):(s[0].css("display","none"),l.addClass(d[10])),l.addClass(d[8]))),"y"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(d[9]+" "+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(d[11])):(s[1].css("display","none"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},O=function(t){var o=t.type,a=t.target.ownerDocument!==document&&null!==frameElement?[e(frameElement).offset().top,e(frameElement).offset().left]:null,n=A()&&t.target.ownerDocument!==top.document&&null!==frameElement?[e(t.view.frameElement).offset().top,e(t.view.frameElement).offset().left]:[0,0];switch(o){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return a?[t.originalEvent.pageY-a[0]+n[0],t.originalEvent.pageX-a[1]+n[1],!1]:[t.originalEvent.pageY,t.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0],r=t.originalEvent.touches.length||t.originalEvent.changedTouches.length;return t.target.ownerDocument!==document?[i.screenY,i.screenX,r>1]:[i.pageY,i.pageX,r>1];default:return a?[t.pageY-a[0]+n[0],t.pageX-a[1]+n[1],!1]:[t.pageY,t.pageX,!1]}},I=function(){function t(e,t,a,n){if(h[0].idleTimer=d.scrollInertia<233?250:0,o.attr("id")===f[1])var i="x",s=(o[0].offsetLeft-t+n)*l.scrollRatio.x;else var i="y",s=(o[0].offsetTop-e+a)*l.scrollRatio.y;G(r,s.toString(),{dir:i,drag:!0})}var o,n,i,r=e(this),l=r.data(a),d=l.opt,u=a+"_"+l.idx,f=["mCSB_"+l.idx+"_dragger_vertical","mCSB_"+l.idx+"_dragger_horizontal"],h=e("#mCSB_"+l.idx+"_container"),m=e("#"+f[0]+",#"+f[1]),p=d.advanced.releaseDraggableSelectors?m.add(e(d.advanced.releaseDraggableSelectors)):m,g=d.advanced.extraDraggableSelectors?e(!A()||top.document).add(e(d.advanced.extraDraggableSelectors)):e(!A()||top.document);m.bind("contextmenu."+u,function(e){e.preventDefault()}).bind("mousedown."+u+" touchstart."+u+" pointerdown."+u+" MSPointerDown."+u,function(t){if(t.stopImmediatePropagation(),t.preventDefault(),ee(t)){c=!0,s&&(document.onselectstart=function(){return!1}),L.call(h,!1),Q(r),o=e(this);var a=o.offset(),l=O(t)[0]-a.top,u=O(t)[1]-a.left,f=o.height()+a.top,m=o.width()+a.left;f>l&&l>0&&m>u&&u>0&&(n=l,i=u),C(o,"active",d.autoExpandScrollbar)}}).bind("touchmove."+u,function(e){e.stopImmediatePropagation(),e.preventDefault();var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;t(n,i,r,l)}),e(document).add(g).bind("mousemove."+u+" pointermove."+u+" MSPointerMove."+u,function(e){if(o){var a=o.offset(),r=O(e)[0]-a.top,l=O(e)[1]-a.left;if(n===r&&i===l)return;t(n,i,r,l)}}).add(p).bind("mouseup."+u+" touchend."+u+" pointerup."+u+" MSPointerUp."+u,function(){o&&(C(o,"active",d.autoExpandScrollbar),o=null),c=!1,s&&(document.onselectstart=null),L.call(h,!0)})},D=function(){function o(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,b=0,C=0,d=1,y.removeClass("mCS_touch_action");var o=I.offset();u=O(e)[0]-o.top,f=O(e)[1]-o.left,z=[O(e)[0],O(e)[1]]}function n(e){if(te(e)&&!c&&!O(e)[2]&&(T.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!C||b)&&d)){g=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left,n="mcsLinearOut";if(E.push(o),W.push(a),z[2]=Math.abs(O(e)[0]-z[0]),z[3]=Math.abs(O(e)[1]-z[1]),B.overflowed[0])var i=D[0].parent().height()-D[0].height(),r=u-o>0&&o-u>-(i*B.scrollRatio.y)&&(2*z[3]<z[2]||"yx"===T.axis);if(B.overflowed[1])var l=D[1].parent().width()-D[1].width(),h=f-a>0&&a-f>-(l*B.scrollRatio.x)&&(2*z[2]<z[3]||"yx"===T.axis);r||h?(U||e.preventDefault(),b=1):(C=1,y.addClass("mCS_touch_action")),U&&e.preventDefault(),w="yx"===T.axis?[u-o,f-a]:"x"===T.axis?[null,f-a]:[u-o,null],I[0].idleTimer=250,B.overflowed[0]&&s(w[0],R,n,"y","all",!0),B.overflowed[1]&&s(w[1],R,n,"x",L,!0)}}function i(e){if(!te(e)||c||O(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),Q(y),p=K();var o=M.offset();h=O(e)[0]-o.top,m=O(e)[1]-o.left,E=[],W=[]}function r(e){if(te(e)&&!c&&!O(e)[2]){d=0,e.stopImmediatePropagation(),b=0,C=0,v=K();var t=M.offset(),o=O(e)[0]-t.top,a=O(e)[1]-t.left;if(!(v-g>30)){_=1e3/(v-p);var n="mcsEaseOut",i=2.5>_,r=i?[E[E.length-2],W[W.length-2]]:[0,0];x=i?[o-r[0],a-r[1]]:[o-h,a-m];var u=[Math.abs(x[0]),Math.abs(x[1])];_=i?[Math.abs(x[0]/4),Math.abs(x[1]/4)]:[_,_];var f=[Math.abs(I[0].offsetTop)-x[0]*l(u[0]/_[0],_[0]),Math.abs(I[0].offsetLeft)-x[1]*l(u[1]/_[1],_[1])];w="yx"===T.axis?[f[0],f[1]]:"x"===T.axis?[null,f[1]]:[f[0],null],S=[4*u[0]+T.scrollInertia,4*u[1]+T.scrollInertia];var y=parseInt(T.contentTouchScroll)||0;w[0]=u[0]>y?w[0]:0,w[1]=u[1]>y?w[1]:0,B.overflowed[0]&&s(w[0],S[0],n,"y",L,!1),B.overflowed[1]&&s(w[1],S[1],n,"x",L,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&G(y,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C,y=e(this),B=y.data(a),T=B.opt,k=a+"_"+B.idx,M=e("#mCSB_"+B.idx),I=e("#mCSB_"+B.idx+"_container"),D=[e("#mCSB_"+B.idx+"_dragger_vertical"),e("#mCSB_"+B.idx+"_dragger_horizontal")],E=[],W=[],R=0,L="yx"===T.axis?"none":"all",z=[],P=I.find("iframe"),H=["touchstart."+k+" pointerdown."+k+" MSPointerDown."+k,"touchmove."+k+" pointermove."+k+" MSPointerMove."+k,"touchend."+k+" pointerup."+k+" MSPointerUp."+k],U=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;I.bind(H[0],function(e){o(e)}).bind(H[1],function(e){n(e)}),M.bind(H[0],function(e){i(e)}).bind(H[2],function(e){r(e)}),P.length&&P.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(H[0],function(e){o(e),i(e)}).bind(H[1],function(e){n(e)}).bind(H[2],function(e){r(e)})})})},E=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?"stepped":"stepless",d.scrollAmount=10,j(r,e,t,"mcsLinearOut",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+"_"+l.idx,f=e("#mCSB_"+l.idx+"_container"),h=f.parent();f.bind("mousedown."+u,function(){t||i||(i=1,c=!0)}).add(document).bind("mousemove."+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=O(e)[0]-a.top+f[0].offsetTop,c=O(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n("off",null,"stepped"):("x"!==s.axis&&l.overflowed[0]&&(0>r?n("on",38):r>h.height()&&n("on",40)),"y"!==s.axis&&l.overflowed[1]&&(0>c?n("on",37):c>h.width()&&n("on",39)))}}).bind("mouseup."+u+" dragend."+u,function(){t||(i&&(i=0,n("off",null)),c=!1)})},W=function(){function t(t,a){if(Q(o),!z(o,t.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100,d=i.scrollInertia;if("x"===i.axis||"x"===i.mouseWheel.axis)var u="x",f=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.width()?.9*l.width():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetLeft),p=c[1][0].offsetLeft,g=c[1].parent().width()-c[1].width(),v="y"===i.mouseWheel.axis?t.deltaY||a:t.deltaX;else var u="y",f=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],h="auto"!==i.mouseWheel.scrollAmount?f[1]:f[0]>=l.height()?.9*l.height():f[0],m=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetTop),p=c[0][0].offsetTop,g=c[0].parent().height()-c[0].height(),v=t.deltaY||a;"y"===u&&!n.overflowed[0]||"x"===u&&!n.overflowed[1]||((i.mouseWheel.invert||t.webkitDirectionInvertedFromDevice)&&(v=-v),i.mouseWheel.normalizeDelta&&(v=0>v?-1:1),(v>0&&0!==p||0>v&&p!==g||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),t.deltaFactor<5&&!i.mouseWheel.normalizeDelta&&(h=t.deltaFactor,d=17),G(o,(m-v*h).toString(),{dir:u,dur:d}))}}if(e(this).data(a)){var o=e(this),n=o.data(a),i=n.opt,r=a+"_"+n.idx,l=e("#mCSB_"+n.idx),c=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")],d=e("#mCSB_"+n.idx+"_container").find("iframe");d.length&&d.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,o){t(e,o)})})}),l.bind("mousewheel."+r,function(e,o){t(e,o)})}},R=new Object,A=function(t){var o=!1,a=!1,n=null;if(void 0===t?a="#empty":void 0!==e(t).attr("id")&&(a=e(t).attr("id")),a!==!1&&void 0!==R[a])return R[a];if(t){try{var i=t.contentDocument||t.contentWindow.document;n=i.body.innerHTML}catch(r){}o=null!==n}else{try{var i=top.document;n=i.body.innerHTML}catch(r){}o=null!==n}return a!==!1&&(R[a]=o),o},L=function(e){var t=this.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}},z=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(":focus"))},P=function(){var t,o=e(this),n=o.data(a),i=a+"_"+n.idx,r=e("#mCSB_"+n.idx+"_container"),l=r.parent(),s=e(".mCSB_"+n.idx+"_scrollbar ."+d[12]);s.bind("mousedown."+i+" touchstart."+i+" pointerdown."+i+" MSPointerDown."+i,function(o){c=!0,e(o.target).hasClass("mCSB_dragger")||(t=1)}).bind("touchend."+i+" pointerup."+i+" MSPointerUp."+i,function(){c=!1}).bind("click."+i,function(a){if(t&&(t=0,e(a.target).hasClass(d[12])||e(a.target).hasClass("mCSB_draggerRail"))){Q(o);var i=e(this),s=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!n.overflowed[1])return;var c="x",u=a.pageX>s.offset().left?-1:1,f=Math.abs(r[0].offsetLeft)-u*(.9*l.width())}else{if(!n.overflowed[0])return;var c="y",u=a.pageY>s.offset().top?-1:1,f=Math.abs(r[0].offsetTop)-u*(.9*l.height())}G(o,f.toString(),{dir:c,scrollEasing:"mcsEaseInOut"})}})},H=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),l=r.parent();r.bind("focusin."+i,function(){var o=e(document.activeElement),a=r.find(".mCustomScrollBox").length,i=0;o.is(n.advanced.autoScrollOnFocus)&&(Q(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=a?(i+17)*a:0,t[0]._focusTimeout=setTimeout(function(){var e=[ae(o)[0],ae(o)[1]],a=[r[0].offsetTop,r[0].offsetLeft],s=[a[0]+e[0]>=0&&a[0]+e[0]<l.height()-o.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<l.width()-o.outerWidth(!1)],c="yx"!==n.axis||s[0]||s[1]?"all":"none";"x"===n.axis||s[0]||G(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i}),"y"===n.axis||s[1]||G(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:i})},t[0]._focusTimer))})},U=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container").parent();i.bind("scroll."+n,function(){0===i.scrollTop()&&0===i.scrollLeft()||e(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},F=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e(l+">a");s.bind("contextmenu."+r,function(e){e.preventDefault()}).bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,o){i.scrollAmount=n.scrollButtons.scrollAmount,j(t,e,o)}if(a.preventDefault(),ee(a)){var l=e(this).attr("class");switch(i.type=n.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;c=!0,o.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;c=!1,i.dir&&r("off",l);break;case"click":if("stepped"!==i.type||o.tweenRunning)return;r("on",l)}}})},q=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.keyboard.scrollAmount,"stepped"===r.type&&n.tweenRunning||j(o,e,t)}switch(t.type){case"blur":n.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var l=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===l||40===l)||"y"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;"keyup"===t.type&&(s="off"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type){Q(o);var f=34===l?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=Math.abs(c[0].offsetLeft)-f*(.9*d.width());else var h="y",m=Math.abs(c[0].offsetTop)-f*(.9*d.height());G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type)){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h="y",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;G(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+"_"+n.idx,s=e("#mCSB_"+n.idx),c=e("#mCSB_"+n.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",f=c.find("iframe"),h=["blur."+l+" keydown."+l+" keyup."+l];f.length&&f.each(function(){e(this).bind("load",function(){A(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr("tabindex","0").bind(h[0],function(e){t(e)})},j=function(t,o,n,i,r){function l(e){u.snapAmount&&(f.scrollAmount=u.snapAmount instanceof Array?"x"===f.dir[0]?u.snapAmount[1]:u.snapAmount[0]:u.snapAmount);var o="stepped"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],m="x"===f.dir[0]?s[1]+f.dir[1]*(d[1]*n):s[0]+f.dir[1]*(d[0]*n),v="x"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),x="auto"!==f.scrollAmount?v:m,_=i?i:e?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",w=!!e;return e&&17>a&&(x="x"===f.dir[0]?s[1]:s[0]),G(t,x.toString(),{dir:f.dir[0],scrollEasing:_,dur:a,onComplete:w}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),$(f,"step"),Q(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===f.type,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case"on":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?"x":"y",n===d[13]||n===d[15]||38===n||37===n?-1:1],Q(t),oe(n)&&"stepped"===f.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return"function"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:"x"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||"x"===o.axis?null:t,n[1]=t.x?t.x:t.y||"y"===o.axis?null:t),"function"==typeof n[0]&&(n[0]=n[0]()),"function"==typeof n[1]&&(n[1]=n[1]()),n},X=function(t,o){if(null!=t&&"undefined"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx+"_container"),s=l.parent(),c=typeof t;o||(o="x"===r.axis?"x":"y");var d="x"===o?l.outerWidth(!1)-s.width():l.outerHeight(!1)-s.height(),f="x"===o?l[0].offsetLeft:l[0].offsetTop,h="x"===o?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===o?ae(m)[1]:ae(m)[0];case"string":case"number":if(oe(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(f-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=f+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&oe(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===o?ae(m)[1]:ae(m)[0]}return e(t).length?"x"===o?ae(e(t))[1]:ae(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},N=function(t){function o(){return clearTimeout(f[0].autoUpdate),0===l.parents("html").length?void(l=null):void(f[0].autoUpdate=setTimeout(function(){return c.advanced.updateOnSelectorChange&&(s.poll.change.n=i(),s.poll.change.n!==s.poll.change.o)?(s.poll.change.o=s.poll.change.n,void r(3)):c.advanced.updateOnContentResize&&(s.poll.size.n=l[0].scrollHeight+l[0].scrollWidth+f[0].offsetHeight+l[0].offsetHeight+l[0].offsetWidth,s.poll.size.n!==s.poll.size.o)?(s.poll.size.o=s.poll.size.n,void r(1)):!c.advanced.updateOnImageLoad||"auto"===c.advanced.updateOnImageLoad&&"y"===c.axis||(s.poll.img.n=f.find("img").length,s.poll.img.n===s.poll.img.o)?void((c.advanced.updateOnSelectorChange||c.advanced.updateOnContentResize||c.advanced.updateOnImageLoad)&&o()):(s.poll.img.o=s.poll.img.n,void f.find("img").each(function(){n(this)}))},c.advanced.autoUpdateTimeout))}function n(t){function o(e,t){return function(){return t.apply(e,arguments)}}function a(){this.onload=null,e(t).addClass(d[2]),r(2)}if(e(t).hasClass(d[2]))return void r();var n=new Image;n.onload=o(n,a),n.src=t.src}function i(){c.advanced.updateOnSelectorChange===!0&&(c.advanced.updateOnSelectorChange="*");var e=0,t=f.find(c.advanced.updateOnSelectorChange);return c.advanced.updateOnSelectorChange&&t.length>0&&t.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function r(e){clearTimeout(f[0].autoUpdate),u.update.call(null,l[0],e)}var l=e(this),s=l.data(a),c=s.opt,f=e("#mCSB_"+s.idx+"_container");return t?(clearTimeout(f[0].autoUpdate),void $(f[0],"autoUpdate")):void o()},V=function(e,t,o){return Math.round(e/t)*t-o},Q=function(t){var o=t.data(a),n=e("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");n.each(function(){Z.call(this)})},G=function(t,o,n){function i(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||w>=S[0]+y,c.callbacks.alwaysTriggerOffsets||-B>=w]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[x[0].offsetTop,x[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=n.trigger,0===m.scrollTop()&&0===m.scrollLeft()||(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==o||s.contentReset.y||(i("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==o||s.contentReset.x||(i("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){if(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount){var v=c.snapAmount instanceof Array?"x"===n.dir?c.snapAmount[1]:c.snapAmount[0]:c.snapAmount;o=V(o,v,c.snapOffset)}switch(n.dir){case"x":var x=e("#mCSB_"+s.idx+"_dragger_horizontal"),_="left",w=h[0].offsetLeft,S=[f.width()-h.outerWidth(!1),x.parent().width()-x.width()],b=[o,0===o?0:o/s.scrollRatio.x],y=p[1],B=g[1],T=y>0?y/s.scrollRatio.x:0,k=B>0?B/s.scrollRatio.x:0;break;case"y":var x=e("#mCSB_"+s.idx+"_dragger_vertical"),_="top",w=h[0].offsetTop,S=[f.height()-h.outerHeight(!1),x.parent().height()-x.height()],b=[o,0===o?0:o/s.scrollRatio.y],y=p[0],B=g[0],T=y>0?y/s.scrollRatio.y:0,k=B>0?B/s.scrollRatio.y:0}b[1]<0||0===b[0]&&0===b[1]?b=[0,0]:b[1]>=S[1]?b=[S[0],S[1]]:b[0]=-b[0],t[0].mcs||(l(),i("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),J(x[0],_,Math.round(b[1]),u[1],n.scrollEasing),!s.tweenRunning&&(0===w&&b[0]>=0||w===S[0]&&b[0]<=S[0])||J(h[0],_,Math.round(b[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,C(x),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),i("onTotalScroll")&&b[1]>=S[1]-T&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i("onTotalScrollBack")&&b[1]<=k&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,C(x,"hide")},e)}}})}},J=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=K()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+"px"):w[t]=o+"px",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=K(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];"left"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,"none"!==i&&d(),c()},K=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},Z=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},$=function(e,t){try{delete e[t]}catch(o){e[t]=null}},ee=function(e){return!(e.which&&1!==e.which)},te=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},oe=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ae=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]},ne=function(){function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}var t=e();return t?document[t]:!1};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).bind("load",function(){e(n)[o](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(".mCSB_container");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+ae(n)[0]>=0&&a[0]+ae(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+ae(n)[1]>=0&&a[1]+ae(n)[1]<o.width()-n.outerWidth(!1)},mcsInSight:e.expr[":"].mcsInSight||function(t,o,a){var n,i,r,l,s=e(t),c=s.parents(".mCSB_container"),d="exact"===a[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(c.length)return n=[s.outerHeight(!1),s.outerWidth(!1)],r=[c[0].offsetTop+ae(s)[0],c[0].offsetLeft+ae(s)[1]],i=[c.parent()[0].offsetHeight,c.parent()[0].offsetWidth],l=[n[0]<i[0]?d[0]:d[1],n[1]<i[1]?d[0]:d[1]],r[0]-i[0]*l[0][0]<0&&r[0]+n[0]-i[0]*l[0][1]>=0&&r[1]-i[1]*l[1][0]<0&&r[1]+n[1]-i[1]*l[1][1]>=0},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});/*! jQuery UI - v1.12.1 - 2017-12-07* http://jqueryui.com* Includes: widget.js, position.js, data.js, disable-selection.js, focusable.js, form-reset-mixin.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/draggable.js, widgets/droppable.js, widgets/resizable.js, widgets/sortable.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/selectmenu.js, widgets/slider.js, widgets/tooltip.js* Copyright jQuery Foundation and other contributors; Licensed MIT */(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){function e(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}function i(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function s(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=n(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.on("mouseout",i,function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",i,o)}function o(){t.datepicker._isDisabledDatepicker(d.inline?d.dpDiv.parent()[0]:d.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function a(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}t.ui=t.ui||{},t.ui.version="1.12.1";var r=0,l=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},l=e.split(".")[0];e=e.split(".")[1];var h=l+"-"+e;return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][h.toLowerCase()]=function(e){return!!t.data(e,h)},t[l]=t[l]||{},n=t[l][e],o=t[l][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}(),void 0):(r[e]=s,void 0)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},r,{constructor:o,namespace:l,widgetName:e,widgetFullName:h}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,s,n=l.call(arguments,1),o=0,a=n.length;a>o;o++)for(i in n[o])s=n[o][i],n[o].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(n){var o="string"==typeof n,a=l.call(arguments,1),r=this;return o?this.length||"instance"!==n?this.each(function(){var i,o=t.data(this,s);return"instance"===n?(r=o,!1):o?t.isFunction(o[n])&&"_"!==n.charAt(0)?(i=o[n].apply(o,a),i!==o&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+n+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+n+"'")}):r=void 0:(a.length&&(n=t.widget.extend.apply(null,[n].concat(a))),this.each(function(){var e=t.data(this,s);e?(e.option(n||{}),e._init&&e._init()):t.data(this,s,new i(n,this))})),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=r++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,i){e._removeClass(i,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=e.add?t(t.unique(a.get().concat(e.element.get()))):t(a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.on(h,c,r):i.on(h,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget,function(){function e(t,e,i){return[parseFloat(t[0])*(u.test(t[0])?e/100:1),parseFloat(t[1])*(u.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}var n,o=Math.max,a=Math.abs,r=/left|center|right/,l=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType,o=!s&&!n;return{element:i,isWindow:s,isDocument:n,offset:o?t(e).offset():{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return d.apply(this,arguments);n=t.extend({},n);var u,p,f,g,m,_,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),w=(n.collision||"flip").split(" "),k={};return _=s(v),v[0].preventDefault&&(n.at="left top"),p=_.width,f=_.height,g=_.offset,m=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):l.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=l.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?m.left+=p:"center"===n.at[0]&&(m.left+=p/2),"bottom"===n.at[1]?m.top+=f:"center"===n.at[1]&&(m.top+=f/2),u=e(k.at,p,f),m.left+=u[0],m.top+=u[1],this.each(function(){var s,r,l=t(this),h=l.outerWidth(),c=l.outerHeight(),d=i(this,"marginLeft"),_=i(this,"marginTop"),x=h+d+i(this,"marginRight")+y.width,C=c+_+i(this,"marginBottom")+y.height,D=t.extend({},m),T=e(k.my,l.outerWidth(),l.outerHeight());"right"===n.my[0]?D.left-=h:"center"===n.my[0]&&(D.left-=h/2),"bottom"===n.my[1]?D.top-=c:"center"===n.my[1]&&(D.top-=c/2),D.left+=T[0],D.top+=T[1],s={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](D,{targetWidth:p,targetHeight:f,elemWidth:h,elemHeight:c,collisionPosition:s,collisionWidth:x,collisionHeight:C,offset:[u[0]+T[0],u[1]+T[1]],my:n.my,at:n.at,within:b,elem:l})}),n.using&&(r=function(t){var e=g.left-D.left,i=e+p-h,s=g.top-D.top,r=s+f-c,u={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:l,left:D.left,top:D.top,width:h,height:c},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};h>p&&p>a(e+i)&&(u.horizontal="center"),c>f&&f>a(s+r)&&(u.vertical="middle"),u.important=o(a(e),a(i))>o(a(s),a(r))?"horizontal":"vertical",n.using.call(this,t,u)}),l.offset(t.extend(D,{using:r}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,l=n-r,h=r+e.collisionWidth-a-n;e.collisionWidth>a?l>0&&0>=h?(i=t.left+l+e.collisionWidth-a-n,t.left+=l-i):t.left=h>0&&0>=l?n:l>h?n+a-e.collisionWidth:n:l>0?t.left+=l:h>0?t.left-=h:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,l=n-r,h=r+e.collisionHeight-a-n;e.collisionHeight>a?l>0&&0>=h?(i=t.top+l+e.collisionHeight-a-n,t.top+=l-i):t.top=h>0&&0>=l?n:l>h?n+a-e.collisionHeight:n:l>0?t.top+=l:h>0?t.top-=h:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,r=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-r-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-r-o,(0>i||a(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-l,(s>0||u>a(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,r=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-r-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-r-o,(0>s||a(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-l,(i>0||u>a(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])}}),t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}}),t.ui.focusable=function(i,s){var n,o,a,r,l,h=i.nodeName.toLowerCase();return"area"===h?(n=i.parentNode,o=n.name,i.href&&o&&"map"===n.nodeName.toLowerCase()?(a=t("img[usemap='#"+o+"']"),a.length>0&&a.is(":visible")):!1):(/^(input|select|textarea|button|object)$/.test(h)?(r=!i.disabled,r&&(l=t(i).closest("fieldset")[0],l&&(r=!l.disabled))):r="a"===h?i.href||s:s,r&&t(i).is(":visible")&&e(t(i)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout(function(){var i=e.data("ui-form-reset-instances");t.each(i,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.fn.labels=function(){var e,i,s,n,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(n=this.eq(0).parents("label"),s=this.attr("id"),s&&(e=this.eq(0).parents().last(),o=e.add(e.length?e.siblings():this.siblings()),i="label[for='"+t.ui.escapeSelector(s)+"']",n=n.add(o.find(i).addBack(i))),this.pushStack(n))},t.fn.scrollParent=function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var i=t.attr(e,"tabindex"),s=null!=i;return(!s||i>=0)&&t.ui.focusable(e,s)}}),t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var h=!1;t(document).on("mouseup",function(){h=!1}),t.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!h){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),h=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,h=!1,e.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;o.length>n;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.ui.safeBlur=function(e){e&&"body"!==e.nodeName.toLowerCase()&&t(e).trigger("blur")},t.widget("ui.draggable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blurActiveElement(e),this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=t.ui.safeActiveElement(this.document[0]),s=t(e.target);s.closest(i).length||t.ui.safeBlur(i)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp(new t.Event("mouseup",e)),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new t.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){var t=this;t.isOver?(t.isOver=0,s.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,s){t.each(s.sortables,function(){var n=!1,o=this;o.positionAbs=s.positionAbs,o.helperProportions=s.helperProportions,o.offset.click=s.offset.click,o._intersectsWith(o.containerCache)&&(n=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(n=!1),n})),n?(o.isOver||(o.isOver=1,s._parent=i.helper.parent(),o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return i.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=s.offset.click.top,o.offset.click.left=s.offset.click.left,o.offset.parent.left-=s.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=s.offset.parent.top-o.offset.parent.top,s._trigger("toSortable",e),s.dropped=o.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,o.fromOutside=s),o.currentItem&&(o._mouseDrag(e),i.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger("fromSortable",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,o=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+a.offsetHeight-e.pageY<n.scrollSensitivity?a.scrollTop=o=a.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+a.offsetWidth-e.pageX<n.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(r).scrollTop()<n.scrollSensitivity?o=t(r).scrollTop(t(r).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<n.scrollSensitivity&&(o=t(r).scrollTop(t(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(r).scrollLeft()<n.scrollSensitivity?o=t(r).scrollLeft(t(r).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<n.scrollSensitivity&&(o=t(r).scrollLeft(t(r).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,o,a,r,l,h,c,u,d,p,f=s.options,g=f.snapTolerance,m=i.offset.left,_=m+s.helperProportions.width,v=i.offset.top,b=v+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)l=s.snapElements[d].left-s.margins.left,h=l+s.snapElements[d].width,c=s.snapElements[d].top-s.margins.top,u=c+s.snapElements[d].height,l-g>_||m>h+g||c-g>b||v>u+g||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(n=g>=Math.abs(c-b),o=g>=Math.abs(u-v),a=g>=Math.abs(l-_),r=g>=Math.abs(h-m),n&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left)),p=n||o||a||r,"outer"!==f.snapMode&&(n=g>=Math.abs(c-v),o=g>=Math.abs(u-b),a=g>=Math.abs(l-m),r=g>=Math.abs(h-_),n&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(n||o||a||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=n||o||a||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,a=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(n=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable,t.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(s)?s:function(t){return t.is(s)},this.proportions=function(){return arguments.length?(e=arguments[0],void 0):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this._addActiveClass(),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this._removeActiveClass(),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&c(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var c=t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,s,n){if(!i.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,r=o+e.helperProportions.width,l=a+e.helperProportions.height,h=i.offset.left,c=i.offset.top,u=h+i.proportions().width,d=c+i.proportions().height;switch(s){case"fit":return o>=h&&u>=r&&a>=c&&d>=l;case"intersect":return o+e.helperProportions.width/2>h&&u>r-e.helperProportions.width/2&&a+e.helperProportions.height/2>c&&d>l-e.helperProportions.height/2;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,h,i.proportions().width);case"touch":return(a>=c&&d>=a||l>=c&&d>=l||c>a&&l>d)&&(o>=h&&u>=o||r>=h&&u>=r||h>o&&r>u);default:return!1}}}();t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;o.length>s;s++)if(!(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===o[s].element[0]){o[s].proportions().height=0;continue t}o[s].visible="none"!==o[s].element.css("display"),o[s].visible&&("mousedown"===a&&o[s]._activate.call(o[s],i),o[s].offset=o[s].element.offset(),o[s].proportions({width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight}))}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&c(e,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,o,a=c(e,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n}),o.length&&(s=t(o[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.uiBackCompat!==!1&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable,t.widget("ui.resizable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},_create:function(){var e,i=this.options,s=this;this._addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,e={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(e),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(e),this._proportionallyResize()),this._setupHandles(),i.autoHide&&t(this.element).on("mouseenter",function(){i.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())}).on("mouseleave",function(){i.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case"handles":this._removeHandles(),this._setupHandles();break;default:}},_setupHandles:function(){var e,i,s,n,o,a=this.options,r=this;if(this.handles=a.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},i=0;s.length>i;i++)e=t.trim(s[i]),n="ui-resizable-"+e,o=t("<div>"),this._addClass(o,"ui-resizable-handle "+n),o.css({zIndex:a.zIndex}),this.handles[e]=".ui-resizable-"+e,this.element.append(o);this._renderAxis=function(e){var i,s,n,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:r._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){r.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),r.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,s,n,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=t(o.containment).scrollLeft()||0,s+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,s,n=this.originalMousePosition,o=this.axis,a=e.pageX-n.left||0,r=e.pageY-n.top||0,l=this._change[o];return this._updatePrevProperties(),l?(i=l.apply(this,[e,a,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,o,a,r,l,h=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},r=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null,l=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null,h.animate||this.element.css(t.extend(a,{top:l,left:r})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!h.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s,n,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,s=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,n=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),s>o.minHeight&&(o.minHeight=s),o.maxWidth>i&&(o.maxWidth=i),o.maxHeight>n&&(o.maxHeight=n)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&h&&(t.left=r-e.minWidth),s&&h&&(t.left=r-e.maxWidth),a&&c&&(t.top=l-e.minHeight),n&&c&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],n=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseFloat(s[e])||0,i[e]+=parseFloat(n[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-a},h=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,c&&h?{top:c,left:h}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,s,n,o,a,r,l=t(this).resizable("instance"),h=l.options,c=l.element,u=h.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(l.containerElement=t(d),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){i[t]=l._num(e.css("padding"+s))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=l.containerOffset,n=l.containerSize.height,o=l.containerSize.width,a=l._hasScroll(d,"left")?d.scrollWidth:o,r=l._hasScroll(d)?d.scrollHeight:n,l.parentData={element:d,left:s.left,top:s.top,width:a,height:r}))},resize:function(e){var i,s,n,o,a=t(this).resizable("instance"),r=a.options,l=a.containerOffset,h=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),h.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=r.helper?l.left:0),h.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),i=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-u.left:a.offset.left-l.left)),s=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-u.top:a.offset.top-l.top)),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),s+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-s,c&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,s=e.containerOffset,n=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),l=a.outerWidth()-e.sizeDiff.width,h=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:l,height:h}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:l,height:h})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),i=e.options;t(i.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(e,i){var s=t(this).resizable("instance"),n=s.options,o=s.originalSize,a=s.originalPosition,r={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-a.top||0,left:s.position.left-a.left||0};t(n.alsoResize).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),n={},o=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(n[e]=i||null)}),e.css(n)})},stop:function(){t(this).removeData("ui-resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),t.uiBackCompat!==!1&&"string"==typeof e.options.ghost&&e.ghost.addClass(this.options.ghost),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),s=i.options,n=i.size,o=i.originalSize,a=i.originalPosition,r=i.axis,l="number"==typeof s.grid?[s.grid,s.grid]:s.grid,h=l[0]||1,c=l[1]||1,u=Math.round((n.width-o.width)/h)*h,d=Math.round((n.height-o.height)/c)*c,p=o.width+u,f=o.height+d,g=s.maxWidth&&p>s.maxWidth,m=s.maxHeight&&f>s.maxHeight,_=s.minWidth&&s.minWidth>p,v=s.minHeight&&s.minHeight>f;s.grid=l,_&&(p+=h),v&&(f+=c),g&&(p-=h),m&&(f-=c),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=a.top-d):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=a.left-u):((0>=f-c||0>=p-h)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=a.top-d):(f=c-e.height,i.size.height=f,i.position.top=a.top+o.height-f),p-h>0?(i.size.width=p,i.position.left=a.left-u):(p=h-e.width,i.size.width=p,i.position.left=a.left+o.width-p))}}),t.ui.resizable,t.widget("ui.sortable",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,l=r+t.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+h>r&&l>s+h,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&l>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),o=s&&n;return o?(e=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1)):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],l=[],h=this._connectWith();if(h&&e)for(s=h.length-1;s>=0;s--)for(o=t(h[s],this.document[0]),n=o.length-1;n>=0;n--)a=t.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&l.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=l.length-1;s>=0;s--)l[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,l,h,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,h=r.length;h>s;s++)l=t(r[s]),l.data(this.widgetName+"-item",a),c.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,l,h,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(l=this.items[s].item.offset()[a],h=!1,e[u]-l>this.items[s][r]/2&&(h=!0),n>Math.abs(e[u]-l)&&(n=Math.abs(e[u]-l),o=this.items[s],this.direction=h?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target),s=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&s.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.target).closest(".ui-menu-item"),s=t(e.currentTarget);i[0]===s[0]&&(this._removeClass(s.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,s))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){var i=!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]));i&&this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),i=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),i.children().each(function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(e){var i,s,n,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,s=this.previousFilter||"",o=!1,n=e.keyCode>=96&&105>=e.keyCode?""+(e.keyCode-96):String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),n===s?o=!0:n=s+n,i=this._filterMenuItems(n),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i,s,n,o,a=this,r=this.options.icons.submenu,l=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),s=l.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.prev(),s=t("<span>").data("ui-menu-submenu-caret",!0);a._addClass(s,"ui-menu-icon","ui-icon "+r),i.attr("aria-haspopup","true").prepend(s),e.attr("aria-labelledby",i.attr("id"))}),this._addClass(s,"ui-menu","ui-widget ui-widget-content ui-front"),e=l.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);a._isDivider(e)&&a._addClass(e,"ui-menu-divider","ui-widget-content")}),n=i.not(".ui-menu-item, .ui-menu-divider"),o=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t+""),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,s,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children(".ui-menu-item-wrapper"),this._addClass(s,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),n=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this._removeClass(s.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))})}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,void 0;e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),void 0):(this._searchTimeout(t),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(t),this._change(t),void 0)}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&t.trim(s).length&&(this.liveRegion.children().hide(),t("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,i){var s=i.item.data("ui-autocomplete-item"),n=this.previous;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=s})),!1!==this._trigger("select",e,{item:s})&&this._value(s.value),this.term=this._value(),this.close(e),this.selectedItem=s}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var i=this.menu.element[0];return e.target===this.element[0]||e.target===i||t.contains(i,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<div>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[t](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var u=/ui-corner-([a-z]){2,6}/g;t.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var e=this,i=[];t.each(this.options.items,function(s,n){var o,a={};return n?"controlgroupLabel"===s?(o=e.element.find(n),o.each(function(){var e=t(this);e.children(".ui-controlgroup-label-contents").length||e.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),e._addClass(o,null,"ui-widget ui-widget-content ui-state-default"),i=i.concat(o.get()),void 0):(t.fn[s]&&(a=e["_"+s+"Options"]?e["_"+s+"Options"]("middle"):{classes:{}},e.element.find(n).each(function(){var n=t(this),o=n[s]("instance"),r=t.widget.extend({},a);if("button"!==s||!n.parent(".ui-spinner").length){o||(o=n[s]()[s]("instance")),o&&(r.classes=e._resolveClassesValues(r.classes,o)),n[s](r);var l=n[s]("widget");t.data(l[0],"ui-controlgroup-data",o?o:n[s]("instance")),i.push(l[0])}})),void 0):void 0}),this.childWidgets=t(t.unique(i)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var i=t(this),s=i.data("ui-controlgroup-data");s&&s[e]&&s[e]()})},_updateCornerClass:function(t,e){var i="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all",s=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,i),this._addClass(t,null,s)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,s={classes:{}};return s.classes[e]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],s},_spinnerOptions:function(t){var e=this._buildSimpleOptions(t,"ui-spinner");return e.classes["ui-spinner-up"]="",e.classes["ui-spinner-down"]="",e},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(e,i){var s={};return t.each(e,function(n){var o=i.options.classes[n]||"";o=t.trim(o.replace(u,"")),s[n]=(o+" "+e[n]).replace(/\s+/g," ")}),s},_setOption:function(t,e){return"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"===t?(this._callChildMethod(e?"disable":"enable"),void 0):(this.refresh(),void 0)},refresh:function(){var e,i=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),e=this.childWidgets,this.options.onlyVisible&&(e=e.filter(":visible")),e.length&&(t.each(["first","last"],function(t,s){var n=e[s]().data("ui-controlgroup-data");if(n&&i["_"+n.widgetName+"Options"]){var o=i["_"+n.widgetName+"Options"](1===e.length?"only":s);o.classes=i._resolveClassesValues(o.classes,n),n.element[n.widgetName](o)}else i._updateCornerClass(e[s](),s)}),this._callChildMethod("refresh"))}}),t.widget("ui.checkboxradio",[t.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var e,i,s=this,n=this._super()||{};return this._readType(),i=this.element.labels(),this.label=t(i[i.length-1]),this.label.length||t.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){s.originalLabel+=3===this.nodeType?t(this).text():this.outerHTML}),this.originalLabel&&(n.label=this.originalLabel),e=this.element[0].disabled,null!=e&&(n.disabled=e),n},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var e=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===e&&/radio|checkbox/.test(this.type)||t.error("Can't create checkboxradio on element.nodeName="+e+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var e,i=this.element[0].name,s="input[name='"+t.ui.escapeSelector(i)+"']";return i?(e=this.form.length?t(this.form[0].elements).filter(s):t(s).filter(function(){return 0===t(this).form().length}),e.not(this.element)):t([])},_toggleClasses:function(){var e=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",e)._toggleClass(this.icon,null,"ui-icon-blank",!e),"radio"===this.type&&this._getRadioGroup().each(function(){var e=t(this).checkboxradio("instance");e&&e._removeClass(e.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){return"label"!==t||e?(this._super(t,e),"disabled"===t?(this._toggleClass(this.label,null,"ui-state-disabled",e),this.element[0].disabled=e,void 0):(this.refresh(),void 0)):void 0},_updateIcon:function(e){var i="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=t("<span>"),this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(i+=e?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,e?"ui-icon-blank":"ui-icon-check")):i+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",i),e||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),t.ui.checkboxradio,t.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),t=this.element[0].disabled,null!=t&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(e){e.keyCode===t.ui.keyCode.SPACE&&(e.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(e,i){var s="iconPosition"!==e,n=s?this.options.iconPosition:i,o="top"===n||"bottom"===n;this.icon?s&&this._removeClass(this.icon,null,this.options.icon):(this.icon=t("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),s&&this._addClass(this.icon,null,i),this._attachIcon(n),o?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=t("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(n))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=void 0===t.showLabel?this.options.showLabel:t.showLabel,i=void 0===t.icon?this.options.icon:t.icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e,e&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),t.uiBackCompat!==!1&&(t.widget("ui.button",t.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){return"text"===t?(this._super("showLabel",e),void 0):("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments),void 0)}}),t.fn.button=function(e){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?e.apply(this,arguments):(t.ui.checkboxradio||t.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}(t.fn.button),t.fn.buttonset=function(){return t.ui.controlgroup||t.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.12.1"}});var d;t.extend(s.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return a(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.on("focus",this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[r?"before":"after"](i.trigger),i.trigger.on("click",function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,n,o){var r,l,h,c,u,d=this._dialogInst;return d||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),a(d.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,h/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),d===n&&(d=null))},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,s){var n,o,r,l,h=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):h?"all"===i?t.extend({},h.settings):this._get(h,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),h&&(this._curInst===h&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),r=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),a(h.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(h.settings.minDate=this._formatDate(h,r)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),h),this._autoSize(h),this._setDate(h,o),this._updateAlternate(h),this._updateDatepicker(h)),void 0)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var s,n,o,r,l,h,c;s=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==s&&(t.datepicker._curInst.dpDiv.stop(!0,!0),s&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(s,"beforeShow"),o=n?n.apply(e,[e,s]):{},o!==!1&&(a(s.settings,o),s.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(s),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),r=!1,t(e).parents().each(function(){return r|="fixed"===t(this).css("position"),!r}),l={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(s),l=t.datepicker._checkOffset(s,l,r),s.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":r?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),s.inline||(h=t.datepicker._get(s,"showAnim"),c=t.datepicker._get(s,"duration"),s.dpDiv.css("z-index",i(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[h]?s.dpDiv.show(h,t.datepicker._get(s,"showOptions"),c):s.dpDiv[h||"show"](h?c:null),t.datepicker._shouldFocusInput(s)&&s.input.trigger("focus"),t.datepicker._curInst=s))}},_updateDatepicker:function(e){this.maxRows=4,d=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),n=s[1],a=17,r=e.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.trigger("focus"),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),h=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-a:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,a=this._curInst;!a||e&&a!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(a,"showAnim"),s=this._get(a,"duration"),n=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),s,n):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,a=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).val(n))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,o,a,r,l=0,h=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),u=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,d=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,_=-1,v=-1,b=!1,y=function(t){var i=e.length>n+1&&e.charAt(n+1)===t;return i&&n++,i},w=function(t){var e=y(t),s="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n="y"===t?s:1,o=RegExp("^\\d{"+n+","+s+"}"),a=i.substring(l).match(o);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},k=function(e,s,n){var o=-1,a=t.map(y(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(a,function(t,e){var s=e[1];return i.substr(l,s.length).toLowerCase()===s.toLowerCase()?(o=e[0],l+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==e.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;e.length>n;n++)if(b)"'"!==e.charAt(n)||y("'")?x():b=!1;else switch(e.charAt(n)){case"d":_=w("d");break;case"D":k("D",u,d);break;case"o":v=w("o");break;case"m":m=w("m");break;case"M":m=k("M",p,f);break;case"y":g=w("y");break;case"@":r=new Date(w("@")),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"!":r=new Date((w("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"'":y("'")?x():b=!0;break;default:x()}if(i.length>l&&(a=i.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=g?0:-100)),v>-1)for(m=1,_=v;;){if(o=this._getDaysInMonth(g,m-1),o>=_)break;m++,_-=o}if(r=this._daylightSavingAdjust(new Date(g,m-1,_)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==_)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},h=function(t,e,i){var s=""+e;if(l(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return l(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||l("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=h("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,o);break;case"o":u+=h("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),a,r);break;case"y":u+=l("y")?e.getFullYear():(10>e.getFullYear()%100?"0":"")+e.getFullYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(r){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":r+=parseInt(h[1],10);break;case"w":case"W":r+=7*parseInt(h[1],10);break;case"m":case"M":a+=parseInt(h[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(h[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}h=l.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).on(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,a,r,l,h,c,u,d,p,f,g,m,_,v,b,y,w,k,x,C,D,T,I,M,P,S,N,H,A,z,O,E,W,F,L,R=new Date,Y=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),B=this._get(t,"isRTL"),j=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),X=this._get(t,"stepMonths"),$=1!==U[0]||1!==U[1],G=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,te=t.drawYear;if(0>Z&&(Z+=12,te--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-U[0]*U[1]+1,Q.getDate())),e=J&&J>e?J:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-X,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+X,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?G:Y,a=K?this.formatDate(a,r,this._getFormatConfig(t)):a,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",h=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),_=this._get(t,"showOtherMonths"),v=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;U[0]>k;k++){for(x="",this.maxRows=4,C=0;U[1]>C;C++){if(D=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),T=" ui-corner-all",I="",$){if(I+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:I+=" ui-datepicker-group-first",T=" ui-corner-"+(B?"right":"left");break;case U[1]-1:I+=" ui-datepicker-group-last",T=" ui-corner-"+(B?"left":"right");break;default:I+=" ui-datepicker-group-middle",T=""}I+="'>"}for(I+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===k?B?o:s:"")+(/all|right/.test(T)&&0===k?B?s:o:"")+this._generateMonthYearHeader(t,Z,te,J,Q,k>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",M=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)P=(w+c)%7,M+="<th scope='col'"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[P]+"'>"+p[P]+"</span></th>";for(I+=M+"</tr></thead><tbody>",S=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,S)),N=(this._getFirstDayOfMonth(te,Z)-c+7)%7,H=Math.ceil((N+S)/7),A=$?this.maxRows>H?this.maxRows:H:H,this.maxRows=A,z=this._daylightSavingAdjust(new Date(te,Z,1-N)),O=0;A>O;O++){for(I+="<tr>",E=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(z)+"</td>":"",w=0;7>w;w++)W=m?m.apply(t.input?t.input[0]:null,[z]):[!0,""],F=z.getMonth()!==Z,L=F&&!v||!W[0]||J&&J>z||Q&&z>Q,E+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(z.getTime()===D.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===z.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!_?"":" "+W[1]+(z.getTime()===G.getTime()?" "+this._currentClass:"")+(z.getTime()===Y.getTime()?" ui-datepicker-today":""))+"'"+(F&&!_||!W[2]?"":" title='"+W[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+z.getMonth()+"' data-year='"+z.getFullYear()+"'")+">"+(F&&!_?"&#xa0;":L?"<span class='ui-state-default'>"+z.getDate()+"</span>":"<a class='ui-state-default"+(z.getTime()===Y.getTime()?" ui-state-highlight":"")+(z.getTime()===G.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+z.getDate()+"</a>")+"</td>",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);I+=E+"</tr>"}Z++,Z>11&&(Z=0,te++),I+="</tbody></table>"+($?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=I}y+=x}return y+=h,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var l,h,c,u,d,p,f,g,m=this._get(t,"changeMonth"),_=this._get(t,"changeYear"),v=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(o||!m)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=s.getMonth())&&(!h||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+r[c]+"</option>");y+="</select>"}if(v||(b+=y+(!o&&m&&_?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!_)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),g=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),v&&(b+=(!o&&m&&_?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.selectedYear+("Y"===i?e:0),n=t.selectedMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).on("mousedown",t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new s,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.12.1",t.datepicker,t.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i=this;this._isOpen&&this._trigger("beforeClose",e)!==!1&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||t.ui.safeBlur(t.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",e)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),o=Math.max.apply(null,n);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),s=!0),s&&!i&&this._trigger("focus",e),s},open:function(){var e=this;return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=t(t.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).trigger("focus")},_keepFocus:function(e){function i(){var e=t.ui.safeActiveElement(this.document[0]),i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.trigger("focus")}),e.preventDefault()):(this._delay(function(){s.trigger("focus")}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:t("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(e,"ui-dialog-title"),this._title(e),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this._removeClass(this.uiDialog,"ui-dialog-buttons"),void 0):(t.each(i,function(i,s){var n,o;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,o={icon:s.icon,iconPosition:s.iconPosition,showLabel:s.showLabel,icons:s.icons,text:s.text},delete s.click,delete s.icon,delete s.iconPosition,delete s.showLabel,delete s.icons,"boolean"==typeof s.text&&delete s.text,t("<button></button>",s).button(o).appendTo(e.uiButtonSet).on("click",function(){n.apply(e.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){i._addClass(t(this),"ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,o){var a=o.offset.left-i.document.scrollLeft(),r=o.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" "+"top"+(r>=0?"+":"")+r,of:i.window},i._removeClass(t(this),"ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(o))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:a,start:function(s,n){i._addClass(t(this),"ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,o){var a=i.uiDialog.offset(),r=a.left-i.document.scrollLeft(),l=a.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(l>=0?"+":"")+l,of:i.window},i._removeClass(t(this),"ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(o))}}).css("position",o)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,s=!1,n={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,i){var s,n,o=this.uiDialog;"disabled"!==e&&(this._super(e,i),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:t("<a>").text(""+this.options.closeText).html()}),"draggable"===e&&(s=o.is(":data(ui-draggable)"),s&&!i&&o.draggable("destroy"),!s&&i&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(n=o.is(":data(ui-resizable)"),n&&!i&&o.resizable("destroy"),n&&"string"==typeof i&&o.resizable("option","handles",i),n||i===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),t.uiBackCompat!==!1&&t.widget("ui.dialog",t.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),t.ui.dialog,t.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=t("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),void 0)},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,e===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectmenu",[t.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=t()},_drawButton:function(){var e,i=this,s=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),e=t("<span>").appendTo(this.button),this._addClass(e,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(s).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){i._rendered||i._refreshMenu()})},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var s=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger("focus",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr("aria-activedescendant",e.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t,e=this.element.find("option");this.menu.empty(),this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,e.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(e){var i=t("<span>");return this._setText(i,e.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(e,i){var s=this,n="";t.each(i,function(i,o){var a;o.optgroup!==n&&(a=t("<li>",{text:o.optgroup}),s._addClass(a,"ui-selectmenu-optgroup","ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),a.appendTo(e),n=o.optgroup),s._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var s=t("<li>"),n=t("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(s,null,"ui-state-disabled"),this._setText(n,i.label),s.append(n).appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),n+=":not(.ui-state-disabled)"),s="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](n).eq(-1):i[t+"All"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+t.ui.escapeSelector(this.ids.button)).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){if("icons"===t){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)}this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;return t===!1?(this.button.css("width",""),void 0):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t),void 0)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(e){var i=this,s=[];e.each(function(e,n){s.push(i._parseOption(t(n),e))}),this.items=s},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),t.widget("ui.slider",t.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle"),o="<span tabindex='0'></span>",a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push(o);this.handles=n.add(t(a.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e).attr("tabIndex",0)})},_createRange:function(){var e=this.options;e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=t("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),("min"===e.range||"max"===e.range)&&this._addClass(this.range,"ui-slider-range-"+e.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,r,l,h,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,this._addClass(o,null,"ui-state-active"),o.trigger("focus"),l=o.offset(),h=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=h?{left:0,top:0}:{left:e.pageX-l.left-o.width()/2,top:e.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_uiHash:function(t,e,i){var s={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(s.value=void 0!==e?e:this.values(t),s.values=i||this.values()),s},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var s,n,o=this.value(),a=this.values();this._hasMultipleValues()&&(n=this.values(e?0:1),o=this.values(e),2===this.options.values.length&&this.options.range===!0&&(i=0===e?Math.min(n,i):Math.max(n,i)),a[e]=i),i!==o&&(s=this._trigger("slide",t,this._uiHash(e,i,a)),s!==!1&&(this._hasMultipleValues()?this.values(e,i):this.value(i)))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),this._super(e,i),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=n-1;s>=0;s--)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this._hasMultipleValues()){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step,s=Math.round((t-e)/i)*i;t=s+e,t>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,l=this,h=this._animateOff?!1:r.animate,c={};this._hasMultipleValues()?this.handles.each(function(s){i=100*((l.values(s)-l._valueMin())/(l._valueMax()-l._valueMin())),c["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[h?"animate":"css"](c,r.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===s&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},r.animate),1===s&&l.range[h?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&l.range[h?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((s-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:100-i+"%"},r.animate),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:100-i+"%"},r.animate))},_handleEvents:{keydown:function(e){var i,s,n,o,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(t(e.target),null,"ui-state-active"),i=this._start(e,a),i===!1))return}switch(o=this.options.step,s=n=this._hasMultipleValues()?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-o)}this._slide(e,a,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),this._removeClass(t(e.target),null,"ui-state-active"))}}}),t.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var e=t(this).attr("title")||"";return t("<a>").text(e).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))},_removeDescribedBy:function(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=t("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=t([])},_setOption:function(e,i){var s=this;this._super(e,i),"content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s.element[0],e.close(n,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var e=t(this);return e.is("[title]")?e.data("ui-tooltip-title",e.attr("title")).removeAttr("title"):void 0}))},_enable:function(){this.disabledTitles.each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))}),this.disabledTitles=t([])},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(e,s),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,o=e?e.type:null;return"string"==typeof s||s.nodeType||s.jquery?this._open(e,t,s):(i=s.call(t[0],function(i){n._delay(function(){t.data("ui-tooltip-open")&&(e&&(e.type=o),this._open(e,t,i))})}),i&&this._open(e,t,i),void 0)},_open:function(e,i,s){function n(t){h.of=t,a.is(":hidden")||a.position(h)}var o,a,r,l,h=t.extend({},this.options.position);if(s){if(o=this._find(i))return o.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(e&&"mouseover"===e.type?i.attr("title",""):i.removeAttr("title")),o=this._tooltip(i),a=o.tooltip,this._addDescribedBy(i,a.attr("id")),a.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),l=t("<div>").html(a.find(".ui-tooltip-content").html()),l.removeAttr("name").find("[name]").removeAttr("name"),l.removeAttr("id").find("[id]").removeAttr("id"),l.appendTo(this.liveRegion),this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):a.position(t.extend({of:i},this.options.position)),a.hide(),this._show(a,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){a.is(":visible")&&(n(h.of),clearInterval(r))},t.fx.interval)),this._trigger("open",e,{tooltip:a})}},_registerCloseHandlers:function(e,i){var s={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var s=t.Event(e);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),e&&"mouseover"!==e.type||(s.mouseleave="close"),e&&"focusin"!==e.type||(s.focusout="close"),this._on(!0,i,s)},close:function(e){var i,s=this,n=t(e?e.currentTarget:this.element),o=this._find(n);return o?(i=o.tooltip,o.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),o.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),o.closing=!0,this._trigger("close",e,{tooltip:i}),o.hiding||(o.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(e){var i=t("<div>").attr("role","tooltip"),s=t("<div>").appendTo(i),n=i.uniqueId().attr("id");return this._addClass(s,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(e)),this.tooltips[n]={element:e,tooltip:i}},_find:function(t){var e=t.data("ui-tooltip-id");return e?this.tooltips[e]:null},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){var e=t.closest(".ui-front, dialog");return e.length||(e=this.document[0].body),e},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur"),o=s.element;n.target=n.currentTarget=o[0],e.close(n,!0),t("#"+i).remove(),o.data("ui-tooltip-title")&&(o.attr("title")||o.attr("title",o.data("ui-tooltip-title")),o.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),t.uiBackCompat!==!1&&t.widget("ui.tooltip",t.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),t.ui.tooltip});try{jQuery = $;}catch(e){console.log('jQuery doesnot exist');}var $ = function (selector) {if(selector.includes('#') && (!selector.includes(' ') || selector.includes(','))){var item = document.querySelector(selector);if(item){return item;}else{return [];}}else{return Array.prototype.slice.call(document.querySelectorAll(selector));}};String.prototype.title = function() {return this.charAt(0).toUpperCase() + this.slice(1);};create = function(element){return document.createElement(element);};log = function(log){console.log(log);};window.width = window.innerWidth;Element.prototype.grid = function(){this.style.display = 'grid';};Element.prototype.next = function(){return this.nextElementSibling;};Element.prototype.prev = function(){return this.previousElementSibling;};Element.prototype.last = function(){return this.lastElementChild;};Element.prototype.active = function(){if(this.className.includes('active')){this.removeClass('active');}else{this.addClass('active');}};Element.prototype.parent = function(){return this.parentElement;};Element.prototype.find = function(selector){try{if(selector.includes('#') && (!selector.includes(' ') || selector.includes(','))){return this.querySelector(selector);}else{return Array.prototype.slice.call(this.querySelectorAll(selector));}}catch(e){log(e);}};Element.prototype.replace = function(n,o){this.replaceChild(n,o);};Element.prototype.append = function(child){if(child){this.appendChild(child);}};Element.prototype.before = function(child,before){if(child){if(!before)before = this.childNodes[0];else{before = this.childNodes[before];}this.insertBefore(child,before);}};Element.prototype.clear = function(){while(this.firstChild){this.removeChild(this.firstChild);}};Element.prototype.each = function(func){for(i=0;i<this.children.length;i++){func(this.children[i]);}};Element.prototype.attr = function(name){return this.getAttribute(name)};Element.prototype.get = function(name){return this.getAttribute(name)};Element.prototype.set = function(name,value){return this.setAttribute(name,value);};Element.prototype.removeAttr = function(name){return this.removeAttribute(name);};Element.prototype.html = function(html){this.innerHTML = html;};Element.prototype.first = function(){return this.firstElementChild;};Element.prototype.show = function(){this.style.display = 'block';};Element.prototype.hide = function(){this.style.display = 'none';};Element.prototype.addClass = function(name){this.className += ' ' + name;};Element.prototype.removeClass = function(name){this.className = this.className.replace(name,'');};Element.prototype.hasClass = function(name){if(this.className.includes(name))return true;else{return false}};Element.prototype.on = function(events,listener){events = events.split(' ');for(event in events){this.addEventListener(events[event],listener)}};Array.prototype.each = function(func){for(i=0;i < this.length;i++){func(this[i]);}};Array.prototype.next = function(){return this[0].nextElementSibling;};Array.prototype.on = function(event,listener,selector){events = event.split(' ');this.forEach(function(elem){for(event in events){elem.addEventListener(events[event],listener)}}) };Array.prototype.append = function(child){this.forEach(function(elem){elem.append(child)})};Array.prototype.active = function(){this.forEach(function(elem){if(elem.className.includes('active')){elem.removeClass('active');}else{elem.addClass('active');}})};Array.prototype.before = function(child,before){this.forEach(function(elem){if(!before)before = elem.childNodes[0];else{before = elem.childNodes[before];}elem.insertBefore(child,before)})};Array.prototype.hasClass = function(name){if(this[0].className.includes(name))return true;else{return false}};Array.prototype.html = function(html){this.forEach(function(elem){elem.innerHTML = html;})};Array.prototype.set = function(name,value){this.forEach(function(elem){elem.setAttribute(name,value);})};Array.prototype.text = function(text){if(text){try{this[0].firstChild.nodeValue = text;}catch(e){t = document.createTextNode(text);this.append(t);}}else{try{return this[0].firstChild.nodeValue;}catch(e){return undefined;}}};Array.prototype.width = function(){return this[0].clientWidth;};Array.prototype.height = function(){return this[0].clientHeight;};Element.prototype.height = function(){return this.clientHeight;};Element.prototype.text = function(text){if(text){try{this.firstChild.nodeValue = text;}catch(e){t = document.createTextNode(text);this.append(t);}}else{return this.firstChild.nodeValue;}};Element.prototype.width = function(){return this.clientWidth;};Element.prototype.top = function(value){this.style['top'] = value;};Element.prototype.enable = function(){this.removeAttr('disabled');};Element.prototype.disable = function(){this.set('disabled','');};HTMLElement.prototype.css = function(attr,value){this.style[attr] = value;};function serialize(){var i, j, q = [];var data = new FormData();for (i = this.elements.length - 1; i >= 0; i = i - 1) {if (this.elements[i].name === "") {continue;}switch (this.elements[i].nodeName) {case 'INPUT':switch (this.elements[i].type) {case 'text':case 'hidden':case 'password':case 'button':case 'reset':case 'submit':case 'number':case 'date':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'checkbox':case 'radio':if (this.elements[i].checked) {data.append(this.elements[i].name, this.elements[i].value);}break;case 'file':file = this.elements[i].files[0];if(file){data.append(file.name, file);}break;}break; case 'TEXTAREA':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'SELECT':switch (this.elements[i].type) {case 'select-one':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'select-multiple':for (j = this.elements[i].options.length - 1; j >= 0; j = j - 1) {if (this.elements[i].options[j].selected) {data.append(this.elements[i].name, this.elements[i].options[j].value);}}break;}break;case 'BUTTON':switch (this.elements[i].type) {case 'reset':case 'submit':case 'button':data.append(this.elements[i].name, this.elements[i].value);break;}break;}}return data;}function serializeJSON(){var i, j, q = [];var data = {};for (i = this.elements.length - 1; i >= 0; i = i - 1) {if (this.elements[i].name === "") {continue;}switch (this.elements[i].nodeName) {case 'INPUT':switch (this.elements[i].type) {case 'text':case 'hidden':case 'password':case 'button':case 'reset':case 'submit':case 'number':case 'date':case 'email':case 'tel':if(this.elements[i].name.includes('[]') && this.elements[i].value){name = this.elements[i].name.replace('[]','');if(!data[name])data[name] = [];data[name].push(this.elements[i].value);}else if(this.elements[i].value)data[this.elements[i].name] = this.elements[i].value;break;case 'checkbox':case 'radio':if (this.elements[i].checked) {data[this.elements[i].name] = this.elements[i].value;}break;case 'file':if(this.elements[i].name == 'images'){if(!data['images'])data['images'] = [];data['images'].push(this.elements[i].get('value'));}else{data[this.elements[i].name] = this.elements[i].get('value');}break;}break; case 'TEXTAREA':if(this.elements[i].value)data[this.elements[i].name] = this.elements[i].value;break;case 'SELECT':switch (this.elements[i].type) {case 'select-one':if(this.elements[i].name.includes('[]') && this.elements[i].value){name = this.elements[i].name.replace('[]','');if(!data[name])data[name] = [];data[name].push(this.elements[i].value);}else if(this.elements[i].value)data[this.elements[i].name] = this.elements[i].value;break;case 'select-multiple':for (j = this.elements[i].options.length - 1; j >= 0; j = j - 1) {if (this.elements[i].options[j].selected) {data[this.elements[i].name] = this.elements[i].options[j].value;}}break;}break;case 'BUTTON':switch (this.elements[i].type) {case 'reset':case 'submit':case 'button':data[this.elements[i].name] = this.elements[i].value;break;}break;}}return data;}HTMLFormElement.prototype.serializeJSON = serializeJSON;HTMLFormElement.prototype.serialize = serialize;Array.prototype.serialize = function(){return this[0].serialize();};Array.prototype.serializeJSON = function(){return this[0].serializeJSON();};cookie = function(){};cookie.toString = function(){return document.cookie;};cookie.get = function (cname) {name = cname + "=";decodedCookie = decodeURIComponent(cookie);ca = decodedCookie.split(';');for(i = 0; i <ca.length; i++) {c = ca[i];while (c.charAt(0) == ' ') {c = c.substring(1);}if (c.indexOf(name) == 0) {return c.substring(name.length, c.length);}}return "";};storage = localStorage;history = window.history;http = new XMLHttpRequest();body = $('body');loading = create('div');loading.hide();loading.set('id','loading');form = create('div');form.hide();form.set('id','form');bg = create('div');bg.hide();bg.set('id','bg');bg.on('click',function(){form.hide();this.hide();});body.append(bg);body.append(form);body.append(loading);http.get = function(url){this.method = 'GET';this.url = url;this.request();};http.post = function(url,data){this.method = 'POST';this.url = url;this.data = data;this.request();};http.response = http.responseText;http.request = function(){loading.show();this.open(this.method,this.url);if(this.method == 'POST'){if(this.data instanceof FormData){this.setRequestHeader("X-CSRFToken", cookie.get('csrftoken'));}else if(typeof this.data == 'object'){this.data = JSON.stringify(this.data);this.setRequestHeader("X-CSRFToken", cookie.get('csrftoken'));this.setRequestHeader("Content-Type", "application/json");}else{this.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');}}this.setRequestHeader('X-Requested-With','XMLHttpRequest');this.onreadystatechange = function(){switch(this.readyState){case 4: loading.hide();if(this.status == 200){if(this.getResponseHeader('Content-Type') == 'application/json'){try{this.json = JSON.parse(this.responseText);}catch(e){console.log(e);}}this.text = this.responseText;try{this.action();}catch(e){log(e);/*this.render();*/}}else{this.alert(this.status);}break;}};this.send(this.data);};http.render = function(json){if(this.json){form.html(JSON.stringify(this.json));}else{form.html(this.text);}form.show();form.top(form.offsetTop + 18 + 'px');bg.show();form.css('margin-left', window.width/2 - form.width()/2 + 'px');};httpAlert = create('div');httpAlert.set('id','http-alert');httpAlert.hide();message = create('div');message.set('id','message');close = create('div');close.set('class','close');httpAlert.append(close);httpAlert.append(message);body.append(httpAlert);timeout = false;http.alert = function(text,scnds){if(!scnds)scnds = 3000;message.html(text);httpAlert.show();timeout = setTimeout(function(){httpAlert.hide()},scnds);};httpAlert.on('mouseover',function(){if(timeout)clearTimeout(timeout);});httpAlert.on('mouseout',function(){timeout = setTimeout(function(){httpAlert.hide()},3000);});close.on('click',function(){httpAlert.hide();});http.renderErrors = function(){text = '';errors = this.json.errors;for(error in errors){text += `${error}: ${errors[error]}` + '<br> <br>';}this.alert(text,10000)};function theme(color){storage.theme = color;$('header').set('class',color);}if(window.model){current = $(`menu a[model="${model}"]`)[0];current.active();current.parent().active();current.parent().parent().active();}if(!storage.theme)storage.theme = 'black';$('header').set('class',storage.theme);$('#theme .color').on('click',function(event){theme(this.get('color'));});$('menu .parent').on('click',function(event){this.active();this.find('.sub').active();});var current;$('menu .load').on('click',function(){$('#search-text').set('model',this.get('model'));this.active();if(current)current.active();current = this;});$('#shop').on('click',function(){location.href = this.href;});$('#signout').on('click',function(){location.href = this.href;});$('body').on('click',function(){var filters = $('#filters');if(filters.style && filters.style.display == 'grid'){filters.hide();}if(window.panel && panel.className.includes('active')){panel.active();panel_buttons.active();}});jQuery('menu').mCustomScrollbar({scrollInertia:100});$('.load').on('click',function(event){router.get(this.get('href'),this.get('view'),false,this.get('item-id'));event.preventDefault();event.stopPropagation();return false;});jQuery(document).ready(function(){try{for(key of view.url.searchParams.entries()){if($(`#filters #${key[0]}`).length)$(`#filters #${key[0]}`)[0].value = key[1];}}catch(e){}});timeout = false;$('#search-text').on('input paste keypress',function(event){if(this.value && this.value.length >= 3){input = this;if(timeout)clearTimeout(timeout);timeout = setTimeout(function(){url = '/search/'+input.get('model')+'?value=' + input.value;router.get(url,'reload','#items');},500);}});$('#change-database').on('change select',function(){var database = this.value;var url = this.get('url');http.action = function(){storage.database = JSON.stringify({'database':database,'url':url});location.reload(true);};http.get('/change_database?database='+database);});/*Redactor IIVersion 2.4Updated: March 24, 2017http://imperavi.com/redactor/Copyright (c) 2009-2017, Imperavi LLC.License: http://imperavi.com/redactor/license/Usage: $('#content').redactor();*/(function($){'use strict';if (!Function.prototype.bind){Function.prototype.bind = function(scope){var fn = this;return function(){return fn.apply(scope);};};}var uuid = 0;$.fn.redactor = function(options){var val = [];var args = Array.prototype.slice.call(arguments, 1);if (typeof options === 'string'){this.each(function(){var instance = $.data(this, 'redactor');var func;if (options.search(/\./) !== '-1'){func = options.split('.');if (typeof instance[func[0]] !== 'undefined'){func = instance[func[0]][func[1]];}}else{func = instance[options];}if (typeof instance !== 'undefined' && $.isFunction(func)){var methodVal = func.apply(instance, args);if (methodVal !== undefined && methodVal !== instance){val.push(methodVal);}}else{$.error('No such method "' + options + '" for Redactor');}});}else{this.each(function(){$.data(this, 'redactor', {});$.data(this, 'redactor', Redactor(this, options));});}if (val.length === 0){return this;}else if (val.length === 1){return val[0];}else{return val;}};function Redactor(el, options){return new Redactor.prototype.init(el, options);}$.Redactor = Redactor;$.Redactor.VERSION = '2.4';$.Redactor.modules = ['air', 'autosave', 'block', 'buffer', 'build', 'button', 'caret', 'clean', 'code', 'core', 'detect', 'dropdown',  'events', 'file', 'focus', 'image', 'indent', 'inline', 'insert', 'keydown', 'keyup',  'lang', 'line', 'link', 'linkify', 'list', 'marker', 'modal', 'observe', 'offset', 'paragraphize', 'paste', 'placeholder',  'progress', 'selection', 'shortcuts', 'storage', 'toolbar', 'upload', 'uploads3', 'utils',  'browser'   ];$.Redactor.settings = {};$.Redactor.opts = {animation: false,lang: 'en',direction: 'ltr',spellcheck: true,overrideStyles: true,scrollTarget: document,focus: false,focusEnd: false,clickToEdit: false,structure: false,tabindex: false,minHeight: false, maxHeight: false, maxWidth: false, plugins: false, callbacks: {},placeholder: false,linkify: true,enterKey: true,pastePlainText: false,pasteImages: true,pasteLinks: true,pasteBlockTags: ['pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'table', 'tbody', 'thead', 'tfoot', 'th', 'tr', 'td', 'ul', 'ol', 'li', 'blockquote', 'p', 'figure', 'figcaption'],pasteInlineTags: ['br', 'strong', 'ins', 'code', 'del', 'span', 'samp', 'kbd', 'sup', 'sub', 'mark', 'var', 'cite', 'small', 'b', 'u', 'em', 'i'],preClass: false, preSpaces: 4, tabAsSpaces: false, tabKey: true,autosave: false, autosaveName: false,autosaveFields: false,imageUpload: null,imageUploadParam: 'file',imageUploadFields: false,imageUploadForms: false,imageTag: 'figure',imageEditable: true,imageCaption: true,imagePosition: false,imageResizable: false,imageFloatMargin: '10px',dragImageUpload: true,multipleImageUpload: true,clipboardImageUpload: true,fileUpload: null,fileUploadParam: 'file',fileUploadFields: false,fileUploadForms: false,dragFileUpload: true,s3: false,linkNewTab: false,linkTooltip: true,linkNofollow: false,linkSize: 30,pasteLinkTarget: false,videoContainerClass: 'video-container',toolbar: true,toolbarFixed: true,toolbarFixedTarget: document,toolbarFixedTopOffset: 0, toolbarExternal: false, air: false,airWidth: false,formatting: ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'],formattingAdd: false,buttons: ['format', 'bold', 'italic', 'deleted', 'lists', 'image', 'file', 'link'], buttonsHide: [],buttonsHideOnMobile: [],script: true,removeNewlines: false,removeComments: true,replaceTags: {'b': 'strong','i': 'em','strike': 'del'},shortcuts: {'ctrl+shift+m, meta+shift+m': { func: 'inline.removeFormat' },'ctrl+b, meta+b': { func: 'inline.format', params: ['bold'] },'ctrl+i, meta+i': { func: 'inline.format', params: ['italic'] },'ctrl+h, meta+h': { func: 'inline.format', params: ['superscript'] },'ctrl+l, meta+l': { func: 'inline.format', params: ['subscript'] },'ctrl+k, meta+k': { func: 'link.show' },'ctrl+shift+7':   { func: 'list.toggle', params: ['orderedlist'] },'ctrl+shift+8':   { func: 'list.toggle', params: ['unorderedlist'] }},shortcutsAdd: false,activeButtons: ['deleted', 'italic', 'bold'],activeButtonsStates: {b: 'bold',strong: 'bold',i: 'italic',em: 'italic',del: 'deleted',strike: 'deleted'},langs: {en: {"format": "Format","image": "Image","file": "File","link": "Link","bold": "Bold","italic": "Italic","deleted": "Strikethrough","underline": "Underline","bold-abbr": "B","italic-abbr": "I","deleted-abbr": "S","underline-abbr": "U","lists": "Lists","link-insert": "Insert link","link-edit": "Edit link","link-in-new-tab": "Open link in new tab","unlink": "Unlink","cancel": "Cancel","close": "Close","insert": "Insert","save": "Save","delete": "Delete","text": "Text","edit": "Edit","title": "Title","paragraph": "Normal text","quote": "Quote","code": "Code","heading1": "Heading 1","heading2": "Heading 2","heading3": "Heading 3","heading4": "Heading 4","heading5": "Heading 5","heading6": "Heading 6","filename": "Name","optional": "optional","unorderedlist": "Unordered List","orderedlist": "Ordered List","outdent": "Outdent","indent": "Indent","horizontalrule": "Line","upload-label": "Drop file here or ","caption": "Caption","bulletslist": "Bullets","numberslist": "Numbers","image-position": "Position","none": "None","left": "Left","right": "Right","center": "Center","accessibility-help-label": "Rich text editor"}},type: 'textarea', inline: false,buffer: [],rebuffer: [],inlineTags: ['a', 'span', 'strong', 'strike', 'b', 'u', 'em', 'i', 'code', 'del', 'ins', 'samp', 'kbd', 'sup', 'sub', 'mark', 'var', 'cite', 'small'],blockTags: ['pre', 'ul', 'ol', 'li', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6',  'dl', 'dt', 'dd', 'div', 'td', 'blockquote', 'output', 'figcaption', 'figure', 'address', 'section', 'header', 'footer', 'aside', 'article', 'iframe'],paragraphize: true,paragraphizeBlocks: ['table', 'div', 'pre', 'form', 'ul', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dl', 'blockquote', 'figcaption','address', 'section', 'header', 'footer', 'aside', 'article', 'object', 'style', 'script', 'iframe', 'select', 'input', 'textarea','button', 'option', 'map', 'area', 'math', 'hr', 'fieldset', 'legend', 'hgroup', 'nav', 'figure', 'details', 'menu', 'summary', 'p'],emptyHtml: '<p>&#x200b;</p>',invisibleSpace: '&#x200b;',emptyHtmlRendered: $('').html('​').html(),imageTypes: ['image/png', 'image/jpeg', 'image/gif'],userAgent: navigator.userAgent.toLowerCase(),observe: {dropdowns: []},regexps: {linkyoutube: /https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube\.com\S*[^\w\-\s])([\w\-]{11})(?=[^\w\-]|$)(?![?=&+%\w.\-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/ig,linkvimeo: /https?:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/,linkimage: /((https?|www)[^\s]+\.)(jpe?g|png|gif)(\?[^\s-]+)?/ig,url: /(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/ig}};Redactor.fn = $.Redactor.prototype = {keyCode: {BACKSPACE: 8,DELETE: 46,UP: 38,DOWN: 40,ENTER: 13,SPACE: 32,ESC: 27,TAB: 9,CTRL: 17,META: 91,SHIFT: 16,ALT: 18,RIGHT: 39,LEFT: 37,LEFT_WIN: 91},init: function(el, options){this.$element = $(el);this.uuid = uuid++;this.loadOptions(options);this.loadModules();if (this.opts.clickToEdit && !this.$element.hasClass('redactor-click-to-edit')){return this.loadToEdit(options);}else if (this.$element.hasClass('redactor-click-to-edit')){this.$element.removeClass('redactor-click-to-edit');}this.reIsBlock = new RegExp('^(' + this.opts.blockTags.join('|' ).toUpperCase() + ')$', 'i');this.reIsInline = new RegExp('^(' + this.opts.inlineTags.join('|' ).toUpperCase() + ')$', 'i');this.opts.dragImageUpload = (this.opts.imageUpload === null) ? false : this.opts.dragImageUpload;this.opts.dragFileUpload = (this.opts.fileUpload === null) ? false : this.opts.dragFileUpload;this.formatting = {};this.lang.load();$.extend(this.opts.shortcuts, this.opts.shortcutsAdd);this.$editor = this.$element;this.detectType();this.core.callback('start');this.core.callback('startToEdit');this.start = true;this.build.start();},detectType: function(){if (this.build.isInline() || this.opts.inline){this.opts.type = 'inline';}else if (this.build.isTag('DIV')){this.opts.type = 'div';}else if (this.build.isTag('PRE')){this.opts.type = 'pre';}},loadToEdit: function(options){this.$element.on('click.redactor-click-to-edit', $.proxy(function(){this.initToEdit(options);}, this));this.$element.addClass('redactor-click-to-edit');return;},initToEdit: function(options){$.extend(options.callbacks,  {startToEdit: function(){this.insert.node(this.marker.get(), false);},initToEdit: function(){this.selection.restore();this.clickToCancelStorage = this.code.get();$(this.opts.clickToCancel).off('.redactor-click-to-edit');$(this.opts.clickToCancel).show().on('click.redactor-click-to-edit', $.proxy(function(e){e.preventDefault();this.core.destroy();this.events.syncFire = false;this.$element.html(this.clickToCancelStorage);this.core.callback('cancel', this.clickToCancelStorage);this.events.syncFire = true;this.clickToCancelStorage = '';$(this.opts.clickToCancel).hide();$(this.opts.clickToSave).hide();this.$element.on('click.redactor-click-to-edit', $.proxy(function(){this.initToEdit(options);}, this));this.$element.addClass('redactor-click-to-edit');}, this));$(this.opts.clickToSave).off('.redactor-click-to-edit');$(this.opts.clickToSave).show().on('click.redactor-click-to-edit', $.proxy(function(e){e.preventDefault();this.core.destroy();this.core.callback('save', this.code.get());$(this.opts.clickToCancel).hide();$(this.opts.clickToSave).hide();this.$element.on('click.redactor-click-to-edit', $.proxy(function(){this.initToEdit(options);}, this));this.$element.addClass('redactor-click-to-edit');}, this));}});this.$element.redactor(options);this.$element.off('.redactor-click-to-edit');},loadOptions: function(options){var settings = {};if (typeof $.Redactor.settings.namespace !== 'undefined'){ if (this.$element.hasClass($.Redactor.settings.namespace)) { settings = $.Redactor.settings; }}else{settings = $.Redactor.settings;}this.opts = $.extend({},$.Redactor.opts,this.$element.data(),options);this.opts = $.extend(true, this.opts, settings);},getModuleMethods: function(object){return Object.getOwnPropertyNames(object).filter(function(property){return typeof object[property] === 'function';});},loadModules: function(){var len = $.Redactor.modules.length;for (var i = 0; i < len; i++){this.bindModuleMethods($.Redactor.modules[i]);}},bindModuleMethods: function(module){if (typeof this[module] === 'undefined'){return;}this[module] = this[module]();var methods = this.getModuleMethods(this[module]);var len = methods.length;for (var z = 0; z < len; z++){this[module][methods[z]] = this[module][methods[z]].bind(this);}},air: function(){return {enabled: false,collapsed: function(){if (this.opts.air){this.selection.get().collapseToStart();}},collapsedEnd: function(){if (this.opts.air){this.selection.get().collapseToEnd();}},build: function(){if (this.detect.isMobile()){return;}this.button.hideButtons();this.button.hideButtonsOnMobile();if (this.opts.buttons.length === 0){return;}this.$air = this.air.createContainer();if (this.opts.airWidth !== false){this.$air.css('width', this.opts.airWidth);}this.air.append();this.button.$toolbar = this.$air;this.button.setFormatting();this.button.load(this.$air);this.core.editor().on('mouseup.redactor', this, $.proxy(function(e){if (this.selection.text() !== ''){this.air.show(e);}}, this));},append: function(){this.$air.appendTo('body');},createContainer: function(){return $('<ul>').addClass('redactor-air').attr({ 'id': 'redactor-air-' + this.uuid, 'role': 'toolbar' }).hide();},show: function (e){this.selection.saveInstant();$('.redactor-air').hide();var leftFix = 0;var width = this.$air.innerWidth();if ($(window).width() < (e.clientX + width)){leftFix = 200;}this.$air.css({left: (e.clientX - leftFix) + 'px',top: (e.clientY + 10 + $(document).scrollTop()) + 'px'}).show();this.air.enabled = true;this.air.bindHide();},bindHide: function(){$(document).on('mousedown.redactor-air.' + this.uuid, $.proxy(function(e){var dropdown = $(e.target).closest('.redactor-dropdown').length;if ($(e.target).closest(this.$air).length === 0 && dropdown === 0){var hide = this.air.hide(e);if (hide !== false){this.marker.remove();}}}, this)).on('keydown.redactor-air.' + this.uuid, $.proxy(function(e){var key = e.which;if ((!this.utils.isRedactorParent(e.target) && !$(e.target).hasClass('redactor-in')) || $(e.target).closest('#redactor-modal').length !== 0){return;}if (key === this.keyCode.ESC){this.selection.get().collapseToStart();}else if (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE){var sel = this.selection.get();var range = this.selection.range(sel);range.deleteContents();}else if (key === this.keyCode.ENTER){this.selection.get().collapseToEnd();}if (this.air.enabled){this.air.hide(e);}else{this.selection.get().collapseToStart();}}, this));},hide: function(e){var ctrl = e.ctrlKey || e.metaKey || (e.shiftKey && e.altKey);if (ctrl){return false;}this.button.setInactiveAll();this.$air.fadeOut(100);this.air.enabled = false;$(document).off('mousedown.redactor-air.' + this.uuid);$(document).off('keydown.redactor-air.' + this.uuid);}};},autosave: function(){return {enabled: false,html: false,init: function(){if (!this.opts.autosave){return;}this.autosave.enabled = true;this.autosave.name = (this.opts.autosaveName) ? this.opts.autosaveName : this.$textarea.attr('name');},is: function(){return this.autosave.enabled;},send: function(){if (!this.opts.autosave){return;}this.autosave.source = this.code.get();if (this.autosave.html === this.autosave.source){return;}var data = {};data.name = this.autosave.name;data[this.autosave.name] = this.autosave.source;data = this.autosave.getHiddenFields(data);var jsxhr = $.ajax({url: this.opts.autosave,type: 'post',data: data});jsxhr.done(this.autosave.success);},getHiddenFields: function(data){if (this.opts.autosaveFields === false || typeof this.opts.autosaveFields !== 'object'){return data;}$.each(this.opts.autosaveFields, $.proxy(function(k, v){if (v !== null && v.toString().indexOf('#') === 0){v = $(v).val();}data[k] = v;}, this));return data;},success: function(data){var json;try{json = JSON.parse(data);}catch(e){json = data;}var callbackName = (typeof json.error === 'undefined') ? 'autosave' :  'autosaveError';this.core.callback(callbackName, this.autosave.name, json);this.autosave.html = this.autosave.source;},disable: function(){this.autosave.enabled = false;clearInterval(this.autosaveTimeout);}};},block: function(){return {format: function(tag, attr, value, type){tag = (tag === 'quote') ? 'blockquote' : tag;this.block.tags = ['p', 'blockquote', 'pre', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'div', 'figure'];if ($.inArray(tag, this.block.tags) === -1){return;}if (tag === 'p' && typeof attr === 'undefined'){attr = 'class';}this.placeholder.hide();this.buffer.set();return (this.utils.isCollapsed()) ? this.block.formatCollapsed(tag, attr, value, type) : this.block.formatUncollapsed(tag, attr, value, type);},formatCollapsed: function(tag, attr, value, type){this.selection.save();var block = this.selection.block();var currentTag = block.tagName.toLowerCase();if ($.inArray(currentTag, this.block.tags) === -1){this.selection.restore();return;}if (currentTag === tag){tag = 'p';}var replaced;if (currentTag === 'blockquote' && this.utils.isEndOfElement(block)){this.marker.remove();replaced = document.createElement('p');replaced.innerHTML = this.opts.invisibleSpace;$(block).after(replaced);this.caret.start(replaced);var $last = $(block).children().last();if ($last.length !== 0 && $last[0].tagName === 'BR'){$last.remove();}}else{replaced = this.utils.replaceToTag(block, tag);}if (typeof attr === 'object'){type = value;for (var key in attr){replaced = this.block.setAttr(replaced, key, attr[key], type);}}else{replaced = this.block.setAttr(replaced, attr, value, type);}if (tag === 'pre' && replaced.length === 1){$(replaced).html($.trim($(replaced).html()));}this.selection.restore();this.block.removeInlineTags(replaced);return replaced;},formatUncollapsed: function(tag, attr, value, type){this.selection.save();var replaced = [];var blocks = this.selection.blocks();if (blocks[0] && $(blocks[0]).hasClass('redactor-in')){blocks = $(blocks[0]).find(this.opts.blockTags.join(', '));}var len = blocks.length;for (var i = 0; i < len; i++){var currentTag = blocks[i].tagName.toLowerCase();if ($.inArray(currentTag, this.block.tags) !== -1 && currentTag !== 'figure'){var block = this.utils.replaceToTag(blocks[i], tag);if (typeof attr === 'object'){type = value;for (var key in attr){block = this.block.setAttr(block, key, attr[key], type);}}else{block = this.block.setAttr(block, attr, value, type);}replaced.push(block);this.block.removeInlineTags(block);}}this.selection.restore();if (tag === 'pre' && replaced.length !== 0){var first = replaced[0];$.each(replaced, function(i,s){if (i !== 0){$(first).append("\n" + $.trim(s.html()));$(s).remove();}});replaced = [];replaced.push(first);}return replaced;},removeInlineTags: function(node){node = node[0] || node;var tags = this.opts.inlineTags;var blocks = ['PRE', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6'];if ($.inArray(node.tagName, blocks) === - 1){return;}if (node.tagName !== 'PRE'){var index = tags.indexOf('a');tags.splice(index, 1);}$(node).find(tags.join(',')).not('.redactor-selection-marker').contents().unwrap();},setAttr: function(block, attr, value, type){if (typeof attr === 'undefined'){return block;}var func = (typeof type === 'undefined') ? 'replace' : type;if (attr === 'class'){block = this.block[func + 'Class'](value, block);}else{if (func === 'remove'){block = this.block[func + 'Attr'](attr, block);}else if (func === 'removeAll'){block = this.block[func + 'Attr'](attr, block);}else{block = this.block[func + 'Attr'](attr, value, block);}}return block;},getBlocks: function(block){return (typeof block === 'undefined') ? this.selection.blocks() : block;},replaceClass: function(value, block){return $(this.block.getBlocks(block)).removeAttr('class').addClass(value)[0];},toggleClass: function(value, block){return $(this.block.getBlocks(block)).toggleClass(value)[0];},addClass: function(value, block){return $(this.block.getBlocks(block)).addClass(value)[0];},removeClass: function(value, block){return $(this.block.getBlocks(block)).removeClass(value)[0];},removeAllClass: function(block){return $(this.block.getBlocks(block)).removeAttr('class')[0];},replaceAttr: function(attr, value, block){block = this.block.removeAttr(attr, block);return $(block).attr(attr, value)[0];},toggleAttr: function(attr, value, block){block = this.block.getBlocks(block);var self = this;var returned = [];$.each(block, function(i,s){var $el = $(s);if ($el.attr(attr)){returned.push(self.block.removeAttr(attr, s));}else{returned.push(self.block.addAttr(attr, value, s));}});return returned;},addAttr: function(attr, value, block){return $(this.block.getBlocks(block)).attr(attr, value)[0];},removeAttr: function(attr, block){return $(this.block.getBlocks(block)).removeAttr(attr)[0];},removeAllAttr: function(block){block = this.block.getBlocks(block);var returned = [];$.each(block, function(i,s){if (typeof s.attributes === 'undefined'){returned.push(s);}var $el = $(s);var len = s.attributes.length;for (var z = 0; z < len; z++){$el.removeAttr(s.attributes[z].name);}returned.push($el[0]);});return returned;}};},buffer: function(){return {set: function(type){if (typeof type === 'undefined'){this.buffer.clear();}if (typeof type === 'undefined' || type === 'undo'){this.buffer.setUndo();}else{this.buffer.setRedo();}},setUndo: function(){var saved = this.selection.saveInstant();var last = this.opts.buffer[this.opts.buffer.length-1];var current = this.core.editor().html();var save = (typeof last !== 'undefined' && (last[0] === current)) ? false : true;if (save){this.opts.buffer.push([current, saved]);}},setRedo: function(){var saved = this.selection.saveInstant();this.opts.rebuffer.push([this.core.editor().html(), saved]);},add: function(){this.opts.buffer.push([this.core.editor().html(), 0]);},undo: function(){if (this.opts.buffer.length === 0){return;}var buffer = this.opts.buffer.pop();this.buffer.set('redo');this.core.editor().html(buffer[0]);this.selection.restoreInstant(buffer[1]);this.observe.load();},redo: function(){if (this.opts.rebuffer.length === 0){return;}var buffer = this.opts.rebuffer.pop();this.buffer.set('undo');this.core.editor().html(buffer[0]);this.selection.restoreInstant(buffer[1]);this.observe.load();},clear: function(){this.opts.rebuffer = [];}};},build: function(){return {start: function(){if (this.opts.type === 'inline'){this.opts.type = 'inline';}else if (this.opts.type === 'div'){var html = $.trim(this.$editor.html());if (html === ''){this.$editor.html(this.opts.emptyHtml);}}else if (this.opts.type === 'textarea'){this.build.startTextarea();}this.build.setIn();this.build.setId();this.build.enableEditor();this.build.setOptions();this.build.callEditor();},createContainerBox: function(){this.$box = $('<div class="redactor-box" role="application" />');},setIn: function(){this.core.editor().addClass('redactor-in');},setId: function(){var id = (this.opts.type === 'textarea') ? 'redactor-uuid-' + this.uuid : this.$element.attr('id');this.core.editor().attr('id', (typeof id === 'undefined') ? 'redactor-uuid-' + this.uuid : id);},getName: function(){var name = this.$element.attr('name');return (typeof name === 'undefined') ? 'content-' + this.uuid : name;},loadFromTextarea: function(){this.$editor = $('<div />');this.$textarea = this.$element;this.$element.attr('name', this.build.getName());this.$box.insertAfter(this.$element).append(this.$editor).append(this.$element);this.$editor.addClass('redactor-layer');if (this.opts.overrideStyles){this.$editor.addClass('redactor-styles');}this.$element.hide();this.$box.prepend('<span class="redactor-voice-label" id="redactor-voice-' + this.uuid +'" aria-hidden="false">' + this.lang.get('accessibility-help-label') + '</span>');this.$editor.attr({ 'aria-labelledby': 'redactor-voice-' + this.uuid, 'role': 'presentation' });},startTextarea: function(){this.build.createContainerBox();this.build.loadFromTextarea();this.code.start(this.core.textarea().val());this.core.textarea().val(this.clean.onSync(this.$editor.html()));},isTag: function(tag){return (this.$element[0].tagName === tag);},isInline: function(){return (!this.build.isTag('TEXTAREA') && !this.build.isTag('DIV') && !this.build.isTag('PRE'));},enableEditor: function(){this.core.editor().attr({ 'contenteditable': true });},setOptions: function(){if (this.opts.type === 'inline'){this.opts.enterKey = false;}if (this.opts.type === 'inline' || this.opts.type === 'pre'){this.opts.toolbarMobile = false;this.opts.toolbar = false;this.opts.air = false;this.opts.linkify = false;}this.core.editor().attr('spellcheck', this.opts.spellcheck);if (this.opts.structure){this.core.editor().addClass('redactor-structure');}if (this.opts.type !== 'textarea'){return;}this.core.box().attr('dir', this.opts.direction);this.core.editor().attr('dir', this.opts.direction);if (this.opts.tabindex){this.core.editor().attr('tabindex', this.opts.tabindex);}if (this.opts.minHeight){this.core.editor().css('min-height', this.opts.minHeight);}else{this.core.editor().css('min-height', '40px');}if (this.opts.maxHeight){this.core.editor().css('max-height', this.opts.maxHeight);}if (this.opts.maxWidth){this.core.editor().css({ 'max-width': this.opts.maxWidth, 'margin': 'auto' });}},callEditor: function(){this.build.disableBrowsersEditing();this.events.init();this.build.setHelpers();if (this.opts.toolbar || this.opts.air){this.toolbarsButtons = this.button.init();}if (this.opts.air){this.air.build();}else if (this.opts.toolbar){this.toolbar.build();}if (this.detect.isMobile() && this.opts.toolbarMobile && this.opts.air){this.opts.toolbar = true;this.toolbar.build();}if (this.opts.air || this.opts.toolbar){this.core.editor().on('mouseup.redactor-observe.' + this.uuid + ' keyup.redactor-observe.' + this.uuid + ' focus.redactor-observe.' + this.uuid + ' touchstart.redactor-observe.' + this.uuid, $.proxy(this.observe.toolbar, this));this.core.element().on('blur.callback.redactor', $.proxy(function(){this.button.setInactiveAll();}, this));}this.modal.templates();this.build.plugins();this.autosave.init();this.code.html = this.code.cleaned(this.core.editor().html());this.core.callback('init');this.core.callback('initToEdit');this.storage.observe();this.start = false;},setHelpers: function(){if (this.opts.linkify){this.linkify.format();}this.placeholder.init();if (this.opts.focus){setTimeout(this.focus.start, 100);}else if (this.opts.focusEnd){setTimeout(this.focus.end, 100);}},disableBrowsersEditing: function(){try {document.execCommand('enableObjectResizing', false, false);document.execCommand('enableInlineTableEditing', false, false);document.execCommand("AutoUrlDetect", false, false);} catch (e) {}},plugins: function(){if (!this.opts.plugins){return;}$.each(this.opts.plugins, $.proxy(function(i, s){var func = (typeof RedactorPlugins !== 'undefined' && typeof RedactorPlugins[s] !== 'undefined') ? RedactorPlugins : Redactor.fn;if (!$.isFunction(func[s])){return;}this[s] = func[s]();var methods = this.getModuleMethods(this[s]);var len = methods.length;for (var z = 0; z < len; z++){this[s][methods[z]] = this[s][methods[z]].bind(this);}if (typeof this[s].langs !== 'undefined'){var lang = {};if (typeof this[s].langs[this.opts.lang] !== 'undefined'){lang = this[s].langs[this.opts.lang];}else if (typeof this[s].langs[this.opts.lang] === 'undefined' && typeof this[s].langs.en !== 'undefined'){lang = this[s].langs.en;}var self = this;$.each(lang, function(i,s){if (typeof self.opts.curLang[i] === 'undefined'){self.opts.curLang[i] = s;}});}if ($.isFunction(this[s].init)){this[s].init();}}, this));}};},button: function(){return {toolbar: function(){return (typeof this.button.$toolbar === 'undefined' || !this.button.$toolbar) ? this.$toolbar : this.button.$toolbar;},init: function(){return {format:{title: this.lang.get('format'),icon: true,dropdown:{p:{title: this.lang.get('paragraph'),func: 'block.format'},blockquote:{title: this.lang.get('quote'),func: 'block.format'},pre:{title: this.lang.get('code'),func: 'block.format'},h1:{title: this.lang.get('heading1'),func: 'block.format'},h2:{title: this.lang.get('heading2'),func: 'block.format'},h3:{title: this.lang.get('heading3'),func: 'block.format'},h4:{title: this.lang.get('heading4'),func: 'block.format'},h5:{title: this.lang.get('heading5'),func: 'block.format'},h6:{title: this.lang.get('heading6'),func: 'block.format'}}},bold:{title: this.lang.get('bold-abbr'),icon: true,label: this.lang.get('bold'),func: 'inline.format'},italic:{title: this.lang.get('italic-abbr'),icon: true,label: this.lang.get('italic'),func: 'inline.format'},deleted:{title: this.lang.get('deleted-abbr'),icon: true,label: this.lang.get('deleted'),func: 'inline.format'},underline:{title: this.lang.get('underline-abbr'),icon: true,label: this.lang.get('underline'),func: 'inline.format'},lists:{title: this.lang.get('lists'),icon: true,dropdown:{unorderedlist:{title: '&bull; ' + this.lang.get('unorderedlist'),func: 'list.toggle'},orderedlist:{title: '1. ' + this.lang.get('orderedlist'),func: 'list.toggle'},outdent:{title: '< ' + this.lang.get('outdent'),func: 'indent.decrease',observe: {element: 'li',out: {attr: {'class': 'redactor-dropdown-link-inactive','aria-disabled': true}}}},indent:{title: '> ' + this.lang.get('indent'),func: 'indent.increase',observe: {element: 'li',out: {attr: {'class': 'redactor-dropdown-link-inactive','aria-disabled': true}}}}}},ul:{title: '&bull; ' + this.lang.get('bulletslist'),icon: true,func: 'list.toggle'},ol:{title: '1. ' + this.lang.get('numberslist'),icon: true,func: 'list.toggle'},outdent:{title: this.lang.get('outdent'),icon: true,func: 'indent.decrease'},indent:{title: this.lang.get('indent'),icon: true,func: 'indent.increase'},image:{title: this.lang.get('image'),icon: true,func: 'image.show'},file:{title: this.lang.get('file'),icon: true,func: 'file.show'},link:{title: this.lang.get('link'),icon: true,dropdown:{link:{title: this.lang.get('link-insert'),func: 'link.show',observe: {element: 'a','in': {title: this.lang.get('link-edit'),},out: {title: this.lang.get('link-insert')}}},unlink:{title: this.lang.get('unlink'),func: 'link.unlink',observe: {element: 'a',out: {attr: {'class': 'redactor-dropdown-link-inactive','aria-disabled': true}}}}}},horizontalrule:{title: this.lang.get('horizontalrule'),icon: true,func: 'line.insert'}};},setFormatting: function(){$.each(this.toolbarsButtons.format.dropdown, $.proxy(function (i, s){if ($.inArray(i, this.opts.formatting) === -1){delete this.toolbarsButtons.format.dropdown[i];}}, this));},hideButtons: function(){if (this.opts.buttonsHide.length !== 0){this.button.hideButtonsSlicer(this.opts.buttonsHide);}},hideButtonsOnMobile: function(){if (this.detect.isMobile() && this.opts.buttonsHideOnMobile.length !== 0){this.button.hideButtonsSlicer(this.opts.buttonsHideOnMobile);}},hideButtonsSlicer: function(buttons){$.each(buttons, $.proxy(function(i, s){var index = this.opts.buttons.indexOf(s);if (index !== -1){this.opts.buttons.splice(index, 1);}}, this));},load: function($toolbar){this.button.buttons = [];$.each(this.opts.buttons, $.proxy(function(i, btnName){if (!this.toolbarsButtons[btnName]|| (btnName === 'file' && !this.file.is())|| (btnName === 'image' && !this.image.is())){return;}$toolbar.append($('<li>').append(this.button.build(btnName, this.toolbarsButtons[btnName])));}, this));},buildButtonTooltip: function($btn, title){if (this.opts.air || this.detect.isMobile()){return;}var $tooltip = $('<span>');$tooltip.addClass('re-button-tooltip');$tooltip.html(title);$btn.append($tooltip);$btn.on('mouseover', function(){if ($(this).hasClass('redactor-button-disabled')){return;}$tooltip.show();$tooltip.css('margin-left', -($tooltip.innerWidth()/2));}).on('mouseout', function(){$tooltip.hide();});},build: function(btnName, btnObject){if (this.opts.toolbar === false){return;}var title = (typeof btnObject.label !== 'undefined') ? btnObject.label : btnObject.title;var $button = $('<a href="javascript:void(null);" alt="' + title + '" rel="' + btnName + '" />');$button.addClass('re-button re-' + btnName);$button.attr({ 'role': 'button', 'aria-label': title, 'tabindex': '-1' });if (typeof btnObject.icon !== 'undefined'){var $icon = $('<i>');$icon.addClass('re-icon-' + btnName);$button.append($icon);$button.addClass('re-button-icon');this.button.buildButtonTooltip($button, title);}else{$button.html(btnObject.title);}if (btnObject.func || btnObject.command || btnObject.dropdown){this.button.setEvent($button, btnName, btnObject);}if (btnObject.dropdown){$button.addClass('redactor-toolbar-link-dropdown').attr('aria-haspopup', true);var $dropdown = $('<ul class="redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + btnName + '" style="display: none;">');$button.data('dropdown', $dropdown);this.dropdown.build(btnName, $dropdown, btnObject.dropdown);}this.button.buttons.push($button);return $button;},getButtons: function(){return this.button.toolbar().find('a.re-button');},getButtonsKeys: function(){return this.button.buttons;},setEvent: function($button, btnName, btnObject){$button.on('mousedown', $.proxy(function(e){e.preventDefault();if ($button.hasClass('redactor-button-disabled')){return false;}var type = 'func';var callback = btnObject.func;if (btnObject.command){type = 'command';callback = btnObject.command;}else if (btnObject.dropdown){type = 'dropdown';callback = false;}this.button.toggle(e, btnName, type, callback);return false;}, this));},toggle: function(e, btnName, type, callback, args){if (this.detect.isIe() || !this.detect.isDesktop()){this.utils.freezeScroll();e.returnValue = false;}if (type === 'command'){this.inline.format(callback);}else if (type === 'dropdown'){this.dropdown.show(e, btnName);}else{this.button.clickCallback(e, callback, btnName, args);}if (type !== 'dropdown'){this.dropdown.hideAll(false);}if (this.opts.air && type !== 'dropdown'){this.air.hide(e);}if (this.detect.isIe() || !this.detect.isDesktop()){this.utils.unfreezeScroll();}},clickCallback: function(e, callback, btnName, args){var func;args = (typeof args === 'undefined') ? btnName : args;if ($.isFunction(callback)){callback.call(this, btnName);}else if (callback.search(/\./) !== '-1'){func = callback.split('.');if (typeof this[func[0]] === 'undefined'){return;}if (typeof args === 'object'){this[func[0]][func[1]].apply(this, args);}else{this[func[0]][func[1]].call(this, args);}}else{if (typeof args === 'object'){this[callback].apply(this, args);}else{this[callback].call(this, args);}}this.observe.buttons(e, btnName);},all: function(){return this.button.buttons;},get: function(key){if (this.opts.toolbar === false){return;}return this.button.toolbar().find('a.re-' + key);},set: function(key, title){if (this.opts.toolbar === false){return;}var $btn = this.button.toolbar().find('a.re-' + key);$btn.html(title).attr('aria-label', title);return $btn;},add: function(key, title){if (this.button.isAdded(key) !== true){return $();}var btn = this.button.build(key, { title: title });this.button.toolbar().append($('<li>').append(btn));return btn;},addFirst: function(key, title){if (this.button.isAdded(key) !== true){return $();}var btn = this.button.build(key, { title: title });this.button.toolbar().prepend($('<li>').append(btn));return btn;},addAfter: function(afterkey, key, title){if (this.button.isAdded(key) !== true){return $();}var btn = this.button.build(key, { title: title });var $btn = this.button.get(afterkey);if ($btn.length !== 0){$btn.parent().after($('<li>').append(btn));}else{this.button.toolbar().append($('<li>').append(btn));}return btn;},addBefore: function(beforekey, key, title){if (this.button.isAdded(key) !== true){return $();}var btn = this.button.build(key, { title: title });var $btn = this.button.get(beforekey);if ($btn.length !== 0){$btn.parent().before($('<li>').append(btn));}else{this.button.toolbar().append($('<li>').append(btn));}return btn;},isAdded: function(key){var index = this.opts.buttonsHideOnMobile.indexOf(key);if (this.opts.toolbar === false || (index !== -1 && this.detect.isMobile())){return false;}return true;},setIcon: function($btn, icon){$btn.html(icon).addClass('re-button-icon');this.button.buildButtonTooltip($btn, $btn.attr('alt'));},changeIcon: function(key, newIconClass){var $btn = this.button.get(key);if ($btn.length !== 0){$btn.find('i').removeAttr('class').addClass('re-icon-' + newIconClass);}},addCallback: function($btn, callback){if (typeof $btn === 'undefined' || this.opts.toolbar === false){return;}var type = (callback === 'dropdown') ? 'dropdown' : 'func';var key = $btn.attr('rel');$btn.on('mousedown', $.proxy(function(e){if ($btn.hasClass('redactor-button-disabled')){return false;}this.button.toggle(e, key, type, callback);}, this));},addDropdown: function($btn, dropdown){if (this.opts.toolbar === false){return;}$btn.addClass('redactor-toolbar-link-dropdown').attr('aria-haspopup', true);var key = $btn.attr('rel');this.button.addCallback($btn, 'dropdown');var $dropdown = $('<div class="redactor-dropdown redactor-dropdown-' + this.uuid + ' redactor-dropdown-box-' + key + '" style="display: none;">');$btn.data('dropdown', $dropdown);if (dropdown){this.dropdown.build(key, $dropdown, dropdown);}return $dropdown;},setActive: function(key){this.button.get(key).addClass('redactor-act');},setInactive: function(key){this.button.get(key).removeClass('redactor-act');},setInactiveAll: function(key){var $btns = this.button.toolbar().find('a.re-button');if (typeof key !== 'undefined'){$btns = $btns.not('.re-' + key);}$btns.removeClass('redactor-act');},disable: function(key){this.button.get(key).addClass('redactor-button-disabled');},enable: function(key){this.button.get(key).removeClass('redactor-button-disabled');},disableAll: function(key){var $btns = this.button.toolbar().find('a.re-button');if (typeof key !== 'undefined'){$btns = $btns.not('.re-' + key);}$btns.addClass('redactor-button-disabled');},enableAll: function(){this.button.toolbar().find('a.re-button').removeClass('redactor-button-disabled');},remove: function(key){this.button.get(key).remove();}};},caret: function(){return {set: function(node1, node2, end){this.core.editor().focus();end = (typeof end === 'undefined') ? 0 : 1;node1 = node1[0] || node1;node2 = node2[0] || node2;var sel = this.selection.get();var range = this.selection.range(sel);try{range.setStart(node1, 0);range.setEnd(node2, end);}catch (e) {}this.selection.update(sel, range);},prepare: function(node){if (this.detect.isFirefox() && typeof this.start !== 'undefined'){this.core.editor().focus();}return node[0] || node;},start: function(node){var sel, range;node = this.caret.prepare(node);if (!node){return;}if (node.tagName === 'BR'){return this.caret.before(node);}var $first = $(node).children().first();var inline = this.utils.isInlineTag(node.tagName);if (node.innerHTML === '' || inline){this.caret.setStartEmptyOrInline(node, inline);}else if ($first && $first.length !== 0 && this.utils.isInlineTag($first[0].tagName) && $first.text() === ''){   this.caret.setStartEmptyOrInline($first[0], true);}else{sel = window.getSelection();sel.removeAllRanges();range = document.createRange();range.selectNodeContents(node);range.collapse(true);sel.addRange(range);}},setStartEmptyOrInline: function(node, inline){var sel = window.getSelection();var range = document.createRange();var textNode = document.createTextNode('\u200B');range.setStart(node, 0);range.insertNode(textNode);range.setStartAfter(textNode);range.collapse(true);sel.removeAllRanges();sel.addRange(range);if (!inline){this.core.editor().on('keydown.redactor-remove-textnode', function(){$(textNode).remove();$(this).off('keydown.redactor-remove-textnode');});}},end: function(node){var sel, range;node = this.caret.prepare(node);if (!node){return;}if (node.tagName !== 'BR' && node.innerHTML === ''){return this.caret.start(node);}if (node.tagName === 'BR'){var space = document.createElement('span');space.className = 'redactor-invisible-space';space.innerHTML = '&#x200b;';$(node).after(space);sel = window.getSelection();sel.removeAllRanges();range = document.createRange();range.setStartBefore(space);range.setEndBefore(space);sel.addRange(range);$(space).replaceWith(function(){return $(this).contents();});return;}if (node.lastChild && node.lastChild.nodeType === 1){return this.caret.after(node.lastChild);}sel = window.getSelection();sel.removeAllRanges();range = document.createRange();range.selectNodeContents(node);range.collapse(false);sel.addRange(range);},after: function(node){var sel, range;node = this.caret.prepare(node);if (!node){return;}if (node.tagName === 'BR'){return this.caret.end(node);}if (this.utils.isBlockTag(node.tagName)){var next = this.caret.next(node);if (typeof next === 'undefined'){this.caret.end(node);}else{if (next.tagName === 'TABLE'){next = $(next).find('th, td').first()[0];}else if (next.tagName === 'UL' || next.tagName === 'OL'){next = $(next).find('li').first()[0];}this.caret.start(next);}return;}var textNode = document.createTextNode('\u200B');sel = window.getSelection();sel.removeAllRanges();range = document.createRange();range.setStartAfter(node);range.insertNode(textNode);range.setStartAfter(textNode);range.collapse(true);sel.addRange(range);},before: function(node){var sel, range;node = this.caret.prepare(node);if (!node){return;}if (this.utils.isBlockTag(node.tagName)){var prev = this.caret.prev(node);if (typeof prev === 'undefined'){this.caret.start(node);}else{if (prev.tagName === 'TABLE'){prev = $(prev).find('th, td').last()[0];}else if (prev.tagName === 'UL' || prev.tagName === 'OL'){prev = $(prev).find('li').last()[0];}this.caret.end(prev);}return;}sel = window.getSelection();sel.removeAllRanges();range = document.createRange();range.setStartBefore(node);range.collapse(true);sel.addRange(range);},next: function(node){var $next = $(node).next();if ($next.hasClass('redactor-script-tag, redactor-selection-marker')){return $next.next()[0];}else{return $next[0];}},prev: function(node){var $prev = $(node).prev();if ($prev.hasClass('redactor-script-tag, redactor-selection-marker')){return $prev.prev()[0];}else{return $prev[0];}},offset: function(node){return this.offset.get(node);}};},clean: function(){return {onSet: function(html){html = this.clean.savePreCode(html);html = this.clean.saveFormTags(html);if (this.opts.script){html = html.replace(/<script(.*?[^>]?)>([\w\W]*?)<\/script>/gi, '<pre class="redactor-script-tag" $1>$2</pre>');}html = html.replace(/\$/g, '&#36;');html = html.replace(/&amp;/g, '&');html = html.replace(/<a href="(.*?[^>]?)®(.*?[^>]?)">/gi, '<a href="$1&reg$2">');html = html.replace(/<span id="selection-marker-1"(.*?[^>]?)>​<\/span>/gi, '###marker1###');html = html.replace(/<span id="selection-marker-2"(.*?[^>]?)>​<\/span>/gi, '###marker2###');var self = this;var $div = $("<div/>").html($.parseHTML(html, document, true));var replacement = this.opts.replaceTags;if (replacement){var keys = Object.keys(this.opts.replaceTags);$div.find(keys.join(',')).each(function(i,s){self.utils.replaceToTag(s, replacement[s.tagName.toLowerCase()]);});}$div.find('span, a').attr('data-redactor-span', true).each(function(){var $el = $(this);if ($el.attr('style')){$el.attr('data-redactor-style-cache', $el.attr('style'));}});html = $div.html();var tags = ['font', 'html', 'head', 'link', 'body', 'meta', 'applet'];if (!this.opts.script){tags.push('script');}html = this.clean.stripTags(html, tags);if (this.opts.removeComments){html = html.replace(/<!--[\s\S]*?-->/gi, '');}html = this.paragraphize.load(html);html = html.replace('###marker1###', '<span id="selection-marker-1" class="redactor-selection-marker">​</span>');html = html.replace('###marker2###', '<span id="selection-marker-2" class="redactor-selection-marker">​</span>');if (html.search(/^(||\s||<br\s?\/?>||&nbsp;)$/i) !== -1){return this.opts.emptyHtml;}return html;},onGet: function(html){return this.clean.onSync(html);},onSync: function(html){html = html.replace(/\u200B/g, '');html = html.replace(/&#x200b;/gi, '');if (html.search(/^<p>(||\s||<br\s?\/?>||&nbsp;)<\/p>$/i) !== -1){return '';}html = html.replace(/<span(.*?)id="redactor-image-box"(.*?[^>])>([\w\W]*?)<img(.*?)><\/span>/gi, '$3<img$4>');html = html.replace(/<span(.*?)id="redactor-image-resizer"(.*?[^>])>(.*?)<\/span>/gi, '');html = html.replace(/<span(.*?)id="redactor-image-editter"(.*?[^>])>(.*?)<\/span>/gi, '');html = html.replace(/<img(.*?)style="(.*?)opacity: 0\.5;(.*?)"(.*?)>/gi, '<img$1style="$2$3"$4>');var $div = $("<div/>").html($.parseHTML(html, document, true));$div.find('*[style=""]').removeAttr('style');$div.find('*[class=""]').removeAttr('class');$div.find('*[rel=""]').removeAttr('rel');$div.find('.redactor-invisible-space, .redactor-unlink').each(function(){$(this).contents().unwrap();});$div.find('span, a').removeAttr('data-redactor-span data-redactor-style-cache').each(function(){if (this.attributes.length === 0){$(this).contents().unwrap();}});$div.find('img').removeAttr('rel');$div.find('.redactor-selection-marker, #redactor-insert-marker').remove();html = $div.html();if (this.opts.script){html = html.replace(/<pre class="redactor-script-tag"(.*?[^>]?)>([\w\W]*?)<\/pre>/gi, '<script$1>$2</script>');}html = this.clean.restoreFormTags(html);html = html.replace(new RegExp('<br\\s?/?></h', 'gi'), '</h');html = html.replace(new RegExp('<br\\s?/?></li>', 'gi'), '</li>');html = html.replace(new RegExp('</li><br\\s?/?>', 'gi'), '</li>');html = html.replace(/<pre>/gi, "<pre>\n");if (this.opts.preClass){html = html.replace(/<pre>/gi, '<pre class="' + this.opts.preClass + '">');}if (this.opts.linkNofollow){html = html.replace(/<a(.*?)rel="nofollow"(.*?[^>])>/gi, '<a$1$2>');html = html.replace(/<a(.*?[^>])>/gi, '<a$1 rel="nofollow">');}var chars = {'\u2122': '&trade;','\u00a9': '&copy;','\u2026': '&hellip;','\u2014': '&mdash;','\u2010': '&dash;'};$.each(chars, function(i,s){html = html.replace(new RegExp(i, 'g'), s);});html = html.replace(/&amp;/g, '&');html = html.replace(/<p><\/p>/gi, "");html = html.replace(/\n{2,}/g, "\n");if (this.opts.removeNewlines){html = html.replace(/\r?\n/g, "");}return html;},onPaste: function(html, data, insert){if (insert !== true){html = html.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi, "$2");html = html.replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi, "$3");html = html.replace(/<span[^>]*(font-style: italic; font-weight: bold|font-weight: bold; font-style: italic)[^>]*>([\w\W]*?)<\/span>/gi, '<b><i>$2</i></b>');html = html.replace(/<span[^>]*(font-style: italic; font-weight: 700|font-weight: 700; font-style: italic)[^>]*>([\w\W]*?)<\/span>/gi, '<b><i>$2</i></b>');html = html.replace(/<span[^>]*font-style: italic[^>]*>([\w\W]*?)<\/span>/gi, '<i>$1</i>');html = html.replace(/<span[^>]*font-weight: bold[^>]*>([\w\W]*?)<\/span>/gi, '<b>$1</b>');html = html.replace(/<span[^>]*font-weight: 700[^>]*>([\w\W]*?)<\/span>/gi, '<b>$1</b>');var msword = this.clean.isHtmlMsWord(html);if (msword){html = this.clean.cleanMsWord(html);}}html = $.trim(html);if (data.pre){if (this.opts.preSpaces){html = html.replace(/\t/g, new Array(this.opts.preSpaces + 1).join(' '));}}else{html = this.clean.replaceBrToNl(html);html = this.clean.removeTagsInsidePre(html);}if (insert !== true){html = this.clean.removeEmptyInlineTags(html);if (data.encode === false){html = html.replace(/&/g, '&amp;');html = this.clean.convertTags(html, data);html = this.clean.getPlainText(html);html = this.clean.reconvertTags(html, data);}}if (data.text){html = this.clean.replaceNbspToSpaces(html);html = this.clean.getPlainText(html);}if (data.lists){html = html.replace("\n", '<br>');}if (data.encode){html = this.clean.encodeHtml(html);}if (data.paragraphize){html = this.paragraphize.load(html);}return html;},getCurrentType: function(html, insert){var blocks = this.selection.blocks();var data = {text: false,encode: false,paragraphize: true,line: this.clean.isHtmlLine(html),blocks: this.clean.isHtmlBlocked(html),pre: false,lists: false,block: true,inline: true,links: true,images: true};if (blocks.length === 1 && this.utils.isCurrentOrParent(['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'a', 'figcaption'])){data.text = true;data.paragraphize = false;data.inline = false;data.images = false;data.links = false;data.line = true;}else if (this.opts.type === 'inline' || this.opts.enterKey === false){data.paragraphize = false;data.block = false;data.line = true;}else if (blocks.length === 1 && this.utils.isCurrentOrParent(['li'])){data.lists = true;data.block = false;data.paragraphize = false;data.images = false;}else if (blocks.length === 1 && this.utils.isCurrentOrParent(['th', 'td', 'blockquote'])){data.block = false;data.paragraphize = false;}else if (this.opts.type === 'pre' || (blocks.length === 1 && this.utils.isCurrentOrParent('pre'))){data.inline = false;data.block = false;data.encode = true;data.pre = true;data.paragraphize = false;data.images = false;data.links = false;}if (data.line === true){data.paragraphize = false;}if (insert === true){data.text = false;}return data;},isHtmlBlocked: function(html){var match1 = html.match(new RegExp('</(' + this.opts.blockTags.join('|' ).toUpperCase() + ')>', 'gi'));var match2 = html.match(new RegExp('<hr(.*?[^>])>', 'gi'));return (match1 === null && match2 === null) ? false : true;},isHtmlLine: function(html){if (this.clean.isHtmlBlocked(html)){return false;}var matchBR = html.match(/<br\s?\/?>/gi);var matchNL = html.match(/\n/gi);return (!matchBR && !matchNL) ? true : false;},isHtmlMsWord: function(html){return html.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i);},removeEmptyInlineTags: function(html){var tags = this.opts.inlineTags;var $div = $("<div/>").html($.parseHTML(html, document, true));var self = this;var $spans = $div.find('span');var $tags = $div.find(tags.join(','));$tags.removeAttr('style');$tags.each(function(){var tagHtml = $(this).html();if (this.attributes.length === 0 && self.utils.isEmpty(tagHtml)){$(this).replaceWith(function(){return $(this).contents();});}});$spans.each(function(){var tagHtml = $(this).html();if (this.attributes.length === 0){$(this).replaceWith(function(){return $(this).contents();});}});html = $div.html();html = html.replace('<!--?php', '<?php');html = html.replace('<!--?', '<?');html = html.replace('?-->', '?>');$div.remove();return html;},cleanMsWord: function(html){html = html.replace(/<!--[\s\S]*?-->/g, "");html = html.replace(/<o:p>[\s\S]*?<\/o:p>/gi, '');html = html.replace(/\n/g, " ");html = html.replace(/<br\s?\/?>|<\/p>|<\/div>|<\/li>|<\/td>/gi, '\n\n');var $div = $("<div/>").html(html);var lastList = false;var lastLevel = 1;var listsIds = [];$div.find("p[style]").each(function(){var matches = $(this).attr('style').match(/mso\-list\:l([0-9]+)\slevel([0-9]+)/);if (matches){var currentList = parseInt(matches[1]);var currentLevel = parseInt(matches[2]);var listType = $(this).html().match(/^[\w]+\./) ? "ol" : "ul";var $li = $("<li/>").html($(this).html());$li.html($li.html().replace(/^([\w\.]+)</, '<'));$li.find("span:first").remove();if (currentLevel == 1 && $.inArray(currentList, listsIds) == -1){var $list = $("<" + listType + "/>").attr({"data-level": currentLevel, "data-list": currentList}).html($li);$(this).replaceWith($list);lastList = currentList;listsIds.push(currentList);}else{if (currentLevel > lastLevel){var $prevList = $div.find('[data-level="' + lastLevel + '"][data-list="' + lastList + '"]');var $lastList = $prevList;for(var i = lastLevel; i < currentLevel; i++){$list = $("<" + listType + "/>");$list.appendTo($lastList.find("li").last());$lastList = $list;}$lastList.attr({"data-level": currentLevel, "data-list": currentList}).html($li);}else{var $prevList = $div.find('[data-level="' + currentLevel + '"][data-list="' + currentList + '"]').last();$prevList.append($li);}lastLevel = currentLevel;lastList = currentList;$(this).remove();}}});$div.find('[data-level][data-list]').removeAttr('data-level data-list');html = $div.html();return html;},replaceNbspToSpaces: function(html){return html.replace('&nbsp;', ' ');},replaceBrToNl: function(html){return html.replace(/<br\s?\/?>/gi, '\n');},replaceNlToBr: function(html){return html.replace(/\n/g, '<br />');},convertTags: function(html, data){var $div = $('<div>').html(html);$div.find('iframe').remove();var $links = $div.find('a');$links.removeAttr('style');if (this.opts.pasteLinkTarget !== false){$links.attr('target', this.opts.pasteLinkTarget);}if (data.links && this.opts.pasteLinks){$div.find('a').each(function(i, link){if (link.href){var tmp = '##%a href="' + link.href + '"';var attr;for (var j = 0, length = link.attributes.length; j < length; j++){attr = link.attributes.item(j);if (attr.name !== 'href'){tmp += ' ' + attr.name + '="' + attr.value + '"';}}link.outerHTML = tmp + '%##' + link.innerHTML + '##%/a%##';}});}html = $div.html();if (data.images && this.opts.pasteImages){html = html.replace(/<img(.*?)src="(.*?)"(.*?[^>])>/gi, '##%img$1src="$2"$3%##');}if (this.opts.pastePlainText){return html;}var blockTags = (data.lists) ? ['ul', 'ol', 'li'] : this.opts.pasteBlockTags;var tags;if (data.block || data.lists){tags = (data.inline) ? blockTags.concat(this.opts.pasteInlineTags) : blockTags;}else{tags = (data.inline) ? this.opts.pasteInlineTags : [];}var len = tags.length;for (var i = 0; i < len; i++){html = html.replace(new RegExp('<\/' + tags[i] + '>', 'gi'), '###/' + tags[i] + '###');if (tags[i] === 'td' || tags[i] === 'th'){html = html.replace(new RegExp('<' + tags[i] + '(.*?[^>])((colspan|rowspan)="(.*?[^>])")?(.*?[^>])>', 'gi'), '###' + tags[i] + ' $2###');}else if (tags[i] === 'span'){html = html.replace(new RegExp('<' + tags[i] + '([^>]*)class="([^>]*)"[^>]*>', 'gi'), '###' + tags[i] + ' class="$2"###');html = html.replace(new RegExp('<' + tags[i] + '([^>]*)data-redactor-style-cache="([^>]*)"[^>]*>', 'gi'), '###' + tags[i] + ' cache="$2"###');}else{html = html.replace(new RegExp('<' + tags[i] + '[^>]*>', 'gi'), '###' + tags[i] + '###');}}return html;},reconvertTags: function(html, data){if ((data.links && this.opts.pasteLinks) || (data.images && this.opts.pasteImages)){html = html.replace(new RegExp('##%', 'gi'), '<');html = html.replace(new RegExp('%##', 'gi'), '>');}if (this.opts.pastePlainText){return html;}var blockTags = (data.lists) ? ['ul', 'ol', 'li'] : this.opts.pasteBlockTags;var tags;if (data.block || data.lists){tags = (data.inline) ? blockTags.concat(this.opts.pasteInlineTags) : blockTags;}else{tags = (data.inline) ? this.opts.pasteInlineTags : [];}var len = tags.length;for (var i = 0; i < len; i++){html = html.replace(new RegExp('###\/' + tags[i] + '###', 'gi'), '</' + tags[i] + '>');}for (var i = 0; i < len; i++){html = html.replace(new RegExp('###' + tags[i] + '###', 'gi'), '<' + tags[i] + '>');}for (var i = 0; i < len; i++){if (tags[i] === 'td' || tags[i] === 'th'){html = html.replace(new RegExp('###' + tags[i] + '\s?(.*?[^#])###', 'gi'), '<' + tags[i] + '$1>');}else if (tags[i] === 'span'){html = html.replace(new RegExp('###' + tags[i] + ' cache="(.*?[^#])"###', 'gi'), '<' + tags[i] + ' style="$1" data-redactor-span="true" data-redactor-style-cache="$1">');html = html.replace(new RegExp('###' + tags[i] + '\s?(.*?[^#])###', 'gi'), '<' + tags[i] + '$1>');}}return html;},cleanPre: function(block){block = (typeof block === 'undefined') ? $(this.selection.block()).closest('pre', this.core.editor()[0]) : block;$(block).find('br').replaceWith(function(){return document.createTextNode('\n');});$(block).find('p').replaceWith(function(){return $(this).contents();});},removeTagsInsidePre: function(html){var $div = $('<div />').append(html);$div.find('pre').replaceWith(function(){var str = $(this).html();str = str.replace(/<br\s?\/?>|<\/p>|<\/div>|<\/li>|<\/td>/gi, '\n');str = str.replace(/(<([^>]+)>)/gi, '');return $('<pre />').append(str);});html = $div.html();$div.remove();return html;},getPlainText: function(html){html = html.replace(/<!--[\s\S]*?-->/gi, '');html = html.replace(/<style[\s\S]*?style>/gi, '');html = html.replace(/<\/p>|<\/div>|<\/li>|<\/td>/gi, '\n');html = html.replace(/<\/H[1-6]>/gi, '\n\n');var tmp = document.createElement('div');tmp.innerHTML = html;html = tmp.textContent || tmp.innerText;return $.trim(html);},savePreCode: function(html){html = this.clean.savePreFormatting(html);html = this.clean.saveCodeFormatting(html);html = this.clean.restoreSelectionMarkers(html);return html;},savePreFormatting: function(html){var pre = html.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);if (pre === null){return html;}$.each(pre, $.proxy(function(i,s){var arr = [];var codeTag = false;var contents, attr1, attr2;if (s.match(/<pre(.*?)>(([\n\r\s]+)?)<code(.*?)>/i)){arr = s.match(/<pre(.*?)>(([\n\r\s]+)?)<code(.*?)>([\w\W]*?)<\/code>(([\n\r\s]+)?)<\/pre>/i);codeTag = true;contents = arr[5];attr1 = arr[1];attr2 = arr[4];}else{arr = s.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);contents = arr[2];attr1 = arr[1];}contents = contents.replace(/<br\s?\/?>/g, '\n');contents = contents.replace(/&nbsp;/g, ' ');if (this.opts.preSpaces){contents = contents.replace(/\t/g, new Array(this.opts.preSpaces + 1).join(' '));}contents = this.clean.encodeEntities(contents);contents = contents.replace(/\$/g, '&#36;');if (codeTag){html = html.replace(s, '<pre' + attr1 + '><code' + attr2 + '>' + contents + '</code></pre>');}else{html = html.replace(s, '<pre' + attr1 + '>' + contents + '</pre>');}}, this));return html;},saveCodeFormatting: function(html){var code = html.match(/<code(.*?)>([\w\W]*?)<\/code>/gi);if (code === null){return html;}$.each(code, $.proxy(function(i,s){var arr = s.match(/<code(.*?)>([\w\W]*?)<\/code>/i);arr[2] = arr[2].replace(/&nbsp;/g, ' ');arr[2] = this.clean.encodeEntities(arr[2]);arr[2] = arr[2].replace(/\$/g, '&#36;');html = html.replace(s, '<code' + arr[1] + '>' + arr[2] + '</code>');}, this));return html;},restoreSelectionMarkers: function(html){html = html.replace(/&lt;span id=&quot;selection-marker-([0-9])&quot; class=&quot;redactor-selection-marker&quot;&gt;​&lt;\/span&gt;/g, '<span id="selection-marker-$1" class="redactor-selection-marker">​</span>');return html;},saveFormTags: function(html){return html.replace(/<form(.*?)>([\w\W]*?)<\/form>/gi, '<section$1 rel="redactor-form-tag">$2</section>');},restoreFormTags: function(html){return html.replace(/<section(.*?) rel="redactor-form-tag"(.*?)>([\w\W]*?)<\/section>/gi, '<form$1$2>$3</form>');},encodeHtml: function(html){html = html.replace(/”/g, '"');html = html.replace(/“/g, '"');html = html.replace(/‘/g, '\'');html = html.replace(/’/g, '\'');html = this.clean.encodeEntities(html);return html;},encodeEntities: function(str){str = String(str).replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '"');str = str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');return str;},stripTags: function(input, denied){if (typeof denied === 'undefined'){return input.replace(/(<([^>]+)>)/gi, '');}var tags = /<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return input.replace(tags, function ($0, $1){return denied.indexOf($1.toLowerCase()) === -1 ? $0 : '';});},removeMarkers: function(html){return html.replace(/<span(.*?[^>]?)class="redactor-selection-marker"(.*?[^>]?)>([\w\W]*?)<\/span>/gi, '');},removeSpaces: function(html){html = $.trim(html);html = html.replace(/\n/g, '');html = html.replace(/[\t]*/g, '');html = html.replace(/\n\s*\n/g, "\n");html = html.replace(/^[\s\n]*/g, ' ');html = html.replace(/[\s\n]*$/g, ' ');html = html.replace( />\s{2,}</g, '> <'); html = html.replace(/\n\n/g, "\n");html = html.replace(/\u200B/g, '');return html;},removeSpacesHard: function(html){html = $.trim(html);html = html.replace(/\n/g, '');html = html.replace(/[\t]*/g, '');html = html.replace(/\n\s*\n/g, "\n");html = html.replace(/^[\s\n]*/g, '');html = html.replace(/[\s\n]*$/g, '');html = html.replace( />\s{2,}</g, '><');html = html.replace(/\n\n/g, "\n");html = html.replace(/\u200B/g, '');return html;},normalizeCurrentHeading: function(){var heading = this.selection.block();if (this.utils.isCurrentOrParentHeader() && heading){heading.normalize();}}};},code: function(){return {syncFire: true,html: false,start: function(html){html = $.trim(html);html = html.replace(/^(<span id="selection-marker-1" class="redactor-selection-marker">​<\/span>)/, '');if (this.opts.type === 'textarea'){html = this.clean.onSet(html);}else if (this.opts.type === 'div' && html === ''){html = this.opts.emptyHtml;}html = html.replace(/<p><span id="selection-marker-1" class="redactor-selection-marker">​<\/span><\/p>/, '');this.events.stopDetectChanges();this.core.editor().html(html);this.observe.load();this.events.startDetectChanges();},set: function(html, options){html = $.trim(html);options = options || {};if (options.start){this.start = options.start;}if (this.opts.type === 'textarea'){html = this.clean.onSet(html);}else if (this.opts.type === 'div' && html === ''){html = this.opts.emptyHtml;}this.core.editor().html(html);if (this.opts.type === 'textarea'){this.code.sync();}this.placeholder.enable();},get: function(){if (this.opts.type === 'textarea'){return this.core.textarea().val();}else{var html = this.core.editor().html();html = this.clean.onGet(html);return html;}},sync: function(){if (!this.code.syncFire){return;}var html = this.core.editor().html();var htmlCleaned = this.code.cleaned(html);if (this.code.isSync(htmlCleaned)){return;}this.code.html = htmlCleaned;if (this.opts.type !== 'textarea'){this.core.callback('sync', html);this.core.callback('change', html);return;}if (this.opts.type === 'textarea'){setTimeout($.proxy(function(){this.code.startSync(html);}, this), 10);}},startSync: function(html){html = this.core.callback('syncBefore', html);html = this.clean.onSync(html);this.core.textarea().val(html);this.core.callback('sync', html);if (this.start === false){this.core.callback('change', html);}this.start = false;},isSync: function(htmlCleaned){var html = (this.code.html !== false) ? this.code.html : false;return (html !== false && html === htmlCleaned);},cleaned: function(html){html = html.replace(/\u200B/g, '');return this.clean.removeMarkers(html);}};},core: function(){return {id: function(){return this.$editor.attr('id');},element: function(){return this.$element;},editor: function(){return (typeof this.$editor === 'undefined') ? $() : this.$editor;},textarea: function(){return this.$textarea;},box: function(){return (this.opts.type === 'textarea') ? this.$box : this.$element;},toolbar: function(){return (this.$toolbar) ? this.$toolbar : false;},air: function(){return (this.$air) ? this.$air : false;},object: function(){return $.extend({}, this);},structure: function(){this.core.editor().toggleClass('redactor-structure');},addEvent: function(name){this.core.event = name;},getEvent: function(){return this.core.event;},callback: function(type, e, data){var eventNamespace = 'redactor';var returnValue = false;var events = $._data(this.core.element()[0], 'events');if (typeof events !== 'undefined' && typeof events[type] !== 'undefined'){var len = events[type].length;for (var i = 0; i < len; i++){var namespace = events[type][i].namespace;if (namespace === 'callback.' + eventNamespace){var handler = events[type][i].handler;var args = (typeof data === 'undefined') ? [e] : [e, data];returnValue = (typeof args === 'undefined') ? handler.call(this, e) : handler.call(this, e, args);}}}if (returnValue){return returnValue;}if (typeof this.opts.callbacks[type] === 'undefined'){return (typeof data === 'undefined') ? e : data;}var callback = this.opts.callbacks[type];if ($.isFunction(callback)){return (typeof data === 'undefined') ? callback.call(this, e) : callback.call(this, e, data);}else{return (typeof data === 'undefined') ? e : data;}},destroy: function(){this.opts.destroyed = true;this.core.callback('destroy');this.placeholder.destroy();this.progress.destroy();$('#redactor-voice-' + this.uuid).remove();this.core.editor().removeClass('redactor-in redactor-styles redactor-structure redactor-layer-img-edit');this.core.editor().off('keydown.redactor-remove-textnode');this.core.editor().off('.redactor-observe.' + this.uuid);this.$element.off('.redactor').removeData('redactor');this.core.editor().off('.redactor');$(document).off('.redactor-dropdown');$(document).off('.redactor-air.' + this.uuid);$(document).off('mousedown.redactor-blur.' + this.uuid);$(document).off('mousedown.redactor.' + this.uuid);$(document).off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid);$(window).off('.redactor-toolbar.' + this.uuid);$(window).off('touchmove.redactor.' + this.uuid);$("body").off('scroll.redactor.' + this.uuid);$(this.opts.toolbarFixedTarget).off('scroll.redactor.' + this.uuid);var self = this;if (this.opts.plugins !== false){$.each(this.opts.plugins, function(i,s){$(window).off('.redactor-plugin-' + s);$(document).off('.redactor-plugin-' + s);$("body").off('.redactor-plugin-' + s);self.core.editor().off('.redactor-plugin-' + s);});}this.$element.off('click.redactor-click-to-edit');this.$element.removeClass('redactor-click-to-edit');this.core.editor().removeClass('redactor-layer');this.core.editor().removeAttr('contenteditable');var html = this.code.get();if (this.opts.toolbar && this.$toolbar){this.$toolbar.find('a').each(function(){var $el = $(this);if ($el.data('dropdown')){$el.data('dropdown').remove();$el.data('dropdown', {});}});}if (this.opts.type === 'textarea'){this.$box.after(this.$element);this.$box.remove();this.$element.val(html).show();}if (this.opts.air){this.$air.remove();}if (this.opts.toolbar && this.$toolbar){this.$toolbar.remove();}if (this.$modalBox){this.$modalBox.remove();}if (this.$modalOverlay){this.$modalOverlay.remove();}$('.redactor-link-tooltip').remove();clearInterval(this.autosaveTimeout);}};},detect: function(){return {isWebkit: function(){return /webkit/.test(this.opts.userAgent);},isFirefox: function(){return this.opts.userAgent.indexOf('firefox') > -1;},isIe: function(v){if (document.documentMode || /Edge/.test(navigator.userAgent)){return 'edge';}var ie;ie = RegExp('msie' + (!isNaN(v)?('\\s'+v):''), 'i').test(navigator.userAgent);if (!ie){ie = !!navigator.userAgent.match(/Trident.*rv[ :]*11\./);}return ie;},isMobile: function(){return /(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent);},isDesktop: function(){return !/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent);},isIpad: function(){return /iPad/.test(navigator.userAgent);}};},dropdown: function(){return {active: false,button: false,key: false,position: [],getDropdown: function(){return this.dropdown.active;},build: function(name, $dropdown, dropdownObject){dropdownObject = this.dropdown.buildFormatting(name, dropdownObject);$.each(dropdownObject, $.proxy(function(btnName, btnObject){var $item = this.dropdown.buildItem(btnName, btnObject);this.observe.addDropdown($item, btnName, btnObject);$dropdown.attr('rel', name).append($item);}, this));},buildFormatting: function(name, dropdownObject){if (name !== 'format' || this.opts.formattingAdd === false){return dropdownObject;}$.each(this.opts.formattingAdd, $.proxy(function(i,s){var type = (this.utils.isBlockTag(s.args[0])) ? 'block' : 'inline';dropdownObject[i] = {func: (type === 'block') ? 'block.format' : 'inline.format',args: s.args,title: s.title};}, this));return dropdownObject;},buildItem: function(btnName, btnObject){var $itemContainer = $('<li />');if (typeof btnObject.classname !== 'undefined'){$itemContainer.addClass(btnObject.classname);}if (btnName.search(/^divider/i) !== -1){$itemContainer.addClass('redactor-dropdown-divider');return $itemContainer;}var $item = $('<a href="#" class="redactor-dropdown-' + btnName + '" role="button" />');var $itemSpan = $('<span />').html(btnObject.title);$item.append($itemSpan);$item.on('mousedown', $.proxy(function(e){e.preventDefault();this.dropdown.buildClick(e, btnName, btnObject);}, this));$itemContainer.append($item);return $itemContainer;},buildClick: function(e, btnName, btnObject){if ($(e.target).hasClass('redactor-dropdown-link-inactive')){return;}var command = this.dropdown.buildCommand(btnObject);if (typeof btnObject.args !== ' undefined'){this.button.toggle(e, btnName, command.type, command.callback, btnObject.args);}else{this.button.toggle(e, btnName, command.type, command.callback);}},buildCommand: function(btnObject){var command = {};command.type = 'func';command.callback = btnObject.func;if (btnObject.command){command.type = 'command';command.callback = btnObject.command;}else if (btnObject.dropdown){command.type = 'dropdown';command.callback = btnObject.dropdown;}return command;},show: function(e, key){if (this.detect.isDesktop()){this.core.editor().focus();}this.dropdown.hideAll(false, key);this.dropdown.key = key;this.dropdown.button = this.button.get(this.dropdown.key);if (this.dropdown.button.hasClass('dropact')){this.dropdown.hide();return;}this.dropdown.active = this.dropdown.button.data('dropdown').appendTo(document.body);this.core.callback('dropdownShow', { dropdown: this.dropdown.active, key: this.dropdown.key, button: this.dropdown.button });this.button.setActive(this.dropdown.key);this.dropdown.button.addClass('dropact');this.dropdown.getButtonPosition();if (this.button.toolbar().hasClass('toolbar-fixed-box') && this.detect.isDesktop()){this.dropdown.showIsFixedToolbar();}else{this.dropdown.showIsUnFixedToolbar();}if (this.detect.isDesktop() && !this.detect.isFirefox()){this.dropdown.active.on('mouseover.redactor-dropdown', $.proxy(this.utils.disableBodyScroll, this));this.dropdown.active.on('mouseout.redactor-dropdown mousedown.redactor-dropdown', $.proxy(this.utils.enableBodyScroll, this));}e.stopPropagation();},showIsFixedToolbar: function(){var top = this.dropdown.button.position().top + this.dropdown.button.innerHeight() + this.opts.toolbarFixedTopOffset;var position = 'fixed';if (this.opts.toolbarFixedTarget !== document){top = (this.dropdown.button.innerHeight() + this.$toolbar.offset().top) + this.opts.toolbarFixedTopOffset;position = 'absolute';}this.dropdown.active.css({position: position,left: this.dropdown.position.left + 'px',top: top + 'px'}).show();this.dropdown.active.redactorAnimation('slideDown', { duration: 0.2 }, $.proxy(function(){this.dropdown.enableCallback();this.dropdown.enableEvents();}, this));},showIsUnFixedToolbar: function(){this.dropdown.active.css({position: 'absolute',left: this.dropdown.position.left + 'px',top: (this.dropdown.button.innerHeight() + this.dropdown.position.top) + 'px'}).show();this.dropdown.active.redactorAnimation(((this.opts.animation) ? 'slideDown' : 'show'), { duration: 0.2 }, $.proxy(function(){this.dropdown.enableCallback();this.dropdown.enableEvents();}, this));},enableEvents: function(){$(document).on('mousedown.redactor-dropdown', $.proxy(this.dropdown.hideAll, this));this.core.editor().on('touchstart.redactor-dropdown', $.proxy(this.dropdown.hideAll, this));$(document).on('keyup.redactor-dropdown', $.proxy(this.dropdown.closeHandler, this));},enableCallback: function(){this.core.callback('dropdownShown', { dropdown: this.dropdown.active, key: this.dropdown.key, button: this.dropdown.button });},getButtonPosition: function(){this.dropdown.position = this.dropdown.button.offset();var dropdownWidth = this.dropdown.active.width();if ((this.dropdown.position.left + dropdownWidth) > $(document).width()){this.dropdown.position.left = Math.max(0, this.dropdown.position.left - dropdownWidth + parseInt(this.dropdown.button.innerWidth()));}},closeHandler: function(e){if (e.which !== this.keyCode.ESC){return;}this.dropdown.hideAll(e);this.core.editor().focus();},hideAll: function(e, key){if (this.detect.isDesktop()){this.utils.enableBodyScroll();}if (e !== false && $(e.target).closest('.redactor-dropdown').length !== 0){return;}var $buttons = (typeof key === 'undefined') ? this.button.toolbar().find('a.dropact') : this.button.toolbar().find('a.dropact').not('.re-' + key);var $elements = (typeof key === 'undefined') ? $('.redactor-dropdown-' + this.uuid) : $('.redactor-dropdown-' + this.uuid).not('.redactor-dropdown-box-' + key);if ($elements.length !== 0){$(document).off('.redactor-dropdown');this.core.editor().off('.redactor-dropdown');$.each($elements, $.proxy(function(i,s){var $el = $(s);this.core.callback('dropdownHide', $el);$el.hide();$el.off('mouseover mouseout').off('.redactor-dropdown');}, this));$buttons .removeClass('redactor-act dropact');}},hide: function (){if (this.dropdown.active === false){return;}if (this.detect.isDesktop()){this.utils.enableBodyScroll();}this.dropdown.active.redactorAnimation(((this.opts.animation) ? 'slideUp' : 'hide'), { duration: 0.2 }, $.proxy(function(){$(document).off('.redactor-dropdown');this.core.editor().off('.redactor-dropdown');this.dropdown.hideOut();}, this));},hideOut: function(){this.core.callback('dropdownHide', this.dropdown.active);this.dropdown.button.removeClass('redactor-act dropact');this.dropdown.active.off('mouseover mouseout').off('.redactor-dropdown');this.dropdown.button = false;this.dropdown.key = false;this.dropdown.active = false;}};},events: function(){return {focused: false,blured: true,dropImage: false,stopChanges: false,stopDetectChanges: function(){this.events.stopChanges = true;},startDetectChanges: function(){var self = this;setTimeout(function(){self.events.stopChanges = false;}, 1);},dragover: function(e){e.preventDefault();e.stopPropagation();if (e.target.tagName === 'IMG'){$(e.target).addClass('redactor-image-dragover');}},dragleave: function(e){this.core.editor().find('img').removeClass('redactor-image-dragover');},drop: function(e){e = e.originalEvent || e;this.core.editor().find('img').removeClass('redactor-image-dragover');if (this.opts.type === 'inline' || this.opts.type === 'pre'){e.preventDefault();return false;}if (window.FormData === undefined || !e.dataTransfer){return true;}if (e.dataTransfer.files.length === 0){return this.events.onDrop(e);}else{this.events.onDropUpload(e);}this.core.callback('drop', e);},click: function(e){var event = this.core.getEvent();var type = (event === 'click' || event === 'arrow') ? false : 'click';this.core.addEvent(type);this.utils.disableSelectAll();this.core.callback('click', e);},focus: function(e){if (this.rtePaste){return;}if (this.events.isCallback('focus')){this.core.callback('focus', e);}this.events.focused = true;this.events.blured = false;if (this.selection.current() === false){var sel = this.selection.get();var range = this.selection.range(sel);range.setStart(this.core.editor()[0], 0);range.setEnd(this.core.editor()[0], 0);this.selection.update(sel, range);}},blur: function(e){if (this.start || this.rtePaste){return;}if ($(e.target).closest('#' + this.core.id() + ', .redactor-toolbar, .redactor-dropdown, #redactor-modal-box').length !== 0){return;}if (!this.events.blured && this.events.isCallback('blur')){this.core.callback('blur', e);}this.events.focused = false;this.events.blured = true;},touchImageEditing: function(){var scrollTimer = -1;this.events.imageEditing = false;$(window).on('touchmove.redactor.' + this.uuid, $.proxy(function(){this.events.imageEditing = true;if (scrollTimer !== -1){clearTimeout(scrollTimer);}scrollTimer = setTimeout($.proxy(function(){this.events.imageEditing = false;}, this), 500);}, this));},init: function(){this.core.editor().on('dragover.redactor dragenter.redactor', $.proxy(this.events.dragover, this));this.core.editor().on('dragleave.redactor', $.proxy(this.events.dragleave, this));this.core.editor().on('drop.redactor', $.proxy(this.events.drop, this));this.core.editor().on('click.redactor', $.proxy(this.events.click, this));this.core.editor().on('paste.redactor', $.proxy(this.paste.init, this));this.core.editor().on('keydown.redactor', $.proxy(this.keydown.init, this));this.core.editor().on('keyup.redactor', $.proxy(this.keyup.init, this));this.core.editor().on('focus.redactor', $.proxy(this.events.focus, this));$(document).on('mousedown.redactor-blur.' + this.uuid, $.proxy(this.events.blur, this));this.events.touchImageEditing();this.events.createObserver();this.events.setupObserver();},createObserver: function(){var self = this;this.events.observer = new MutationObserver(function(mutations){mutations.forEach($.proxy(self.events.iterateObserver, self));});},iterateObserver: function(mutation){var stop = false;if (((this.opts.type === 'textarea' || this.opts.type === 'div')&& (!this.detect.isFirefox() && mutation.target === this.core.editor()[0]))|| (mutation.attributeName === 'class' && mutation.target === this.core.editor()[0])){stop = true;}if (!stop){this.observe.load();this.events.changeHandler();}},setupObserver: function(){this.events.observer.observe(this.core.editor()[0], { attributes: true, subtree: true, childList: true, characterData: true, characterDataOldValue: true});},changeHandler: function(){if (this.events.stopChanges){return;}this.code.sync();if (this.autosave.is()){clearTimeout(this.autosaveTimeout);this.autosaveTimeout = setTimeout($.proxy(this.autosave.send, this), 300);}},onDropUpload: function(e){e.preventDefault();e.stopPropagation();if ((!this.opts.dragImageUpload && !this.opts.dragFileUpload) || (this.opts.imageUpload === null && this.opts.fileUpload === null)){return;}if (e.target.tagName === 'IMG'){this.events.dropImage = e.target;}var files = e.dataTransfer.files;var len = files.length;for (var i = 0; i < len; i++){this.upload.directUpload(files[i], e);}},onDrop: function(e){this.core.callback('drop', e);},isCallback: function(name){return (typeof this.opts.callbacks[name] !== 'undefined' && $.isFunction(this.opts.callbacks[name]));},stopDetect: function(){this.events.stopDetectChanges();},startDetect: function(){this.events.startDetectChanges();}};},file: function(){return {is: function(){return !(!this.opts.fileUpload || !this.opts.fileUpload && !this.opts.s3);},show: function(){this.modal.load('file', this.lang.get('file'), 700);this.upload.init('#redactor-modal-file-upload', this.opts.fileUpload, this.file.insert);$('#redactor-filename').val(this.selection.get().toString());this.modal.show();},insert: function(json, direct, e){if (typeof json.error !== 'undefined'){this.modal.close();this.core.callback('fileUploadError', json);return;}this.file.release(e, direct);this.buffer.set();this.air.collapsed();var text = this.file.text(json);var $link = $('<a />').attr('href', json.url).text(text);var id = (typeof json.id === 'undefined') ? '' : json.id;var type = (typeof json.s3 === 'undefined') ? 'file' : 's3';$link.attr('data-' + type, id);$link = $(this.insert.node($link));this.caret.after($link);this.storage.add({ type: type, node: $link[0], url: $link[0].href, id: id });if (direct !== null){this.core.callback('fileUpload', $link, json);}},release: function(e, direct){if (direct){this.marker.remove();this.insert.nodeToPoint(e, this.marker.get());this.selection.restore();}else{this.modal.close();}},text: function(json){var text = $('#redactor-filename').val();return (typeof text === 'undefined' || text === '') ? json.name : text;}};},focus: function(){return {start: function(){this.core.editor().focus();if (this.opts.type === 'inline'){return;}var $first = this.focus.first();if ($first !== false){this.caret.start($first);}},end: function(){this.core.editor().focus();var last = (this.opts.inline) ? this.core.editor() : this.focus.last();if (last.length === 0){return;}var lastNode = this.focus.lastChild(last);if (!this.detect.isWebkit() && lastNode !== false){this.caret.end(lastNode);}else{var sel = this.selection.get();var range = this.selection.range(sel);if (range !== null){range.selectNodeContents(last[0]);range.collapse(false);this.selection.update(sel, range);}else{this.caret.end(last);}}},first: function(){var $first = this.core.editor().children().first();if ($first.length === 0 && ($first[0].length === 0 || $first[0].tagName === 'BR' || $first[0].tagName === 'HR' || $first[0].nodeType === 3)){return false;}if ($first[0].tagName === 'UL' || $first[0].tagName === 'OL'){return $first.find('li').first();}return $first;},last: function(){return this.core.editor().children().last();},lastChild: function(last){var lastNode = last[0].lastChild;return (lastNode !== null && this.utils.isInlineTag(lastNode.tagName)) ? lastNode : false;},is: function(){return (this.core.editor()[0] === document.activeElement);}};},image: function(){return {is: function(){return !(!this.opts.imageUpload || !this.opts.imageUpload && !this.opts.s3);},show: function(){this.modal.load('image', this.lang.get('image'), 700);this.upload.init('#redactor-modal-image-droparea', this.opts.imageUpload, this.image.insert);this.modal.show();},insert: function(json, direct, e){var $img;if (typeof json.error !== 'undefined'){this.modal.close();this.events.dropImage = false;this.core.callback('imageUploadError', json, e);return;}if (this.events.dropImage !== false){$img = $(this.events.dropImage);this.core.callback('imageDelete', $img[0].src, $img);$img.attr('src', json.url);this.events.dropImage = false;this.core.callback('imageUpload', $img, json);return;}this.placeholder.hide();var $figure = $('<' + this.opts.imageTag + '>');$img = $('<img>');$img.attr('src', json.url);var id = (typeof json.id === 'undefined') ? '' : json.id;var type = (typeof json.s3 === 'undefined') ? 'image' : 's3';$img.attr('data-' + type, id);$figure.append($img);var pre = this.utils.isTag(this.selection.current(), 'pre');if (direct){this.air.collapsed();this.marker.remove();var node = this.insert.nodeToPoint(e, this.marker.get());var $next = $(node).next();this.selection.restore();this.buffer.set();if (typeof $next !== 'undefined' && $next.length !== 0 && $next[0].tagName === 'IMG'){this.core.callback('imageDelete', $next[0].src, $next);$next.closest('figure, p', this.core.editor()[0]).replaceWith($figure);this.caret.after($figure);}else{if (pre){$(pre).after($figure);}else{this.insert.node($figure);}this.caret.after($figure);}}else{this.modal.close();this.buffer.set();this.air.collapsed();if (pre){$(pre).after($figure);}else{this.insert.node($figure);}this.caret.after($figure);}this.events.dropImage = false;this.storage.add({ type: type, node: $img[0], url: $img[0].src, id: id });var nextNode = $img[0].nextSibling;var $nextFigure = $figure.next();var isNextEmpty = $(nextNode).text().replace(/\u200B/g, '');var isNextFigureEmpty = $nextFigure.text().replace(/\u200B/g, '');if (isNextEmpty === ''){$(nextNode).remove();}if ($nextFigure.length === 1 && $nextFigure[0].tagName === 'FIGURE' && isNextFigureEmpty === ''){$nextFigure.remove();}if (direct !== null){this.core.callback('imageUpload', $img, json);}else{this.core.callback('imageInserted', $img, json);}},setEditable: function($image){$image.on('dragstart', function(e){e.preventDefault();});if (this.opts.imageResizable){var handler = $.proxy(function(e){this.observe.image = $image;this.image.resizer = this.image.loadEditableControls($image);$(document).on('mousedown.redactor-image-resize-hide.' + this.uuid, $.proxy(this.image.hideResize, this));if (this.image.resizer){this.image.resizer.on('mousedown.redactor touchstart.redactor', $.proxy(function(e){this.image.setResizable(e, $image);}, this));}}, this);$image.off('mousedown.redactor').on('mousedown.redactor', $.proxy(this.image.hideResize, this));$image.off('click.redactor touchstart.redactor').on('click.redactor touchstart.redactor', handler);}else{$image.off('click.redactor touchstart.redactor').on('click.redactor touchstart.redactor', $.proxy(function(e){setTimeout($.proxy(function(){this.image.showEdit($image);}, this), 200);}, this));}},setResizable: function(e, $image){e.preventDefault();this.image.resizeHandle = {x : e.pageX,y : e.pageY,el : $image,ratio: $image.width() / $image.height(),h: $image.height()};e = e.originalEvent || e;if (e.targetTouches){ this.image.resizeHandle.x = e.targetTouches[0].pageX; this.image.resizeHandle.y = e.targetTouches[0].pageY;}this.image.startResize();},startResize: function(){$(document).on('mousemove.redactor-image-resize touchmove.redactor-image-resize', $.proxy(this.image.moveResize, this));$(document).on('mouseup.redactor-image-resize touchend.redactor-image-resize', $.proxy(this.image.stopResize, this));},moveResize: function(e){e.preventDefault();e = e.originalEvent || e;var height = this.image.resizeHandle.h;if (e.targetTouches) height += (e.targetTouches[0].pageY -  this.image.resizeHandle.y);else height += (e.pageY -  this.image.resizeHandle.y);var width = Math.round(height * this.image.resizeHandle.ratio);if (height < 50 || width < 100) return;var height = Math.round(this.image.resizeHandle.el.width() / this.image.resizeHandle.ratio);this.image.resizeHandle.el.attr({width: width, height: height});this.image.resizeHandle.el.width(width);this.image.resizeHandle.el.height(height);this.code.sync();},stopResize: function(){this.handle = false;$(document).off('.redactor-image-resize');this.image.hideResize();},hideResize: function(e){if (e && $(e.target).closest('#redactor-image-box', this.$editor[0]).length !== 0) return;if (e && e.target.tagName == 'IMG'){var $image = $(e.target);}var imageBox = this.$editor.find('#redactor-image-box');if (imageBox.length === 0) return;$('#redactor-image-editter').remove();$('#redactor-image-resizer').remove();imageBox.find('img').css({marginTop: imageBox[0].style.marginTop,marginBottom: imageBox[0].style.marginBottom,marginLeft: imageBox[0].style.marginLeft,marginRight: imageBox[0].style.marginRight});imageBox.css('margin', '');imageBox.find('img').css('opacity', '');imageBox.replaceWith(function(){return $(this).contents();});$(document).off('mousedown.redactor-image-resize-hide.' + this.uuid);if (typeof this.image.resizeHandle !== 'undefined'){this.image.resizeHandle.el.attr('rel', this.image.resizeHandle.el.attr('style'));}},loadResizableControls: function($image, imageBox){if (this.opts.imageResizable && !this.detect.isMobile()){var imageResizer = $('<span id="redactor-image-resizer" data-redactor="verified"></span>');if (!this.detect.isDesktop()){imageResizer.css({ width: '15px', height: '15px' });}imageResizer.attr('contenteditable', false);imageBox.append(imageResizer);imageBox.append($image);return imageResizer;}else{imageBox.append($image);return false;}},loadEditableControls: function($image){var imageBox = $('<span id="redactor-image-box" data-redactor="verified">');imageBox.css('float', $image.css('float')).attr('contenteditable', false);if ($image[0].style.margin != 'auto'){imageBox.css({marginTop: $image[0].style.marginTop,marginBottom: $image[0].style.marginBottom,marginLeft: $image[0].style.marginLeft,marginRight: $image[0].style.marginRight});$image.css('margin', '');}else{imageBox.css({ 'display': 'block', 'margin': 'auto' });}$image.css('opacity', '.5').after(imageBox);if (this.opts.imageEditable){this.image.editter = $('<span id="redactor-image-editter" data-redactor="verified">' + this.lang.get('edit') + '</span>');this.image.editter.attr('contenteditable', false);this.image.editter.on('click', $.proxy(function(){this.image.showEdit($image);}, this));imageBox.append(this.image.editter);var editerWidth = this.image.editter.innerWidth();this.image.editter.css('margin-left', '-' + editerWidth/2 + 'px');}return this.image.loadResizableControls($image, imageBox);},showEdit: function($image){if (this.events.imageEditing){return;}this.observe.image = $image;var $link = $image.closest('a', this.$editor[0]);var $figure = $image.closest('figure', this.$editor[0]);var $container = ($figure.length !== 0) ? $figure : $image;this.modal.load('image-edit', this.lang.get('edit'), 705);this.image.buttonDelete = this.modal.getDeleteButton().text(this.lang.get('delete'));this.image.buttonSave = this.modal.getActionButton().text(this.lang.get('save'));this.image.buttonDelete.on('click', $.proxy(this.image.remove, this));this.image.buttonSave.on('click', $.proxy(this.image.update, this));if (this.opts.imageCaption === false){$('#redactor-image-caption').val('').hide().prev().hide();}else{var $parent = $image.closest(this.opts.imageTag, this.$editor[0]);var $ficaption = $parent.find('figcaption');if ($ficaption !== 0){$('#redactor-image-caption').val($ficaption.text()).show();}}if (!this.opts.imagePosition){$('.redactor-image-position-option').hide();}else{var isCentered = ($figure.length !== 0) ? ($container.css('text-align') === 'center') : ($container.css('display') == 'block' && $container.css('float') == 'none');var floatValue = (isCentered) ? 'center' : $container.css('float');$('#redactor-image-align').val(floatValue);}$('#redactor-image-preview').html($('<img src="' + $image.attr('src') + '" style="max-width: 100%;">'));$('#redactor-image-title').val($image.attr('alt'));var $redactorImageLink = $('#redactor-image-link');$redactorImageLink.attr('href', $image.attr('src'));if ($link.length !== 0){$redactorImageLink.val($link.attr('href'));if ($link.attr('target') === '_blank'){$('#redactor-image-link-blank').prop('checked', true);}}$('.redactor-link-tooltip').remove();this.modal.show();if (this.detect.isDesktop()){$('#redactor-image-title').focus();}},update: function(){var $image = this.observe.image;var $link = $image.closest('a', this.core.editor()[0]);var title = $('#redactor-image-title').val().replace(/(<([^>]+)>)/ig,"");$image.attr('alt', title).attr('title', title);this.image.setFloating($image);var link = $.trim($('#redactor-image-link').val()).replace(/(<([^>]+)>)/ig,"");if (link !== ''){var pattern = '((xn--)?[a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}';var re = new RegExp('^(http|ftp|https)://' + pattern, 'i');var re2 = new RegExp('^' + pattern, 'i');if (link.search(re) === -1 && link.search(re2) === 0 && this.opts.linkProtocol){link = this.opts.linkProtocol + '://' + link;}var target = ($('#redactor-image-link-blank').prop('checked')) ? true : false;if ($link.length === 0){var a = $('<a href="' + link + '" id="redactor-img-tmp">' + this.utils.getOuterHtml($image) + '</a>');if (target){a.attr('target', '_blank');}$image = $image.replaceWith(a);$link = this.core.editor().find('#redactor-img-tmp');$link.removeAttr('id');}else{$link.attr('href', link);if (target){$link.attr('target', '_blank');}else{$link.removeAttr('target');}}}else if ($link.length !== 0){$link.replaceWith(this.utils.getOuterHtml($image));}this.image.addCaption($image, $link);this.modal.close();this.buffer.set();},setFloating: function($image){var $figure = $image.closest('figure', this.$editor[0]);var $container = ($figure.length !== 0) ? $figure : $image;var floating = $('#redactor-image-align').val();var imageFloat = '';var imageDisplay = '';var imageMargin = '';var textAlign = '';switch (floating){case 'left':imageFloat = 'left';imageMargin = '0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin + ' 0';break;case 'right':imageFloat = 'right';imageMargin = '0 0 ' + this.opts.imageFloatMargin + ' ' + this.opts.imageFloatMargin;break;case 'center':if ($figure.length !== 0){textAlign = 'center';}else{imageDisplay = 'block';imageMargin = 'auto';}break;}$container.css({ 'float': imageFloat, 'display': imageDisplay, 'margin': imageMargin, 'text-align': textAlign });$container.attr('rel', $image.attr('style'));},addCaption: function($image, $link){var caption = $('#redactor-image-caption').val();var $target = ($link.length !== 0) ? $link : $image;var $figcaption = $target.next();if ($figcaption.length === 0 || $figcaption[0].tagName !== 'FIGCAPTION'){$figcaption = false;}if (caption !== ''){if ($figcaption === false){$figcaption = $('<figcaption />').text(caption);$target.after($figcaption);}else{$figcaption.text(caption);}}else if ($figcaption !== false){$figcaption.remove();}},remove: function(e, $image, index){$image = (typeof $image === 'undefined') ? $(this.observe.image) : $image;if (typeof e !== 'boolean'){this.buffer.set();}this.events.stopDetectChanges();var $link = $image.closest('a', this.core.editor()[0]);var $figure = $image.closest(this.opts.imageTag, this.core.editor()[0]);var $parent = $image.parent();var imageDeleteStop = this.core.callback('imageDelete', e, $image[0]);if (imageDeleteStop === false){e.preventDefault();return false;}if ($('#redactor-image-box').length !== 0){$parent = $('#redactor-image-box').parent();}var $next, $prev;if ($figure.length !== 0){$prev = $figure.prev();$next = $figure.next();$figure.remove();}else if ($link.length !== 0){$parent = $link.parent();$link.remove();}else{$image.remove();}$('#redactor-image-box').remove();if (e !== false){if ($next && $next.length !== 0){this.caret.start($next);}else if ($prev && $prev.length !== 0){this.caret.end($prev);}}if (typeof e !== 'boolean'){this.modal.close();}this.utils.restoreScroll();this.observe.image = false;this.events.startDetectChanges();this.placeholder.enable();this.code.sync();}};},indent: function(){return {increase: function(){if (!this.list.get()){return;}var $current = $(this.selection.current()).closest('li');var $list = $current.closest('ul, ol', this.core.editor()[0]);var $li = $current.closest('li');var $prev = $li.prev();if ($prev.length === 0 || $prev[0].tagName !== 'LI'){return;}this.buffer.set();if (this.utils.isCollapsed()){var listTag = $list[0].tagName;var $newList = $('<' + listTag + ' />');this.selection.save();var $ol = $prev.find('ol').first();if ($ol.length === 1){$ol.append($current);}else{var listTag = $list[0].tagName;var $newList = $('<' + listTag + ' />');$newList.append($current);$prev.append($newList);}this.selection.restore();}else{document.execCommand('indent');this.selection.save();this.indent.removeEmpty();this.indent.normalize();this.selection.restore();}},decrease: function(){if (!this.list.get()){return;}var $current = $(this.selection.current()).closest('li');var $list = $current.closest('ul, ol', this.core.editor()[0]);this.buffer.set();document.execCommand('outdent');var $item = $(this.selection.current()).closest('li', this.core.editor()[0]);if (this.utils.isCollapsed()){this.indent.repositionItem($item);}if ($item.length === 0){document.execCommand('formatblock', false, 'p');$item = $(this.selection.current());var $next = $item.next();if ($next.length !== 0 && $next[0].tagName === 'BR'){$next.remove();}}this.selection.save();this.indent.removeEmpty();this.indent.normalize();this.selection.restore();},repositionItem: function($item){var $next = $item.next();if ($next.length !== 0 && ($next[0].tagName !== 'UL' || $next[0].tagName !== 'OL')){$item.append($next);}var $prev = $item.prev();if ($prev.length !== 0 && $prev[0].tagName !== 'LI'){this.selection.save();var $li = $item.parents('li', this.core.editor()[0]);$li.after($item);this.selection.restore();}},normalize: function(){this.core.editor().find('li').each($.proxy(function(i,s){var $el = $(s);$el.find(this.opts.inlineTags.join(',')).each(function(){$(this).removeAttr('style');});var $parent = $el.parent();if ($parent.length !== 0 && $parent[0].tagName === 'LI'){$parent.after($el);return;}var $next = $el.next();if ($next.length !== 0 && ($next[0].tagName === 'UL' || $next[0].tagName === 'OL')){$el.append($next);}}, this));},removeEmpty: function($list){var $lists = this.core.editor().find('ul, ol');var $items = this.core.editor().find('li');$items.each($.proxy(function(i, s){this.indent.removeItemEmpty(s);}, this));$lists.each($.proxy(function(i, s){this.indent.removeItemEmpty(s);}, this));$items.each($.proxy(function(i, s){this.indent.removeItemEmpty(s);}, this));},removeItemEmpty: function(s){var html = s.innerHTML.replace(/[\t\s\n]/g, '');html = html.replace(/<span><\/span>/g, '');if (html === ''){$(s).remove();}}};},inline: function(){return {getClearedNodes: function(){var nodes = this.selection.nodes();var newNodes = [];var len = nodes.length;var started = 0;for (var i = 0; i < len; i++){if ($(nodes[i]).hasClass('redactor-selection-marker')){started = i + 2;break;}}for (var i = 0; i < len; i++){if (i >= started && !this.utils.isBlockTag(nodes[i].tagName)){newNodes.push(nodes[i]);}}return newNodes;},isConvertableAttr: function(node, attr, value){var nodeAttrValue = $(node).attr(attr);if (nodeAttrValue){if (attr === 'style'){value = $.trim(value).replace(/;$/, '');var rules = value.split(';');var count = 0;for (var i = 0; i < rules.length; i++){var arr = rules[i].split(':');var ruleName = $.trim(arr[0]);var ruleValue = $.trim(arr[1]);if (ruleName.search(/color/) !== -1){var val = $(node).css(ruleName);if (val && (val === ruleValue || this.utils.rgb2hex(val) === ruleValue)){count++;}}else if ($(node).css(ruleName) === ruleValue){count++;}}if (count === rules.length){return 1;}}else if (nodeAttrValue === value){return 1;}}return 0;},isConvertable: function(node, nodeTag, tag, attr){if (nodeTag === tag){if (attr){var count = 0;for (var key in attr){count += this.inline.isConvertableAttr(node, key, attr[key]);}if (count === Object.keys(attr).length){return true;}}else{return true;}}return false;},setNodesStriked: function(nodes, tag, attr){for (var i = 0; i < nodes.length; i++){var nodeTag = (nodes[i].tagName) ? nodes[i].tagName.toLowerCase() : undefined;var parent = nodes[i].parentNode;var parentTag = (parent && parent.tagName) ? parent.tagName.toLowerCase() : undefined;var convertable = this.inline.isConvertable(parent, parentTag, tag, attr);if (convertable){var $el = $(parent).replaceWith(function(){return $('<strike>').append($(this).contents());});$el.attr('data-redactor-inline-converted');}var convertable = this.inline.isConvertable(nodes[i], nodeTag, tag, attr);if (convertable){var $el = $(nodes[i]).replaceWith(function(){return $('<strike>').append($(this).contents());});}}},format: function(tag, attr, value, type){if (typeof attr !== 'undefined' && typeof attr !== 'object'){var obj = {};obj[attr] = value;attr = obj;}tag = tag.toLowerCase();if (this.utils.isCurrentOrParent(['PRE', 'CODE'])){return;}var tags = ['b', 'bold', 'i', 'italic', 'underline', 'strikethrough', 'deleted', 'superscript', 'subscript'];var replaced = ['strong', 'strong', 'em', 'em', 'u', 'del', 'del', 'sup', 'sub'];for (var i = 0; i < tags.length; i++){if (tag === tags[i]){tag = replaced[i];}}this.placeholder.hide();this.buffer.set();if (this.utils.isCollapsed()){this.inline.formatCollapsed(tag, attr, value, type);}else{this.inline.formatUncollapsed(tag, attr, value, type);}},formatUncollapsed: function(tag, attr, value, type){this.selection.save();var nodes = this.inline.getClearedNodes();this.inline.setNodesStriked(nodes, tag, attr);this.selection.restore();document.execCommand('strikethrough');this.selection.saveInstant();var self = this;this.core.editor().find('strike').each(function(){var $el = self.utils.replaceToTag(this, tag);for (var key in attr){self.inline.setAttr($el, key, attr[key], type);}var $inside = $el.find(tag);if ($inside.length !== 0){for (var key in attr){self.inline.removeSpecificAttr($inside, key, attr[key]);}}var $parent = $el.parent();if ($parent.html() == $el[0].outerHTML){for (var key in attr){self.inline.removeSpecificAttr($parent, key, attr[key]);}}if (self.detect.isFirefox()){self.core.editor().find(tag + ':empty').remove();}$el.attr('data-redactor-style-cache', $el.attr('style'));});this.selection.restoreInstant();},formatCollapsed: function(tag, attr, value, type){var inline = this.selection.inline();if (inline){var currentTag = inline.tagName.toLowerCase();if (currentTag === tag){if (this.utils.isEmpty(inline.innerHTML)){this.caret.after(inline);$(inline).remove();}else{var $first = this.inline.insertBreakpoint(inline, currentTag);this.caret.after($first);}}else if ($(inline).closest(tag).length === 0){this.inline.insertInline(tag, attr, value, type);}else{this.caret.start(inline);}}else{this.inline.insertInline(tag, attr, value, type);}},insertBreakpoint: function(inline, currentTag){var breakpoint = document.createElement('span');breakpoint.id = 'redactor-inline-breakpoint';breakpoint = this.insert.node(breakpoint);var end = this.utils.isEndOfElement(inline);var code = this.utils.getOuterHtml(inline);var endTag = (end) ? '' : '<' + currentTag + '>';code = code.replace(/<span\sid="redactor-inline-breakpoint">​<\/span>/i, '</' + currentTag + '>' + endTag);var $code = $(code);$(inline).replaceWith($code);if (endTag !== ''){this.utils.cloneAttributes(inline, $code.last());}return $code.first();},insertInline: function(tag, attr, value, type){var node = document.createElement(tag);node = this.inline.setAttr(node, attr, value, type);this.insert.node(node);this.caret.start(node);},setAttr: function(inline, attr, value, type){if (typeof attr === 'undefined'){return inline;}var func = (typeof type === 'undefined') ? 'toggle' : type;if (attr === 'class'){inline = this.inline[func + 'Class'](value, inline);}else{if (func === 'remove'){inline = this.inline[func + 'Attr'](attr, inline);}else if (func === 'removeAll'){inline = this.inline[func + 'Attr'](inline);}else{inline = this.inline[func + 'Attr'](attr, value, inline);if (attr === 'style' && inline[0].tagName === 'SPAN'){$(inline).attr('data-redactor-span', true);}}}return inline;},getInlines: function(inline){return (typeof inline === 'undefined') ? this.selection.inlines() : inline;},update: function(tag, attr, value, type){var inlines = this.selection.inlines();var result = [];var self = this;$.each(inlines, function(i,s){if ($.isArray(tag)){if ($.inArray(s.tagName.toLowerCase(), tag) === -1){return;}}else{if (tag !== '*' && s.tagName.toLowerCase() !== tag){return;}}result.push(self.inline.setAttr(s, attr, value, type));});return result;},replaceClass: function(value, inline){return $(this.inline.getInlines(inline)).removeAttr('class').addClass(value)[0];},toggleClass: function(value, inline){return $(this.inline.getInlines(inline)).toggleClass(value)[0];},addClass: function(value, inline){return $(this.inline.getInlines(inline)).addClass(value)[0];},removeClass: function(value, inline){return $(this.inline.getInlines(inline)).removeClass(value)[0];},removeAllClass: function(inline){return $(this.inline.getInlines(inline)).removeAttr('class')[0];},replaceAttr: function(inline, attr, value){inline = this.inline.removeAttr(attr, this.inline.getInlines(inline));return $(inline).attr(attr, value)[0];},toggleAttr: function(attr, value, inline){inline = this.inline.getInlines(inline);var self = this;var returned = [];$.each(inline, function(i,s){var $el = $(s);if ($el.attr(attr)){returned.push(self.inline.removeAttr(attr, s));}else{returned.push(self.inline.addAttr(attr, value, s));}});return returned;},addAttr: function(attr, value, inline){return $(this.inline.getInlines(inline)).attr(attr, value)[0];},removeSpecificAttr: function(inline, key, value){if (key === 'style'){var arr = value.split(':');var name = arr[0].trim();$(inline).css(name, '');this.utils.removeEmptyAttr(inline, 'style');}else{$(inline).removeAttr(key)[0];}},removeAttr: function(attr, inline){return $(this.inline.getInlines(inline)).removeAttr(attr)[0];},removeAllAttr: function(inline){inline = this.inline.getInlines(inline);var returned = [];$.each(inline, function(i, s){if (typeof s.attributes === 'undefined'){returned.push(s);}var $el = $(s);var len = s.attributes.length;for (var z = 0; z < len; z++){$el.removeAttr(s.attributes[z].name);}returned.push($el[0]);});return returned;},removeFormat: function(){this.selection.save();var nodes = this.inline.getClearedNodes();for (var i = 0; i < nodes.length; i++){if (nodes[i].nodeType === 1){$(nodes[i]).replaceWith(function(){return $(this).contents();});}}this.selection.restore();},removeStyleRule: function(name){this.buffer.set();var parent = this.selection.parent();var nodes = this.selection.inlines();this.selection.save();if (parent && parent.tagName === 'SPAN'){var $s = $(parent);$s.css(name, '');$s.removeAttr('data-redactor-span');this.utils.removeEmptyAttr($s, 'style');if ($s[0].attributes.length === 0){$s.replaceWith($s.contents());}}$.each(nodes, $.proxy(function(i,s){var $s = $(s);if ($.inArray(s.tagName.toLowerCase(), this.opts.inlineTags) != -1 && !$s.hasClass('redactor-selection-marker')){$s.css(name, '');this.utils.removeEmptyAttr($s, 'style');if ($s[0].attributes.length === 0){$s.replaceWith($s.contents());}}}, this));this.selection.restore();}};},insert: function(){return {set: function(html){this.placeholder.hide();this.code.set(html);this.focus.end();this.placeholder.enable();},html: function(html, data){this.placeholder.hide();this.core.editor().focus();var block = this.selection.block();var inline = this.selection.inline();if (typeof data === 'undefined'){data = this.clean.getCurrentType(html, true);html = this.clean.onPaste(html, data, true);}html = $.parseHTML(html);var sel = this.selection.get();var range = this.selection.range(sel);range.deleteContents();this.selection.update(sel, range);if (data.lists){var $list = $(html);if ($list.length !== 0 && ($list[0].tagName === 'UL' || $list[0].tagName === 'OL')){this.insert.appendLists(block, $list);return;}}if (data.blocks && block){if (this.utils.isSelectAll()){this.core.editor().html(html);this.focus.end();}else{var breaked = this.utils.breakBlockTag();if (breaked === false){this.insert.placeHtml(html);}else{var $last = $(html).children().last();$last.append(this.marker.get());if (breaked.type === 'start'){breaked.$block.before(html);}else{breaked.$block.after(html);}this.selection.restore();this.core.editor().find('p').each(function(){if ($.trim(this.innerHTML) === ''){$(this).remove();}});}}}else{if (inline){var $div = $("<div/>").html(html);$div.find(inline.tagName.toLowerCase()).each(function(){$(this).contents().unwrap();});html = $div.html();}if (this.utils.isSelectAll()){var $node = $(this.opts.emptyHtml);this.core.editor().html('').append($node);$node.html(html);this.caret.end($node);}else{this.insert.placeHtml(html);}}this.utils.disableSelectAll();this.linkify.format();if (data.pre){this.clean.cleanPre();}},text: function(text){text = text.toString();text = $.trim(text);var tmp = document.createElement('div');tmp.innerHTML = text;text = tmp.textContent || tmp.innerText;if (typeof text === 'undefined'){return;}this.placeholder.hide();this.core.editor().focus();var blocks = this.selection.blocks();text = text.replace(/\n/g, ' ');if (this.utils.isSelectAll()){var $node = $(this.opts.emptyHtml);this.core.editor().html('').append($node);$node.html(text);this.caret.end($node);}else{var sel = this.selection.get();var node = document.createTextNode(text);if (sel.getRangeAt && sel.rangeCount){var range = sel.getRangeAt(0);range.deleteContents();range.insertNode(node);range.setStartAfter(node);range.collapse(true);this.selection.update(sel, range);}if (blocks.length > 1){$(node).wrap('<p>');this.caret.after(node);}}this.utils.disableSelectAll();this.linkify.format();this.clean.normalizeCurrentHeading();},raw: function(html){this.placeholder.hide();this.core.editor().focus();var sel = this.selection.get();var range = this.selection.range(sel);range.deleteContents();var el = document.createElement("div");el.innerHTML = html;var frag = document.createDocumentFragment(), node, lastNode;while ((node = el.firstChild)){lastNode = frag.appendChild(node);}range.insertNode(frag);if (lastNode){range = range.cloneRange();range.setStartAfter(lastNode);range.collapse(true);sel.removeAllRanges();sel.addRange(range);}},node: function(node, deleteContent){this.placeholder.hide();if (typeof this.start !== 'undefined'){this.core.editor().focus();}node = node[0] || node;var block = this.selection.block();var gap = this.utils.isBlockTag(node.tagName);var result = true;if (this.utils.isSelectAll()){if (gap){this.core.editor().html(node);}else{this.core.editor().html($('<p>').html(node));}this.code.sync();}else if (gap && block){var breaked = this.utils.breakBlockTag();if (breaked === false){this.insert.placeNode(node, deleteContent);}else{if (breaked.type === 'start'){breaked.$block.before(node);}else{breaked.$block.after(node);}this.core.editor().find('p:empty').remove();}}else{result = this.insert.placeNode(node, deleteContent);}this.utils.disableSelectAll();if (result){this.caret.end(node);}return node;},appendLists: function(block, $list){var $block = $(block);var last;var isEmpty = this.utils.isEmpty(block.innerHTML);if (isEmpty || this.utils.isEndOfElement(block)){last = $block;$list.find('li').each(function(){last.after(this);last = $(this);});if (isEmpty){$block.remove();}}else if (this.utils.isStartOfElement(block)){$list.find('li').each(function(){$block.before(this);last = $(this);});}else{var endOfNode = this.selection.extractEndOfNode(block);$block.after($('<li>').append(endOfNode));$block.append($list);last = $list;}this.marker.remove();if (last){this.caret.end(last);}this.linkify.format();},placeHtml: function(html){var marker = document.createElement('span');marker.id = 'redactor-insert-marker';marker = this.insert.node(marker);$(marker).before(html);this.selection.restore();this.caret.after(marker);$(marker).remove();},placeNode: function(node, deleteContent){var sel = this.selection.get();var range = this.selection.range(sel);if (range == null){return false;}if (deleteContent !== false){range.deleteContents();}range.insertNode(node);range.collapse(false);this.selection.update(sel, range);},nodeToPoint: function(e, node){this.placeholder.hide();node = node[0] || node;if (this.utils.isEmpty()){node = (this.utils.isBlock(node)) ? node : $('<p />').append(node);this.core.editor().html(node);return node;}var range;var x = e.clientX, y = e.clientY;if (document.caretPositionFromPoint){var pos = document.caretPositionFromPoint(x, y);var sel = document.getSelection();range = sel.getRangeAt(0);range.setStart(pos.offsetNode, pos.offset);range.collapse(true);range.insertNode(node);}else if (document.caretRangeFromPoint){range = document.caretRangeFromPoint(x, y);range.insertNode(node);}else if (typeof document.body.createTextRange !== "undefined"){range = document.body.createTextRange();range.moveToPoint(x, y);var endRange = range.duplicate();endRange.moveToPoint(x, y);range.setEndPoint("EndToEnd", endRange);range.select();}return node;},nodeToCaretPositionFromPoint: function(e, node){this.insert.nodeToPoint(e, node);},marker: function(){this.marker.insert();}};},keydown: function(){return {init: function(e){if (this.rtePaste){return;}var key = e.which;var arrow = (key >= 37 && key <= 40);this.keydown.ctrl = e.ctrlKey || e.metaKey;this.keydown.parent = this.selection.parent();this.keydown.current = this.selection.current();this.keydown.block = this.selection.block();this.keydown.pre = this.utils.isTag(this.keydown.current, 'pre');this.keydown.blockquote = this.utils.isTag(this.keydown.current, 'blockquote');this.keydown.figcaption = this.utils.isTag(this.keydown.current, 'figcaption');this.keydown.figure = this.utils.isTag(this.keydown.current, 'figure');var keydownStop = this.core.callback('keydown', e);if (keydownStop === false){e.preventDefault();return false;}this.shortcuts.init(e, key);this.keydown.checkEvents(arrow, key);this.keydown.setupBuffer(e, key);if (this.utils.isSelectAll() && ( key === this.keyCode.ENTER || key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE)){e.preventDefault();this.code.set(this.opts.emptyHtml);return;}this.keydown.addArrowsEvent(arrow);this.keydown.setupSelectAll(e, key);if (!this.opts.enterKey && key === this.keyCode.ENTER){e.preventDefault();var sel = this.selection.get();var range = this.selection.range(sel);if (!range.collapsed){range.deleteContents();}return;}if (this.opts.enterKey && key === this.keyCode.DOWN){this.keydown.onArrowDown();}if (this.opts.enterKey && key === this.keyCode.UP){this.keydown.onArrowUp();}if ((this.opts.type === 'textarea' || this.opts.type === 'div') && this.keydown.current && this.keydown.current.nodeType === 3 && $(this.keydown.parent).hasClass('redactor-in')){this.keydown.wrapToParagraph();}if (!this.keyup.lastShiftKey && key === this.keyCode.SPACE && (e.ctrlKey || e.shiftKey)){e.preventDefault();return this.keydown.onShiftSpace();}if (key === this.keyCode.ENTER && (e.ctrlKey || e.shiftKey)){e.preventDefault();return this.keydown.onShiftEnter(e);}if (key === this.keyCode.ENTER && !e.shiftKey && !e.ctrlKey && !e.metaKey){return this.keydown.onEnter(e);}if (key === this.keyCode.TAB || e.metaKey && key === 221 || e.metaKey && key === 219){return this.keydown.onTab(e, key);}if (this.detect.isFirefox() && key === this.keyCode.BACKSPACE && this.keydown.block && this.keydown.block.tagName === 'P' && this.utils.isStartOfElement(this.keydown.block)){var $prev = $(this.keydown.block).prev();if ($prev.length !== 0){e.preventDefault();$prev.append(this.marker.get());$prev.append($(this.keydown.block).html());$(this.keydown.block).remove();this.selection.restore();return;}}if (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE){if (this.observe.image && typeof this.observe.image !== 'undefined' && $('#redactor-image-box').length !== 0){e.preventDefault();var $prev = this.observe.image.closest('figure, p').prev();this.image.remove(false);this.observe.image = false;if ($prev && $prev.length !== 0){this.caret.end($prev);}else{this.core.editor().focus();}return;}this.keydown.onBackspaceAndDeleteBefore();}if (key === this.keyCode.DELETE){var $next = $(this.keydown.block).next();if (this.utils.isEndOfElement(this.keydown.block) && $next.length !== 0 && $next[0].tagName === 'FIGURE'){$next.remove();return false;}var tagLi = (this.keydown.block && this.keydown.block.tagName === 'LI') ? this.keydown.block : false;if (tagLi){var $list = $(this.keydown.block).parents('ul, ol').last();var $nextList = $list.next();if (this.utils.isRedactorParent($list) && this.utils.isEndOfElement($list) && $nextList.length !== 0&& ($nextList[0].tagName === 'UL' || $nextList[0].tagName === 'OL')){e.preventDefault();$list.append($nextList.contents());$nextList.remove();return false;}}if (this.utils.isEndOfElement(this.keydown.block) && $next.length !== 0 && $next[0].tagName === 'PRE'){$(this.keydown.block).append($next.text());$next.remove();return false;}}if (key === this.keyCode.DELETE && $('#redactor-image-box').length !== 0){this.image.remove();}if (key === this.keyCode.BACKSPACE){if (this.detect.isFirefox()){this.line.removeOnBackspace(e);}if (this.list.combineAfterAndBefore(this.keydown.block)){e.preventDefault();return;}var block = this.selection.block();if (block && block.tagName === 'LI' && this.utils.isCollapsed() && this.utils.isStartOfElement()){this.indent.decrease();e.preventDefault();return;}this.keydown.removeInvisibleSpace();this.keydown.removeEmptyListInTable(e);}if (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE){this.keydown.onBackspaceAndDeleteAfter(e);}},onShiftSpace: function(){this.buffer.set();this.insert.raw('&nbsp;');return false;},onShiftEnter: function(e){this.buffer.set();return (this.keydown.pre) ? this.keydown.insertNewLine(e) : this.insert.raw('<br>');},onBackspaceAndDeleteBefore: function(){this.utils.saveScroll();},onBackspaceAndDeleteAfter: function(e){setTimeout($.proxy(function(){this.code.syncFire = false;this.keydown.removeEmptyLists();this.core.editor().find('*[style]').not('img, figure, #redactor-image-box, #redactor-image-editter, [data-redactor-span]').removeAttr('style');this.keydown.formatEmpty(e);this.code.syncFire = true;}, this), 1);},onEnter: function(e){var stop = this.core.callback('enter', e);if (stop === false){e.preventDefault();return false;}if (this.keydown.blockquote && this.keydown.exitFromBlockquote(e) === true){return false;}if (this.keydown.pre){return this.keydown.insertNewLine(e);}else if (this.keydown.blockquote || this.keydown.figcaption){return this.keydown.insertBreakLine(e);}else if (this.keydown.figure){setTimeout($.proxy(function(){this.keydown.replaceToParagraph('FIGURE');}, this), 1);}else if (this.keydown.block){setTimeout($.proxy(function(){this.keydown.replaceToParagraph('DIV');}, this), 1);if (this.keydown.block.tagName === 'LI'){var current = this.selection.current();var $parent = $(current).closest('li', this.$editor[0]);var $list = $parent.parents('ul,ol', this.$editor[0]).last();if ($parent.length !== 0 && this.utils.isEmpty($parent.html()) && $list.next().length === 0 && this.utils.isEmpty($list.find("li").last().html())){$list.find("li").last().remove();var node = $(this.opts.emptyHtml);$list.after(node);this.caret.start(node);return false;}}}else if (!this.keydown.block){return this.keydown.insertParagraph(e);}if (this.detect.isFirefox() && this.utils.isInline(this.keydown.parent)){this.keydown.insertBreakLine(e);return;}setTimeout($.proxy(function(){var inline = this.selection.inline();if (inline && this.utils.isEmpty(inline.innerHTML)){var parent = this.selection.block();$(inline).remove();var range = document.createRange();range.setStart(parent, 0);var textNode = document.createTextNode('\u200B');range.insertNode(textNode);range.setStartAfter(textNode);range.collapse(true);var sel = window.getSelection();sel.removeAllRanges();sel.addRange(range);}}, this), 1);},checkEvents: function(arrow, key){if (!arrow && (this.core.getEvent() === 'click' || this.core.getEvent() === 'arrow')){this.core.addEvent(false);if (this.keydown.checkKeyEvents(key)){this.buffer.set();}}},checkKeyEvents: function(key){var k = this.keyCode;var keys = [k.BACKSPACE, k.DELETE, k.ENTER, k.ESC, k.TAB, k.CTRL, k.META, k.ALT, k.SHIFT];return ($.inArray(key, keys) === -1) ? true : false;},addArrowsEvent: function(arrow){if (!arrow){return;}if ((this.core.getEvent() === 'click' || this.core.getEvent() === 'arrow')){this.core.addEvent(false);return;}this.core.addEvent('arrow');},setupBuffer: function(e, key){if (this.keydown.ctrl && key === 90 && !e.shiftKey && !e.altKey && this.opts.buffer.length) {e.preventDefault();this.buffer.undo();return;}else if (this.keydown.ctrl && key === 90 && e.shiftKey && !e.altKey && this.opts.rebuffer.length !== 0){e.preventDefault();this.buffer.redo();return;}else if (!this.keydown.ctrl){if (key === this.keyCode.SPACE || key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE || (key === this.keyCode.ENTER && !e.ctrlKey && !e.shiftKey)){this.buffer.set();}}},exitFromBlockquote: function(e){if (!this.utils.isEndOfElement(this.keydown.blockquote)){return;}var tmp = this.clean.removeSpacesHard($(this.keydown.blockquote).html());if (tmp.search(/(<br\s?\/?>){1}$/i) !== -1){e.preventDefault();var $last = $(this.keydown.blockquote).children().last();$last.filter('br').remove();$(this.keydown.blockquote).children().last().filter('span').remove();var node = $(this.opts.emptyHtml);$(this.keydown.blockquote).after(node);this.caret.start(node);return true;}return;},onArrowDown: function(){var tags = [this.keydown.blockquote, this.keydown.pre, this.keydown.figcaption];for (var i = 0; i < tags.length; i++){if (tags[i]){this.keydown.insertAfterLastElement(tags[i]);return false;}}},onArrowUp: function(){var tags = [this.keydown.blockquote, this.keydown.pre, this.keydown.figcaption];for (var i = 0; i < tags.length; i++){if (tags[i]){this.keydown.insertBeforeFirstElement(tags[i]);return false;}}},insertAfterLastElement: function(element){if (!this.utils.isEndOfElement(element)){return;}var last = this.core.editor().contents().last();var $next = (element.tagName === 'FIGCAPTION') ? $(this.keydown.block).parent().next() : $(this.keydown.block).next();if ($next.length !== 0){return;}else if (last.length === 0 && last[0] !== element){this.caret.start(last);return;}else{var node = $(this.opts.emptyHtml);if (element.tagName === 'FIGCAPTION'){$(element).parent().after(node);}else{$(element).after(node);}this.caret.start(node);}},insertBeforeFirstElement: function(element){if (!this.utils.isStartOfElement()){return;}if (this.core.editor().contents().length > 1 && this.core.editor().contents().first()[0] !== element){return;}var node = $(this.opts.emptyHtml);$(element).before(node);this.caret.start(node);},onTab: function(e, key){if (!this.opts.tabKey){return true;}var isList = (this.keydown.block && this.keydown.block.tagName === 'LI');if (this.utils.isEmpty(this.code.get()) || (!isList && !this.keydown.pre && this.opts.tabAsSpaces === false)){return true;}e.preventDefault();this.buffer.set();var isListStart = (isList && this.utils.isStartOfElement(this.keydown.block));var node;if (this.keydown.pre && !e.shiftKey){node = (this.opts.preSpaces) ? document.createTextNode(Array(this.opts.preSpaces + 1).join('\u00a0')) : document.createTextNode('\t');this.insert.node(node);}else if (this.opts.tabAsSpaces !== false && !isListStart){node = document.createTextNode(Array(this.opts.tabAsSpaces + 1).join('\u00a0'));this.insert.node(node);}else{if (e.metaKey && key === 219){this.indent.decrease();}else if (e.metaKey && key === 221){this.indent.increase();}else if (!e.shiftKey){this.indent.increase();}else{this.indent.decrease();}}return false;},setupSelectAll: function(e, key){if (this.keydown.ctrl && key === 65){this.utils.enableSelectAll();}else if (key !== this.keyCode.LEFT_WIN && !this.keydown.ctrl){this.utils.disableSelectAll();}},insertNewLine: function(e){e.preventDefault();var node = document.createTextNode('\n');var sel = this.selection.get();var range = this.selection.range(sel);range.deleteContents();range.insertNode(node);this.caret.after(node);return false;},insertParagraph: function(e){e.preventDefault();var p = document.createElement('p');p.innerHTML = this.opts.invisibleSpace;var sel = this.selection.get();var range = this.selection.range(sel);range.deleteContents();range.insertNode(p);this.caret.start(p);return false;},insertBreakLine: function(e){return this.keydown.insertBreakLineProcessing(e);},insertDblBreakLine: function(e){return this.keydown.insertBreakLineProcessing(e, true);},insertBreakLineProcessing: function(e, dbl){e.stopPropagation();var br1 = document.createElement('br');this.insert.node(br1);if (dbl === true){var br2 = document.createElement('br');this.insert.node(br2);this.caret.after(br2);}else{this.caret.after(br1);}return false;},wrapToParagraph: function(){var $current = $(this.keydown.current);varnode = $('<p>').append($current.clone());$current.replaceWith(node);var next = $(node).next();if (typeof(next[0]) !== 'undefined' && next[0].tagName === 'BR'){next.remove();}this.caret.end(node);},replaceToParagraph: function(tag){var blockElem = this.selection.block();var $prev = $(blockElem).prev();var blockHtml = blockElem.innerHTML.replace(/<br\s?\/?>/gi, '');if (blockElem.tagName === tag && this.utils.isEmpty(blockHtml) && !$(blockElem).hasClass('redactor-in')){var p = document.createElement('p');$(blockElem).replaceWith(p);this.keydown.setCaretToParagraph(p);return false;}else if (blockElem.tagName === 'P'){$(blockElem).removeAttr('class').removeAttr('style');if (this.detect.isIe() && this.utils.isEmpty(blockHtml) && this.utils.isInline(this.keydown.parent)){$(blockElem).on('input', $.proxy(function(){var parent = this.selection.parent();if (this.utils.isInline(parent)){var html = $(parent).html();$(blockElem).html(html);this.caret.end(blockElem);}$(blockElem).off('keyup');}, this));}return false;}else if ($prev.hasClass(this.opts.videoContainerClass)){$prev.removeAttr('class');var p = document.createElement('p');$prev.replaceWith(p);this.keydown.setCaretToParagraph(p);return false;}},setCaretToParagraph: function(p){var range = document.createRange();range.setStart(p, 0);var textNode = document.createTextNode('\u200B');range.insertNode(textNode);range.setStartAfter(textNode);range.collapse(true);var sel = window.getSelection();sel.removeAllRanges();sel.addRange(range);},removeInvisibleSpace: function(){var $current = $(this.keydown.current);if ($current.text().search(/^\u200B$/g) === 0){$current.remove();}},removeEmptyListInTable: function(e){var $current = $(this.keydown.current);var $parent = $(this.keydown.parent);var td = $current.closest('td', this.$editor[0]);if (td.length !== 0 && $current.closest('li', this.$editor[0]) && $parent.children('li').length === 1){if (!this.utils.isEmpty($current.text())){return;}e.preventDefault();$current.remove();$parent.remove();this.caret.start(td);}},removeEmptyLists: function(){var removeIt = function(){var html = $.trim(this.innerHTML).replace(/\/t\/n/g, '');if (html === ''){$(this).remove();}};this.core.editor().find('li').each(removeIt);this.core.editor().find('ul, ol').each(removeIt);},formatEmpty: function(e){var html = $.trim(this.core.editor().html());if (!this.utils.isEmpty(html)){return;}e.preventDefault();if (this.opts.type === 'inline' || this.opts.type === 'pre'){this.core.editor().html(this.marker.html());this.selection.restore();}else{this.core.editor().html(this.opts.emptyHtml);this.focus.start();}return false;}};},keyup: function(){return {init: function(e){if (this.rtePaste){return;}var key = e.which;this.keyup.block = this.selection.block();this.keyup.current = this.selection.current();this.keyup.parent = this.selection.parent();this.keyup.lastShiftKey = e.shiftKey;var stop = this.core.callback('keyup', e);if (stop === false){e.preventDefault();return false;}if (key === this.keyCode.ENTER){if (this.keyup.block && this.keyup.block.tagName === 'FIGURE'){var $prev = $(this.keyup.block).prev();if ($prev.length !== 0 && $prev[0].tagName === 'FIGURE'){var $newTag = this.utils.replaceToTag($prev, 'p');this.caret.start($newTag);return;}}}if (key === this.keyCode.BACKSPACE || key === this.keyCode.DELETE){if (this.utils.isSelectAll()){this.focus.start();return;}if (this.keyup.block && this.keydown.block && this.keyup.block.tagName === 'FIGURE' && this.utils.isStartOfElement(this.keydown.block)){e.preventDefault();this.selection.save();$(this.keyup.block).find('figcaption').remove();$(this.keyup.block).find('img').first().remove();this.utils.replaceToTag(this.keyup.block, 'p');var $marker = this.marker.find();$('html, body').animate({ scrollTop: $marker.position().top + 20 }, 500);this.selection.restore();return;}if (this.keyup.block && this.keyup.block.tagName === 'P'){var isContainImage = $(this.keyup.block).find('img').length;var text = $(this.keyup.block).text().replace(/\u200B/g, '');if (text === '' && isContainImage !== 0){this.utils.replaceToTag(this.keyup.block, 'figure');}}if (this.keyup.block && this.keyup.block.tagName === 'FIGURE' && $(this.keyup.block).find('img').length === 0){this.selection.save();this.utils.replaceToTag(this.keyup.block, 'p');this.selection.restore();}}if (this.linkify.isKey(key)){this.linkify.format();}}};},lang: function(){return {load: function(){this.opts.curLang = this.opts.langs[this.opts.lang];},get: function(name){return (typeof this.opts.curLang[name] !== 'undefined') ? this.opts.curLang[name] : '';}};},line: function(){return {insert: function(){this.buffer.set();this.insert.html(this.line.getLineHtml());var $hr = this.core.editor().find('#redactor-hr-tmp-id');$hr.removeAttr('id');this.core.callback('insertedLine', $hr);return $hr;},getLineHtml: function(){var html = '<hr id="redactor-hr-tmp-id" />';if (!this.detect.isFirefox() && this.utils.isEmpty()){html += '<p>' + this.opts.emptyHtml + '</p>';}return html;},removeOnBackspace: function(e){if (!this.utils.isCollapsed()){return;}var $block = $(this.selection.block());if ($block.length === 0 || !this.utils.isStartOfElement($block)){return;}var $prev = $block.prev();if ($prev && $prev.length !== 0 && $prev[0].tagName === 'HR'){e.preventDefault();$prev.remove();}}};},link: function(){return {get: function(){return $(this.selection.inlines('a'));},is: function(){var nodes = this.selection.nodes() ;var $link = $(this.selection.current()).closest('a', this.core.editor()[0]);return ($link.length === 0 || nodes.length > 1) ? false : $link;},unlink: function(e){if (typeof e !== 'undefined' && e.preventDefault){e.preventDefault();}this.buffer.set();var links = this.selection.inlines('a');if (links.length === 0){return;}var $links = this.link.replaceLinksToText(links);this.observe.closeAllTooltip();this.core.callback('deletedLink', $links);},insert: function(link, cleaned){var $el = this.link.is();if (cleaned !== true){link = this.link.buildLinkFromObject($el, link);if (link === false){return false;}}this.buffer.set();link = this.core.callback('beforeInsertingLink', link);if ($el === false){$el = $('<a />');$el = this.link.update($el, link);$el = $(this.insert.node($el));var $parent = $el.parent();if (this.utils.isRedactorParent($parent) === false){$el.wrap('<p>');}if ($parent.hasClass('redactor-unlink')){$parent.replaceWith(function(){return $(this).contents();});}this.caret.after($el);this.core.callback('insertedLink', $el);}else{$el = this.link.update($el, link);this.caret.after($el);}},update: function($el, link){$el.text(link.text);$el.attr('href', link.url);this.link.target($el, link.target);return $el;},target: function($el, target){return (target) ? $el.attr('target', '_blank') : $el.removeAttr('target');},show: function(e){if (typeof e !== 'undefined' && e.preventDefault){e.preventDefault();}this.observe.closeAllTooltip();var $el = this.link.is();this.link.buildModal($el);var link = this.link.buildLinkFromElement($el);link.url = this.link.removeSelfHostFromUrl(link.url);if (this.opts.linkNewTab && !$el){link.target = true;}this.link.setModalValues(link);this.modal.show();if (this.detect.isDesktop()){$('#redactor-link-url').focus();}},setModalValues: function(link){$('#redactor-link-blank').prop('checked', link.target);$('#redactor-link-url').val(link.url);$('#redactor-link-url-text').val(link.text);},buildModal: function($el){this.modal.load('link', this.lang.get(($el === false) ? 'link-insert' : 'link-edit'), 600);var $btn = this.modal.getActionButton();$btn.text(this.lang.get(($el === false) ? 'insert' : 'save')).on('click', $.proxy(this.link.callback, this));},callback: function(){var link = this.link.buildLinkFromModal();if (link === false){return false;}this.modal.close();this.link.insert(link, true);},cleanUrl: function(url){return (typeof url === 'undefined') ? '' : $.trim(url.replace(/[^\W\w\D\d+&\'@#/%?=~_|!:,.;\(\)]/gi, ''));},cleanText: function(text){return (typeof text === 'undefined') ? '' :$.trim(text.replace(/(<([^>]+)>)/gi, ''));},getText: function(link){return (link.text === '' && link.url !== '') ? this.link.truncateUrl(link.url.replace(/<|>/g, '')) : link.text;},isUrl: function(url){var pattern = '((xn--)?[\\W\\w\\D\\d]+(-[\\W\\w\\D\\d]+)*\\.)+[\\W\\w]{2,}';var re1 = new RegExp('^(http|ftp|https)://' + pattern, 'i');var re2 = new RegExp('^' + pattern, 'i');var re3 = new RegExp('\.(html|php)$', 'i');var re4 = new RegExp('^/', 'i');var re5 = new RegExp('^tel:(.*?)', 'i');if (url.search(re1) === -1 && url.search(re2) !== -1 && url.search(re3) === -1 && url.substring(0, 1) !== '/'){url = 'http://' + url;}if (url.search(re1) !== -1 || url.search(re3) !== -1 || url.search(re4) !== -1 || url.search(re5) !== -1){return url;}return false;},isMailto: function(url){return (url.search('@') !== -1 && /(http|ftp|https):\/\//i.test(url) === false);},isEmpty: function(link){return (link.url === '' || (link.text === '' && link.url === ''));},truncateUrl: function(url){return (url.length > this.opts.linkSize) ? url.substring(0, this.opts.linkSize) + '...' : url;},parse: function(link){if (this.link.isMailto(link.url)){link.url = 'mailto:' + link.url.replace('mailto:', '');}else if (link.url.search('#') !== 0){link.url = this.link.isUrl(link.url);}return (this.link.isEmpty(link) || link.url === false) ? false : link;},buildLinkFromModal: function(){var link = {};link.url = this.link.cleanUrl($('#redactor-link-url').val());link.text = this.link.cleanText($('#redactor-link-url-text').val());link.text = this.link.getText(link);link.target = ($('#redactor-link-blank').prop('checked')) ? true : false;return this.link.parse(link);},buildLinkFromObject: function($el, link){link.url = this.link.cleanUrl(link.url);link.text = (typeof link.text === 'undefined' && this.selection.is()) ? this.selection.text() : this.link.cleanText(link.text);link.text = this.link.getText(link);link.target = ($el === false) ? link.target : this.link.buildTarget($el);return this.link.parse(link);},buildLinkFromElement: function($el){var link = {url: '',text: (this.selection.is()) ? this.selection.text() : '',target: false};if ($el !== false){link.url = $el.attr('href');link.text = $el.text();link.target = this.link.buildTarget($el);}return link;},buildTarget: function($el){return (typeof $el.attr('target') !== 'undefined' && $el.attr('target') === '_blank') ? true : false;},removeSelfHostFromUrl: function(url){var href = self.location.href.replace('#', '').replace(/\/$/i, '');return url.replace(/^\/\#/, '#').replace(href, '').replace('mailto:', '');},replaceLinksToText: function(links){var $first;var $links = $.each(links, function(i,s){var $el = $(s);var $unlinked = $('<span class="redactor-unlink" />').append($el.contents());$el.replaceWith($unlinked);if (i === 0){$first = $unlinked;}return $el;});if (links.length === 1 && this.selection.isCollapsed()){this.caret.after($first);}return $links;}};},linkify: function(){return {isKey: function(key){return key === this.keyCode.ENTER || key === this.keyCode.SPACE;},isLink: function(node){return (node.nodeValue.match(this.opts.regexps.linkyoutube) || node.nodeValue.match(this.opts.regexps.linkvimeo) || node.nodeValue.match(this.opts.regexps.linkimage) || node.nodeValue.match(this.opts.regexps.url));},isFiltered: function(i, node){return node.nodeType === 3 && $.trim(node.nodeValue) !== "" && !$(node).parent().is("pre") && (this.linkify.isLink(node));},handler: function(i, node){var $el = $(node);var text = $el.text();var html = text;if (html.match(this.opts.regexps.linkyoutube) || html.match(this.opts.regexps.linkvimeo)){html = this.linkify.convertVideoLinks(html);}else if (html.match(this.opts.regexps.linkimage)){html = this.linkify.convertImages(html);}else{html = this.linkify.convertLinks(html);}$el.before(text.replace(text, html)).remove();},format: function(){if (!this.opts.linkify || this.utils.isCurrentOrParent('pre')){return;}this.core.editor().find(":not(iframe,img,a,pre,code,.redactor-unlink)").addBack().contents().filter($.proxy(this.linkify.isFiltered, this)).each($.proxy(this.linkify.handler, this));var $objects = this.core.editor().find('.redactor-linkify-object').each($.proxy(function(i,s){var $el = $(s);$el.removeClass('redactor-linkify-object');if ($el.attr('class') === ''){$el.removeAttr('class');}if (s.tagName === 'DIV') {this.linkify.breakBlockTag($el, 'video');}else if (s.tagName === 'IMG') {this.linkify.breakBlockTag($el, 'image');}else if (s.tagName === 'A'){this.core.callback('insertedLink', $el);}return $el;}, this));setTimeout($.proxy(function(){this.code.sync();this.core.callback('linkify', $objects);}, this), 100);},breakBlockTag: function($el, type){var breaked = this.utils.breakBlockTag();if (breaked === false){return;}var $newBlock = $el;if (type === 'image'){$newBlock = $('<figure />').append($el);}if (breaked.type === 'start'){breaked.$block.before($newBlock);}else{breaked.$block.after($newBlock);}if (type === 'image'){this.caret.after($newBlock);}},convertVideoLinks: function(html){var iframeStart = '<div class="' + this.opts.videoContainerClass + ' redactor-linkify-object"><iframe class="redactor-linkify-object" width="500" height="281" src="';var iframeEnd = '" frameborder="0" allowfullscreen></iframe></div>';if (html.match(this.opts.regexps.linkyoutube)){html = html.replace(this.opts.regexps.linkyoutube, iframeStart + '//www.youtube.com/embed/$1' + iframeEnd);}if (html.match(this.opts.regexps.linkvimeo)){html = html.replace(this.opts.regexps.linkvimeo, iframeStart + '//player.vimeo.com/video/$2' + iframeEnd);}return html;},convertImages: function(html){var matches = html.match(this.opts.regexps.linkimage);if (!matches){return html;}return html.replace(html, '<img src="' + matches + '" class="redactor-linkify-object" />');},convertLinks: function(html){var matches = html.match(this.opts.regexps.url);if (!matches){return html;}matches = $.grep(matches, function(v, k) { return $.inArray(v, matches) === k; });var length = matches.length;for (var i = 0; i < length; i++){var href = matches[i], text = href;var linkProtocol = (href.match(/(https?|ftp):\/\//i) !== null) ? '' : 'http://';if (text.length > this.opts.linkSize){text = text.substring(0, this.opts.linkSize) + '...';}if (text.search('%') === -1){text = decodeURIComponent(text);}var regexB = "\\b";if ($.inArray(href.slice(-1), ["/", "&", "="]) !== -1){regexB = "";}var regexp = new RegExp('(' + href.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&") + regexB + ')', 'g');html = html.replace(regexp, '<a href="' + linkProtocol + $.trim(href) + '" class="redactor-linkify-object">' + $.trim(text) + '</a>');}return html;}};},list: function(){return {toggle: function(cmd){if (this.utils.inBlocks(['table', 'td', 'th', 'tr'])){return;}var tag = (cmd === 'orderedlist' || cmd === 'ol') ? 'OL' : 'UL';cmd = (tag === 'OL') ? 'orderedlist' : 'unorderedlist';var $list = $(this.selection.current()).parentsUntil('.redactor-in', 'ul, ol').first();this.placeholder.hide();this.buffer.set();if ($list.length !== 0 && $list[0].tagName === tag && this.utils.isRedactorParent($list)){this.selection.save();$list.find('ul, ol').each(function(){var parent = $(this).closest('li');$(this).find('li').each(function(){$(parent).after(this);});});$list.find('ul, ol').remove();$list.find('li').each(function(){return $(this).replaceWith(function(){return $('<p />').append($(this).contents());});});$list.replaceWith(function(){return $(this).contents();});this.selection.restore();return;}this.selection.save();if ($list.length !== 0 && $list[0].tagName !== tag){$list.each($.proxy(function(i,s){this.utils.replaceToTag(s, tag);}, this));}else{document.execCommand('insert' + cmd);}this.selection.restore();var $insertedList = this.list.get();if (!$insertedList){if (!this.selection.block()){document.execCommand('formatblock', false, 'p');}return;}$insertedList.find('span').replaceWith(function(){return $(this).contents();});$insertedList.find(this.opts.inlineTags.join(',')).each(function(){$(this).removeAttr('style');});var $listParent = $insertedList.parent();if (this.utils.isRedactorParent($listParent) && $listParent[0].tagName !== 'LI' && this.utils.isBlock($listParent)){this.selection.save();$listParent.replaceWith($listParent.contents());this.selection.restore();}},get: function(){var current = this.selection.current();var $list = $(current).closest('ul, ol', this.core.editor()[0]);return ($list.length === 0) ? false : $list;},combineAfterAndBefore: function(block){var $prev = $(block).prev();var $next = $(block).next();var isEmptyBlock = (block && block.tagName === 'P' && (block.innerHTML === '<br>' || block.innerHTML === ''));var isBlockWrapped = ($prev.closest('ol, ul', this.core.editor()[0]).length === 1 && $next.closest('ol, ul', this.core.editor()[0]).length === 1);if (isEmptyBlock && isBlockWrapped){$prev.children('li').last().append(this.marker.get());$prev.append($next.contents());this.selection.restore();return true;}return false;}};},marker: function(){return {get: function(num){num = (typeof num === 'undefined') ? 1 : num;var marker = document.createElement('span');marker.id = 'selection-marker-' + num;marker.className = 'redactor-selection-marker';marker.innerHTML = this.opts.invisibleSpace;return marker;},html: function(num){return this.utils.getOuterHtml(this.marker.get(num));},find: function(num){num = (typeof num === 'undefined') ? 1 : num;return this.core.editor().find('span#selection-marker-' + num);},insert: function(){var sel = this.selection.get();var range = this.selection.range(sel);this.marker.insertNode(range, this.marker.get(1), true);if (range && range.collapsed === false){this.marker.insertNode(range, this.marker.get(2), false);}},remove: function(){this.core.editor().find('.redactor-selection-marker').each(this.marker.iterateRemove);},insertNode: function(range, node, collapse){var parent = this.selection.parent();if (range === null || $(parent).closest('.redactor-in').length === 0){return;}range = range.cloneRange();try {range.collapse(collapse);range.insertNode(node);}catch (e){this.focus.start();}},iterateRemove: function(i, el){var $el = $(el);var text = $el.text().replace(/\u200B/g, '');return (text === '') ? $el.remove() : $el.replaceWith(function() { return $(this).contents(); });}};},modal: function(){return {callbacks: {},templates: function(){this.opts.modal = {'image-edit': String()+ '<div class="redactor-modal-tab redactor-group" data-title="General">'+ '<div id="redactor-image-preview" class="redactor-modal-tab-side">'+ '</div>'+ '<div class="redactor-modal-tab-area">'+ '<section>'+ '<label>' + this.lang.get('title') + '</label>'+ '<input type="text" id="redactor-image-title" />'+ '</section>'+ '<section>'+ '<label>' + this.lang.get('caption') + '</label>'+ '<input type="text" id="redactor-image-caption" aria-label="' + this.lang.get('caption') + '" />'+ '</section>'+ '<section>'+ '<label>' + this.lang.get('link') + '</label>'+ '<input type="text" id="redactor-image-link" aria-label="' + this.lang.get('link') + '" />'+ '</section>'+ '<section>'+ '<label class="redactor-image-position-option">' + this.lang.get('image-position') + '</label>'+ '<select class="redactor-image-position-option" id="redactor-image-align" aria-label="' + this.lang.get('image-position') + '">'+ '<option value="none">' + this.lang.get('none') + '</option>'+ '<option value="left">' + this.lang.get('left') + '</option>'+ '<option value="center">' + this.lang.get('center') + '</option>'+ '<option value="right">' + this.lang.get('right') + '</option>'+ '</select>'+ '</section>'+ '<section>'+ '<label class="checkbox"><input type="checkbox" id="redactor-image-link-blank" aria-label="' + this.lang.get('link-in-new-tab') + '"> ' + this.lang.get('link-in-new-tab') + '</label>'+ '</section>'+ '<section>'+ '<button id="redactor-modal-button-action">' + this.lang.get('insert') + '</button>'+ '<button id="redactor-modal-button-cancel">' + this.lang.get('cancel') + '</button>'+ '<button id="redactor-modal-button-delete" class="redactor-modal-button-offset">' + this.lang.get('delete') + '</button>'+ '</section>'+ '</div>'+ '</div>','image': String()+ '<div class="redactor-modal-tab" data-title="Upload">'+ '<section>'+ '<div id="redactor-modal-image-droparea"></div>'+ '</section>'+ '</div>','file': String()+ '<div class="redactor-modal-tab" data-title="Upload">'+ '<section>'+ '<label>' + this.lang.get('filename') + ' <span class="desc">(' + this.lang.get('optional') + ')</span></label>'+ '<input type="text" id="redactor-filename" aria-label="' + this.lang.get('filename') + '" /><br><br>'+ '</section>'+ '<section>'+ '<div id="redactor-modal-file-upload"></div>'+ '</section>'+ '</div>','link': String()+ '<div class="redactor-modal-tab" data-title="General">'+ '<section>'+ '<label>URL</label>'+ '<input type="url" id="redactor-link-url" aria-label="URL" />'+ '</section>'+ '<section>'+ '<label>' + this.lang.get('text') + '</label>'+ '<input type="text" id="redactor-link-url-text" aria-label="' + this.lang.get('text') + '" />'+ '</section>'+ '<section>'+ '<label class="checkbox"><input type="checkbox" id="redactor-link-blank"> ' + this.lang.get('link-in-new-tab') + '</label>'+ '</section>'+ '<section>'+ '<button id="redactor-modal-button-action">' + this.lang.get('insert') + '</button>'+ '<button id="redactor-modal-button-cancel">' + this.lang.get('cancel') + '</button>'+ '</section>'+ '</div>'};$.extend(this.opts, this.opts.modal);},addCallback: function(name, callback){this.modal.callbacks[name] = callback;},addTemplate: function(name, template){this.opts.modal[name] = template;},getTemplate: function(name){return this.opts.modal[name];},getModal: function(){return this.$modalBody;},getActionButton: function(){return this.$modalBody.find('#redactor-modal-button-action');},getCancelButton: function(){return this.$modalBody.find('#redactor-modal-button-cancel');},getDeleteButton: function(){return this.$modalBody.find('#redactor-modal-button-delete');},load: function(templateName, title, width){if (typeof this.$modalBox !== 'undefined' && this.$modalBox.hasClass('open')){return;}this.modal.templateName = templateName;this.modal.width = width;this.modal.build();this.modal.enableEvents();this.modal.setTitle(title);this.modal.setDraggable();this.modal.setContent();if (typeof this.modal.callbacks[templateName] !== 'undefined'){this.modal.callbacks[templateName].call(this);}},show: function(){if (!this.detect.isDesktop()){document.activeElement.blur();}this.selection.save();this.modal.buildTabber();if (this.detect.isMobile()){this.modal.width = '96%';}setTimeout($.proxy(this.modal.buildWidth, this), 0);$(window).on('resize.redactor-modal', $.proxy(this.modal.buildWidth, this));this.$modalOverlay.redactorAnimation('fadeIn', {duration: 0.25});this.$modalBox.addClass('open').show();this.$modal.redactorAnimation('fadeIn', {timing: 'cubic-bezier(0.175, 0.885, 0.320, 1.105)'},$.proxy(function(){this.utils.saveScroll();this.utils.disableBodyScroll();this.core.callback('modalOpened', this.modal.templateName, this.$modal);$(document).off('focusin.modal');var $elements = this.$modal.find('input[type=text],input[type=url],input[type=email]');$elements.on('keydown.redactor-modal', $.proxy(this.modal.setEnter, this));}, this));},buildWidth: function(){var windowHeight = $(window).height();var windowWidth = $(window).width();var number = (typeof this.modal.width === 'number');if (!number && this.modal.width.match(/%$/)){this.$modal.css({ 'width': this.modal.width, 'margin-bottom': '16px' });}else if (parseInt(this.modal.width) > windowWidth){this.$modal.css({ 'width': '96%', 'margin-bottom': '2%' });}else{if (number){this.modal.width += 'px';}this.$modal.css({ 'width': this.modal.width, 'margin-bottom': '16px' });}var height = this.$modal.outerHeight();var top = (windowHeight/2 - height/2) + 'px';if (this.detect.isMobile()){top = '2%';}else if (height > windowHeight){top = '16px';}this.$modal.css('margin-top', top);},buildTabber: function(){this.modal.tabs = this.$modal.find('.redactor-modal-tab');if (this.modal.tabs.length < 2){return;}this.modal.$tabsBox = $('<div id="redactor-modal-tabber" />');$.each(this.modal.tabs, $.proxy(function(i,s){var a = $('<a href="#" rel="' + i + '" />').text($(s).attr('data-title'));a.on('click', $.proxy(this.modal.showTab, this));if (i === 0){a.addClass('active');}this.modal.$tabsBox.append(a);}, this));this.$modalBody.prepend(this.modal.$tabsBox);},showTab: function(e){e.preventDefault();var $el = $(e.target);var index = $el.attr('rel');this.modal.tabs.hide();this.modal.tabs.eq(index).show();$('#redactor-modal-tabber').find('a').removeClass('active');$el.addClass('active');return false;},setTitle: function(title){this.$modalHeader.html(title);},setContent: function(){this.$modalBody.html(this.modal.getTemplate(this.modal.templateName));this.modal.getCancelButton().on('mousedown', $.proxy(this.modal.close, this));},setDraggable: function(){if (typeof $.fn.draggable === 'undefined'){return;}this.$modal.draggable({ handle: this.$modalHeader });this.$modalHeader.css('cursor', 'move');},setEnter: function(e){if (e.which !== 13){return;}e.preventDefault();this.modal.getActionButton().click();},build: function(){this.modal.buildOverlay();this.$modalBox = $('<div id="redactor-modal-box"/>').hide();this.$modal = $('<div id="redactor-modal" role="dialog" />');this.$modalHeader = $('<div id="redactor-modal-header" />');this.$modalClose = $('<button type="button" id="redactor-modal-close" aria-label="' + this.lang.get('close') + '" />').html('&times;');this.$modalBody = $('<div id="redactor-modal-body" />');this.$modal.append(this.$modalHeader);this.$modal.append(this.$modalBody);this.$modal.append(this.$modalClose);this.$modalBox.append(this.$modal);this.$modalBox.appendTo(document.body);},buildOverlay: function(){this.$modalOverlay = $('<div id="redactor-modal-overlay">').hide();$('body').prepend(this.$modalOverlay);},enableEvents: function(){this.$modalClose.on('mousedown.redactor-modal', $.proxy(this.modal.close, this));$(document).on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));this.core.editor().on('keyup.redactor-modal', $.proxy(this.modal.closeHandler, this));this.$modalBox.on('click.redactor-modal', $.proxy(this.modal.close, this));},disableEvents: function(){this.$modalClose.off('mousedown.redactor-modal');$(document).off('keyup.redactor-modal');this.core.editor().off('keyup.redactor-modal');this.$modalBox.off('click§.redactor-modal');$(window).off('resize.redactor-modal');},closeHandler: function(e){if (e.which !== this.keyCode.ESC){return;}this.modal.close(false);},close: function(e){if (e){if ($(e.target).attr('id') !== 'redactor-modal-button-cancel' && e.target !== this.$modalClose[0] && e.target !== this.$modalBox[0]){return;}e.preventDefault();}if (!this.$modalBox){return;}this.selection.restore();this.modal.disableEvents();this.utils.enableBodyScroll();this.utils.restoreScroll();this.$modalOverlay.redactorAnimation('fadeOut', { duration: 0.4 }, $.proxy(function(){this.$modalOverlay.remove();}, this));this.$modal.redactorAnimation('fadeOut', {duration: 0.3,timing: 'cubic-bezier(0.175, 0.885, 0.320, 1.175)'}, $.proxy(function(){if (typeof this.$modalBox !== 'undefined'){this.$modalBox.remove();this.$modalBox = undefined;}$(document.body).css('overflow', this.modal.bodyOveflow);this.core.callback('modalClosed', this.modal.templateName);}, this));}};},observe: function(){return {load: function(){if (typeof this.opts.destroyed !== 'undefined'){return;}this.observe.links();this.observe.images();},isCurrent: function($el, $current){if (typeof $current === 'undefined'){$current = $(this.selection.current());}return $current.is($el) || $current.parents($el).length > 0;},toolbar: function(){this.observe.buttons();this.observe.dropdowns();},buttons: function(e, btnName){var current = this.selection.current();var parent = this.selection.parent();if (e !== false){this.button.setInactiveAll();}else{this.button.setInactiveAll(btnName);}if (e === false && btnName !== 'html'){if ($.inArray(btnName, this.opts.activeButtons) !== -1){this.button.toggleActive(btnName);}return;}if (!this.utils.isRedactorParent(current)){return;}if (this.utils.isCurrentOrParentHeader() || this.utils.isCurrentOrParent(['table', 'pre', 'blockquote', 'li'])){this.button.disable('horizontalrule');}else{this.button.enable('horizontalrule');}$.each(this.opts.activeButtonsStates, $.proxy(function(key, value){var parentEl = $(parent).closest(key, this.$editor[0]);var currentEl = $(current).closest(key, this.$editor[0]);if (parentEl.length !== 0 && !this.utils.isRedactorParent(parentEl)){return;}if (!this.utils.isRedactorParent(currentEl)){return;}if (parentEl.length !== 0 || currentEl.closest(key, this.$editor[0]).length !== 0){this.button.setActive(value);}}, this));},dropdowns: function(){var finded = $('<div />').html(this.selection.html()).find('a').length;var $current = $(this.selection.current());var isRedactor = this.utils.isRedactorParent($current);$.each(this.opts.observe.dropdowns, $.proxy(function(key, value){var observe = value.observe,element = observe.element,$item   = value.item,inValues = typeof observe['in'] !== 'undefined' ? observe['in'] : false,outValues = typeof observe.out !== 'undefined' ? observe.out : false;if (($current.closest(element).length > 0 && isRedactor) || (element === 'a' && finded !== 0)){this.observe.setDropdownProperties($item, inValues, outValues);}else{this.observe.setDropdownProperties($item, outValues, inValues);}}, this));},setDropdownProperties: function($item, addProperties, deleteProperties){if (deleteProperties && typeof deleteProperties.attr !== 'undefined'){this.observe.setDropdownAttr($item, deleteProperties.attr, true);}if (typeof addProperties.attr !== 'undefined'){this.observe.setDropdownAttr($item, addProperties.attr);}if (typeof addProperties.title !== 'undefined'){$item.find('span').text(addProperties.title);}},setDropdownAttr: function($item, properties, isDelete){$.each(properties, function(key, value){if (key === 'class'){if (!isDelete){$item.addClass(value);}else{$item.removeClass(value);}}else{if (!isDelete){$item.attr(key, value);}else{$item.removeAttr(key);}}});},addDropdown: function($item, btnName, btnObject){if (typeof btnObject.observe === "undefined"){return;}btnObject.item = $item;this.opts.observe.dropdowns.push(btnObject);},images: function(){if (this.opts.imageEditable){this.core.editor().addClass('redactor-layer-img-edit');this.core.editor().find('img').each($.proxy(function(i, img){var $img = $(img);$img.closest('a', this.$editor[0]).on('click', function(e) { e.preventDefault(); });this.image.setEditable($img);}, this));}},links: function(){if (this.opts.linkTooltip){this.core.editor().find('a').each($.proxy(function(i, s){var $link = $(s);if ($link.data('cached') !== true){$link.data('cached', true);$link.on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.showTooltip, this));}}, this));}},getTooltipPosition: function($link){return $link.offset();},showTooltip: function(e){var $el = $(e.target);if ($el[0].tagName === 'IMG'){return;}if ($el[0].tagName !== 'A'){$el = $el.closest('a', this.$editor[0]);}if ($el[0].tagName !== 'A'){return;}var $link = $el;var pos = this.observe.getTooltipPosition($link);var tooltip = $('<span class="redactor-link-tooltip"></span>');var href = $link.attr('href');if (href === undefined){href = '';}if (href.length > 24){href = href.substring(0, 24) + '...';}var aLink = $('<a href="' + $link.attr('href') + '" target="_blank" />').html(href).addClass('redactor-link-tooltip-action');var aEdit = $('<a href="#" />').html(this.lang.get('edit')).on('click', $.proxy(this.link.show, this)).addClass('redactor-link-tooltip-action');var aUnlink = $('<a href="#" />').html(this.lang.get('unlink')).on('click', $.proxy(this.link.unlink, this)).addClass('redactor-link-tooltip-action');tooltip.append(aLink).append(' | ').append(aEdit).append(' | ').append(aUnlink);var lineHeight = parseInt($link.css('line-height'), 10);var lineClicked = Math.ceil((e.pageY - pos.top)/lineHeight);var top = pos.top + lineClicked * lineHeight;tooltip.css({top: top + 'px',left: pos.left + 'px'});$('.redactor-link-tooltip').remove();$('body').append(tooltip);this.core.editor().on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));$(document).on('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));},closeAllTooltip: function(){$('.redactor-link-tooltip').remove();},closeTooltip: function(e){e = e.originalEvent || e;var target = e.target;var $parent = $(target).closest('a', this.$editor[0]);if ($parent.length !== 0 && $parent[0].tagName === 'A' && target.tagName !== 'A'){return;}else if ((target.tagName === 'A' && this.utils.isRedactorParent(target)) || $(target).hasClass('redactor-link-tooltip-action')){return;}this.observe.closeAllTooltip();this.core.editor().off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));$(document).off('touchstart.redactor.' + this.uuid + ' click.redactor.' + this.uuid, $.proxy(this.observe.closeTooltip, this));}};},offset: function(){return {get: function(node){var cloned = this.offset.clone(node);if (cloned === false){return 0;}var div = document.createElement('div');div.appendChild(cloned.cloneContents());div.innerHTML = div.innerHTML.replace(/<img(.*?[^>])>$/gi, 'i');var text = $.trim($(div).text()).replace(/[\t\n\r\n]/g, '').replace(/\u200B/g, '');return text.length;},clone: function(node){var sel = this.selection.get();var range = this.selection.range(sel);if (range === null && typeof node === 'undefined'){return false;}node = (typeof node === 'undefined') ? this.$editor : node;if (node === false){return false;}node = node[0] || node;var cloned = range.cloneRange();cloned.selectNodeContents(node);cloned.setEnd(range.endContainer, range.endOffset);return cloned;},set: function(start, end){end = (typeof end === 'undefined') ? start : end;if (!this.focus.is()){this.focus.start();}var sel = this.selection.get();var range = this.selection.range(sel);var node, offset = 0;var walker = document.createTreeWalker(this.$editor[0], NodeFilter.SHOW_TEXT, null, null);while ((node = walker.nextNode()) !== null){offset += node.nodeValue.length;if (offset > start){range.setStart(node, node.nodeValue.length + start - offset);start = Infinity;}if (offset >= end){range.setEnd(node, node.nodeValue.length + end - offset);break;}}range.collapse(false);this.selection.update(sel, range);}};},paragraphize: function(){return {load: function(html){if (this.opts.paragraphize === false || this.opts.type === 'inline' || this.opts.type === 'pre'){return html;}if (html === '' || html === '<p></p>'){return this.opts.emptyHtml;}html = html + "\n";this.paragraphize.safes = [];this.paragraphize.z = 0;html = html.replace(/(<br\s?\/?>){1,}\n?<\/blockquote>/gi, '</blockquote>');html = html.replace(/<\/pre>/gi, "</pre>\n\n");html = html.replace(/<p>\s<br><\/p>/gi, '<p></p>');html = this.paragraphize.getSafes(html);html = html.replace('<br>', "\n");html = this.paragraphize.convert(html);html = this.paragraphize.clear(html);html = this.paragraphize.restoreSafes(html);html = html.replace(new RegExp('<br\\s?/?>\n?<(' + this.opts.paragraphizeBlocks.join('|') + ')(.*?[^>])>', 'gi'), '<p><br /></p>\n<$1$2>');return $.trim(html);},getSafes: function(html){var $div = $('<div />').append(html);$div.find('blockquote p').replaceWith(function(){return $(this).append('<br />').contents();});$div.find(this.opts.paragraphizeBlocks.join(', ')).each($.proxy(function(i,s){this.paragraphize.z++;this.paragraphize.safes[this.paragraphize.z] = s.outerHTML;return $(s).replaceWith("\n#####replace" + this.paragraphize.z + "#####\n\n");}, this));$div.find('span.redactor-selection-marker').each($.proxy(function(i,s){this.paragraphize.z++;this.paragraphize.safes[this.paragraphize.z] = s.outerHTML;return $(s).replaceWith("\n#####replace" + this.paragraphize.z + "#####\n\n");}, this));return $div.html();},restoreSafes: function(html){$.each(this.paragraphize.safes, function(i,s){s = (typeof s !== 'undefined') ? s.replace(/\$/g, '&#36;') : s;html = html.replace('#####replace' + i + '#####', s);});return html;},convert: function(html){html = html.replace(/\r\n/g, "xparagraphmarkerz");html = html.replace(/\n/g, "xparagraphmarkerz");html = html.replace(/\r/g, "xparagraphmarkerz");var re1 = /\s+/g;html = html.replace(re1, " ");html = $.trim(html);var re2 = /xparagraphmarkerzxparagraphmarkerz/gi;html = html.replace(re2, "</p><p>");var re3 = /xparagraphmarkerz/gi;html = html.replace(re3, "<br>");html = '<p>' + html + '</p>';html = html.replace("<p></p>", "");html = html.replace("\r\n\r\n", "");html = html.replace(/<\/p><p>/g, "</p>\r\n\r\n<p>");html = html.replace(new RegExp("<br\\s?/?></p>", "g"), "</p>");html = html.replace(new RegExp("<p><br\\s?/?>", "g"), "<p>");html = html.replace(new RegExp("<p><br\\s?/?>", "g"), "<p>");html = html.replace(new RegExp("<br\\s?/?></p>", "g"), "</p>");html = html.replace(/<p>&nbsp;<\/p>/gi, "");html = html.replace(/<p>\s?<br>&nbsp;<\/p>/gi, '');html = html.replace(/<p>\s?<br>/gi, '<p>');return html;},clear: function(html){html = html.replace(/<p>(.*?)#####replace(.*?)#####\s?<\/p>/gi, '<p>$1</p>#####replace$2#####');html = html.replace(/(<br\s?\/?>){2,}<\/p>/gi, '</p>');html = html.replace(new RegExp('</blockquote></p>', 'gi'), '</blockquote>');html = html.replace(new RegExp('<p></blockquote>', 'gi'), '</blockquote>');html = html.replace(new RegExp('<p><blockquote>', 'gi'), '<blockquote>');html = html.replace(new RegExp('<blockquote></p>', 'gi'), '<blockquote>');html = html.replace(new RegExp('<p><p ', 'gi'), '<p ');html = html.replace(new RegExp('<p><p>', 'gi'), '<p>');html = html.replace(new RegExp('</p></p>', 'gi'), '</p>');html = html.replace(new RegExp('<p>\\s?</p>', 'gi'), '');html = html.replace(new RegExp("\n</p>", 'gi'), '</p>');html = html.replace(new RegExp('<p>\t?\t?\n?<p>', 'gi'), '<p>');html = html.replace(new RegExp('<p>\t*</p>', 'gi'), '');return html;}};},paste: function(){return {init: function(e){this.rtePaste = true;var pre = (this.opts.type === 'pre' || this.utils.isCurrentOrParent('pre')) ? true : false;if (this.detect.isDesktop()){if (!this.paste.pre && this.opts.clipboardImageUpload && this.opts.imageUpload && this.paste.detectClipboardUpload(e)){if (this.detect.isIe()){setTimeout($.proxy(this.paste.clipboardUpload, this), 100);}return;}}this.utils.saveScroll();this.selection.save();this.paste.createPasteBox(pre);$(window).on('scroll.redactor-freeze', $.proxy(function(){$(window).scrollTop(this.saveBodyScroll);}, this));setTimeout($.proxy(function(){var html = this.paste.getPasteBoxCode(pre);this.buffer.set();this.selection.restore();this.utils.restoreScroll();var data = this.clean.getCurrentType(html);html = this.clean.onPaste(html, data);var returned = this.core.callback('paste', html);html = (typeof returned === 'undefined') ? html : returned;this.paste.insert(html, data);this.rtePaste = false;if (pre){this.clean.cleanPre();}$(window).off('scroll.redactor-freeze');}, this), 1);},getPasteBoxCode: function(pre){var html = (pre) ? this.$pasteBox.val() : this.$pasteBox.html();this.$pasteBox.remove();return html;},createPasteBox: function(pre){var css = { position: 'fixed', width: '1px', top: 0, left: '-9999px' };this.$pasteBox = (pre) ? $('<textarea>').css(css) : $('<div>').attr('contenteditable', 'true').css(css);this.paste.appendPasteBox();this.$pasteBox.focus();},appendPasteBox: function(){if (this.detect.isIe()){this.core.box().append(this.$pasteBox);}else{var $visibleModals = $('.modal-body:visible');if ($visibleModals.length > 0){$visibleModals.append(this.$pasteBox);}else{$('body').prepend(this.$pasteBox);}}},detectClipboardUpload: function(e){e = e.originalEvent || e;var clipboard = e.clipboardData;if (this.detect.isIe()){return true;}if (this.detect.isFirefox()){return false;}var types = clipboard.types;if (types.indexOf('public.tiff') !== -1){e.preventDefault();return false;}if (!clipboard.items || !clipboard.items.length){return;}var file = clipboard.items[0].getAsFile();if (file === null){return false;}var reader = new FileReader();reader.readAsDataURL(file);reader.onload = $.proxy(this.paste.insertFromClipboard, this);return true;},clipboardUpload: function(){var imgs = this.$editor.find('img');$.each(imgs, $.proxy(function(i,s){if (s.src.search(/^data\:image/i) === -1){return;}var formData = !!window.FormData ? new FormData() : null;if (!window.FormData){return;}this.upload.direct = true;this.upload.type = 'image';this.upload.url = this.opts.imageUpload;this.upload.callback = $.proxy(function(data){if (this.detect.isIe()){$(s).wrap($('<figure />'));}else{var $parent = $(s).parent();this.utils.replaceToTag($parent, 'figure');}s.src = data.url;this.core.callback('imageUpload', $(s), data);}, this);var blob = this.utils.dataURItoBlob(s.src);formData.append('clipboard', 1);formData.append(this.opts.imageUploadParam, blob);this.progress.show();this.upload.send(formData, false);this.code.sync();this.rtePaste = false;}, this));},insertFromClipboard: function(e){var formData = !!window.FormData ? new FormData() : null;if (!window.FormData){return;}this.upload.direct = true;this.upload.type = 'image';this.upload.url = this.opts.imageUpload;this.upload.callback = this.image.insert;var blob = this.utils.dataURItoBlob(e.target.result);formData.append('clipboard', 1);formData.append(this.opts.imageUploadParam, blob);this.progress.show();this.upload.send(formData, e);this.rtePaste = false;},insert: function(html, data){if (data.pre){this.insert.raw(html);}else if (data.text){this.insert.text(html);}else{this.insert.html(html, data);}if (this.detect.isFirefox() && this.opts.clipboardImageUpload){setTimeout($.proxy(this.paste.clipboardUpload, this), 100);}}};},placeholder: function(){return {enable: function(){setTimeout($.proxy(function(){return (this.placeholder.isEditorEmpty()) ? this.placeholder.show() : this.placeholder.hide();}, this), 5);},show: function(){this.core.editor().addClass('redactor-placeholder');},update: function(text){this.opts.placeholder = text;this.core.editor().attr('placeholder', text);},hide: function(){this.core.editor().removeClass('redactor-placeholder');},is: function(){return this.core.editor().hasClass('redactor-placeholder');},init: function(){if (!this.placeholder.enabled()){return;}if (!this.utils.isEditorRelative()){this.utils.setEditorRelative();}this.placeholder.build();this.placeholder.buildPosition();this.placeholder.enable();this.placeholder.enableEvents();},enabled: function(){return (this.opts.placeholder) ? this.core.element().attr('placeholder', this.opts.placeholder) : this.placeholder.isAttr();},enableEvents: function(){this.core.editor().on('keydown.redactor-placeholder.' + this.uuid, $.proxy(this.placeholder.enable, this));},disableEvents: function(){this.core.editor().off('.redactor-placeholder.' + this.uuid);},build: function(){this.core.editor().attr('placeholder', this.core.element().attr('placeholder'));},buildPosition: function(){var $style = $('<style />');$style.addClass('redactor-placeholder-style-tag');$style.html('#' + this.core.id() + '.redactor-placeholder::after ' + this.placeholder.getPosition());$('head').append($style);},getPosition: function(){return '{ top: ' + this.core.editor().css('padding-top') + '; left: ' + this.core.editor().css('padding-left') + '; }';},isEditorEmpty: function(){var html = $.trim(this.core.editor().html()).replace(/[\t\n]/g, '');var states = ['', '<p>​</p>', '<p>​<br></p>', this.opts.emptyHtmlRendered];return ($.inArray(html, states) !== -1);},isAttr: function(){return (typeof this.core.element().attr('placeholder') !== 'undefined' && this.core.element().attr('placeholder') !== '');},destroy: function(){this.core.editor().removeAttr('placeholder');this.placeholder.hide();this.placeholder.disableEvents();$('.redactor-placeholder-style-tag').remove();}};},progress: function(){return {$box: null,$bar: null,target: document.body,  show: function(){if (!this.progress.is()){this.progress.build();this.progress.$box.redactorAnimation('fadeIn');}else{this.progress.$box.show();}},hide: function(){if (this.progress.is()){this.progress.$box.redactorAnimation('fadeOut', { duration: 0.35 }, $.proxy(this.progress.destroy, this));}},update: function(value){this.progress.show();this.progress.$bar.css('width', value + '%');},is: function(){return (this.progress.$box === null) ? false : true;},build: function(){this.progress.$bar = $('<span />');this.progress.$box = $('<div id="redactor-progress" />');this.progress.$box.append(this.progress.$bar);$(this.progress.target).append(this.progress.$box);},destroy: function(){if (this.progress.is()){this.progress.$box.remove();}this.progress.$box = null;this.progress.$bar = null;}};},selection: function(){return {get: function(){if (window.getSelection){return window.getSelection();}else if (document.selection && document.selection.type !== "Control"){return document.selection;}return null;},range: function(sel){if (typeof sel === 'undefined'){sel = this.selection.get();}if (sel.getRangeAt && sel.rangeCount){return sel.getRangeAt(0);}return null;},is: function(){return (this.selection.isCollapsed()) ? false : true;},isRedactor: function(){var range = this.selection.range();if (range !== null){var el = range.startContainer.parentNode;if ($(el).hasClass('redactor-in') || $(el).parents('.redactor-in').length !== 0){return true;}}return false;},isCollapsed: function(){var sel = this.selection.get();return (sel === null) ? false : sel.isCollapsed;},update: function(sel, range){if (range === null){return;}sel.removeAllRanges();sel.addRange(range);},current: function(){var sel = this.selection.get();return (sel === null) ? false : sel.anchorNode;},parent: function(){var current = this.selection.current();return (current === null) ? false : current.parentNode;},block: function(node){node = node || this.selection.current();while (node){if (this.utils.isBlockTag(node.tagName)){return ($(node).hasClass('redactor-in')) ? false : node;}node = node.parentNode;}return false;},inline: function(node){node = node || this.selection.current();while (node){if (this.utils.isInlineTag(node.tagName)){return ($(node).hasClass('redactor-in')) ? false : node;}node = node.parentNode;}return false;},element: function(node){if (!node){node = this.selection.current();}while (node){if (node.nodeType === 1){if ($(node).hasClass('redactor-in')){return false;}return node;}node = node.parentNode;}return false;},prev: function(){var current = this.selection.current();return (current === null) ? false : this.selection.current().previousSibling;},next: function(){var current = this.selection.current();return (current === null) ? false : this.selection.current().nextSibling;},blocks: function(tag){var blocks = [];var nodes = this.selection.nodes(tag);$.each(nodes, $.proxy(function(i,node){if (this.utils.isBlock(node)){blocks.push(node);}}, this));var block = this.selection.block();if (blocks.length === 0 && block === false){return [];}else if (blocks.length === 0 && block !== false){return [block];}else{return blocks;}},inlines: function(tag){var inlines = [];var nodes = this.selection.nodes(tag);$.each(nodes, $.proxy(function(i,node){if (this.utils.isInline(node)){inlines.push(node);}}, this));var inline = this.selection.inline();if (inlines.length === 0 && inline === false){return [];}else if (inlines.length === 0 && inline !== false){return [inline];}else{return inlines;}},nodes: function(tag){var filter = (typeof tag === 'undefined') ? [] : (($.isArray(tag)) ? tag : [tag]);var sel = this.selection.get();var range = this.selection.range(sel);if (this.utils.isCollapsed()){return [this.selection.current()];}else{var node = range.startContainer;var endNode = range.endContainer;if (node === endNode){return [this.selection.parent()];}var nodes = [];while (node && node !== endNode){nodes.push(node = this.selection.nextNode(node));}node = range.startContainer;while (node && node !== range.commonAncestorContainer){nodes.unshift(node);node = node.parentNode;}var resultNodes = [];$.each(nodes, function(i,s){if (s){var tagName = (s.nodeType !== 1) ? false : s.tagName.toLowerCase();if ($(s).hasClass('redactor-script-tag, redactor-selection-marker')){return;}else if (tagName && filter.length !== 0 && $.inArray(tagName, filter) === -1){return;}else{resultNodes.push(s);}}});return (resultNodes.length === 0) ? [] : resultNodes;}},nextNode: function(node){if (node.hasChildNodes()){return node.firstChild;}else{while (node && !node.nextSibling){node = node.parentNode;}if (!node){return null;}return node.nextSibling;}},save: function(){this.marker.insert();this.savedSel = this.core.editor().html();},restore: function(removeMarkers){var node1 = this.marker.find(1);var node2 = this.marker.find(2);if (this.detect.isFirefox()){this.core.editor().focus();}if (node1.length !== 0 && node2.length !== 0){this.caret.set(node1, node2);}else if (node1.length !== 0){this.caret.start(node1);}else{this.core.editor().focus();}if (removeMarkers !== false){this.marker.remove();this.savedSel = false;}},saveInstant: function(){var el = this.core.editor()[0];var doc = el.ownerDocument, win = doc.defaultView;var sel = win.getSelection();if (!sel.getRangeAt || !sel.rangeCount){return;}var range = sel.getRangeAt(0);var selectionRange = range.cloneRange();selectionRange.selectNodeContents(el);selectionRange.setEnd(range.startContainer, range.startOffset);var start = selectionRange.toString().length;this.saved = {start: start,end: start + range.toString().length,node: range.startContainer};return this.saved;},restoreInstant: function(saved){if (typeof saved === 'undefined' && !this.saved){return;}this.saved = (typeof saved !== 'undefined') ? saved : this.saved;var $node = this.core.editor().find(this.saved.node);if ($node.length !== 0 && $node.text().trim().replace(/\u200B/g, '').length === 0){   try {var range = document.createRange();range.setStart($node[0], 0);var sel = window.getSelection();sel.removeAllRanges();sel.addRange(range);}catch(e) {}return;}var el = this.core.editor()[0];var doc = el.ownerDocument, win = doc.defaultView;var charIndex = 0, range = doc.createRange();range.setStart(el, 0);range.collapse(true);var nodeStack = [el], node, foundStart = false, stop = false;while (!stop && (node = nodeStack.pop())){if (node.nodeType == 3){var nextCharIndex = charIndex + node.length;if (!foundStart && this.saved.start >= charIndex && this.saved.start <= nextCharIndex){range.setStart(node, this.saved.start - charIndex);foundStart = true;}if (foundStart && this.saved.end >= charIndex && this.saved.end <= nextCharIndex){range.setEnd(node, this.saved.end - charIndex);stop = true;}charIndex = nextCharIndex;}else{var i = node.childNodes.length;while (i--){nodeStack.push(node.childNodes[i]);}}}var sel = win.getSelection();sel.removeAllRanges();sel.addRange(range);},node: function(node){$(node).prepend(this.marker.get(1));$(node).append(this.marker.get(2));this.selection.restore();},all: function(){this.core.editor().focus();var sel = this.selection.get();var range = this.selection.range(sel);range.selectNodeContents(this.core.editor()[0]);this.selection.update(sel, range);},remove: function(){this.selection.get().removeAllRanges();},replace: function(html){this.insert.html(html);},text: function(){return this.selection.get().toString();},html: function(){var html = '';var sel = this.selection.get();if (sel.rangeCount){var container = document.createElement('div');var len = sel.rangeCount;for (var i = 0; i < len; ++i){container.appendChild(sel.getRangeAt(i).cloneContents());}html = this.clean.onGet(container.innerHTML);}return html;},extractEndOfNode: function(node){var sel = this.selection.get();var range = this.selection.range(sel);var clonedRange = range.cloneRange();clonedRange.selectNodeContents(node);clonedRange.setStart(range.endContainer, range.endOffset);return clonedRange.extractContents();},removeMarkers: function(){this.marker.remove();},marker: function(num){return this.marker.get(num);},markerHtml: function(num){return this.marker.html(num);}};},shortcuts: function(){return {hotkeysSpecialKeys: {8: "backspace", 9: "tab", 10: "return", 13: "return", 16: "shift", 17: "ctrl", 18: "alt", 19: "pause",20: "capslock", 27: "esc", 32: "space", 33: "pageup", 34: "pagedown", 35: "end", 36: "home",37: "left", 38: "up", 39: "right", 40: "down", 45: "insert", 46: "del", 59: ";", 61: "=",96: "0", 97: "1", 98: "2", 99: "3", 100: "4", 101: "5", 102: "6", 103: "7",104: "8", 105: "9", 106: "*", 107: "+", 109: "-", 110: ".", 111 : "/",112: "f1", 113: "f2", 114: "f3", 115: "f4", 116: "f5", 117: "f6", 118: "f7", 119: "f8",120: "f9", 121: "f10", 122: "f11", 123: "f12", 144: "numlock", 145: "scroll", 173: "-", 186: ";", 187: "=",188: ",", 189: "-", 190: ".", 191: "/", 192: "`", 219: "[", 220: "\\", 221: "]", 222: "'"},hotkeysShiftNums: {"`": "~", "1": "!", "2": "@", "3": "#", "4": "$", "5": "%", "6": "^", "7": "&","8": "*", "9": "(", "0": ")", "-": "_", "=": "+", ";": ": ", "'": "\"", ",": "<",".": ">",  "/": "?",  "\\": "|"},init: function(e, key){if (this.opts.shortcuts === false){if ((e.ctrlKey || e.metaKey) && (key === 66 || key === 73)){e.preventDefault();}return false;}else{$.each(this.opts.shortcuts, $.proxy(function(str, command){this.shortcuts.build(e, str, command);}, this));}},build: function(e, str, command){var handler = $.proxy(function(){this.shortcuts.buildHandler(command);}, this);var keys = str.split(',');var len = keys.length;for (var i = 0; i < len; i++){if (typeof keys[i] === 'string'){this.shortcuts.handler(e, $.trim(keys[i]), handler);}}},buildHandler: function(command){var func;if (command.func.search(/\./) !== '-1'){func = command.func.split('.');if (typeof this[func[0]] !== 'undefined'){this[func[0]][func[1]].apply(this, command.params);}}else{this[command.func].apply(this, command.params);}},handler: function(e, keys, origHandler){keys = keys.toLowerCase().split(" ");var special = this.shortcuts.hotkeysSpecialKeys[e.keyCode];var character = String.fromCharCode(e.which).toLowerCase();var modif = "", possible = {};$.each([ "alt", "ctrl", "meta", "shift"], function(index, specialKey){if (e[specialKey + 'Key'] && special !== specialKey){modif += specialKey + '+';}});if (special){possible[modif + special] = true;}if (character){possible[modif + character] = true;possible[modif + this.shortcuts.hotkeysShiftNums[character]] = true;if (modif === "shift+"){possible[this.shortcuts.hotkeysShiftNums[character]] = true;}}var len = keys.length;for (var i = 0; i < len; i++){if (possible[keys[i]]){e.preventDefault();return origHandler.apply(this, arguments);}}}};},storage: function(){return {data: [],add: function(data){data.status = true;data.url = decodeURI(this.link.removeSelfHostFromUrl(data.url));this.storage.data[data.url] = data;},status: function(url, status){this.storage.data[decodeURI(url)].status = status;},observe: function(){var _this = this;var $images = this.core.editor().find('[data-image]');$images.each(function(i, s){_this.storage.add({ type: 'image', node: s, url: s.src, id: $(s).attr('data-image') });});var $files = this.core.editor().find('[data-file]');$files.each(function(i, s){_this.storage.add({ type: 'file', node: s, url: s.href, id: $(s).attr('data-file') });});var $s3 = this.core.editor().find('[data-s3]');$s3.each(function(i, s){var url = (s.tagName === 'IMG') ? s.src : s.href;_this.storage.add({ type: 's3', node: s, url: url, id: $(s).attr('data-s3') });});},changes: function(){for (var key in this.storage.data){var data = this.storage.data[key];var attr = (data.node.tagName === 'IMG') ? 'src' : 'href';var $el = this.core.editor().find('[data-' + data.type + '][' + attr + '="' + data.url + '"]');if ($el.length === 0){this.storage.status(data.url, false);}else{this.storage.status(data.url, true);}}return this.storage.data;}};},toolbar: function(){return {build: function(){this.button.hideButtons();this.button.hideButtonsOnMobile();this.$toolbar = this.toolbar.createContainer();this.toolbar.append();this.button.$toolbar = this.$toolbar;this.button.setFormatting();this.button.load(this.$toolbar);this.toolbar.setFixed();},createContainer: function(){return $('<ul>').addClass('redactor-toolbar').attr({ 'id': 'redactor-toolbar-' + this.uuid, 'role': 'toolbar' });},append: function(){if (this.opts.toolbarExternal){this.$toolbar.addClass('redactor-toolbar-external');$(this.opts.toolbarExternal).html(this.$toolbar);}else{if (this.opts.type === 'textarea'){this.$box.prepend(this.$toolbar);}else{this.$element.before(this.$toolbar);}}},setFixed: function(){if (!this.opts.toolbarFixed || this.opts.toolbarExternal){return;}if (this.opts.toolbarFixedTarget !== document){var $el = $(this.opts.toolbarFixedTarget);this.toolbarOffsetTop = ($el.length === 0) ? 0 : this.core.box().offset().top - $el.offset().top;}var late = (this.core.box().closest('.modal-body').length !== 0) ? 1000 : 0;setTimeout($.proxy(function(){var self = this;this.toolbar.observeScroll(false);if (this.detect.isDesktop()){$(this.opts.toolbarFixedTarget).on('scroll.redactor.' + this.uuid, function(){if (self.core.editor().height() < 100 || self.placeholder.isEditorEmpty()){return;}self.toolbar.observeScroll();});}else{$(this.opts.toolbarFixedTarget).on('scroll.redactor.' + this.uuid, function(){if (self.core.editor().height() < 100 || self.placeholder.isEditorEmpty()){return;}self.core.toolbar().hide();clearTimeout($.data(this, "scrollCheck"));$.data(this, "scrollCheck", setTimeout(function(){self.core.toolbar().show();self.toolbar.observeScroll();}, 250) );});}}, this), late);},getBoxTop: function(){return (this.opts.toolbarFixedTarget === document) ? this.core.box().offset().top : this.toolbar.toolbarOffsetTop;},observeScroll: function(start){var tolerance = 0;if (start !== false){tolerance = (this.opts.toolbarFixedTarget === document) ? 20 : 0;}var scrollTop = $(this.opts.toolbarFixedTarget).scrollTop();var boxTop = this.toolbar.getBoxTop();if (scrollTop === boxTop){return;}if ((scrollTop + this.opts.toolbarFixedTopOffset + tolerance) > boxTop){this.toolbar.observeScrollEnable(scrollTop, boxTop);}else{this.toolbar.observeScrollDisable();}},observeScrollResize: function(){this.$toolbar.css({width: this.core.box().innerWidth(),left: this.core.box().offset().left});},observeScrollEnable: function(scrollTop, boxTop){if (typeof this.fullscreen !== 'undefined' && this.fullscreen.isOpened === false){this.toolbar.observeScrollDisable();return;}var end = boxTop + this.core.box().outerHeight() - 32;var width = this.core.box().innerWidth();var position = (this.detect.isDesktop()) ? 'fixed' : 'absolute';var top = (this.detect.isDesktop()) ? this.opts.toolbarFixedTopOffset : ($(this.opts.toolbarFixedTarget).scrollTop() - boxTop + this.opts.toolbarFixedTopOffset);var left = (this.detect.isDesktop()) ? this.core.box().offset().left : 0;if (this.opts.toolbarFixedTarget !== document){ position = 'absolute'; top = this.opts.toolbarFixedTopOffset + $(this.opts.toolbarFixedTarget).scrollTop() - boxTop; left = 0;}this.$toolbar.addClass('toolbar-fixed-box');this.$toolbar.css({position: position,width: width,top: top,left: left});if (scrollTop > end){$('.redactor-dropdown-' + this.uuid + ':visible').hide();}this.toolbar.setDropdownsFixed();this.$toolbar.css('visibility', (scrollTop < end) ? 'visible' : 'hidden');$(window).on('resize.redactor-toolbar.' + this.uuid, $.proxy(this.toolbar.observeScrollResize, this));},observeScrollDisable: function(){this.$toolbar.css({position: 'relative',width: 'auto',top: 0,left: 0,visibility: 'visible'});this.toolbar.unsetDropdownsFixed();this.$toolbar.removeClass('toolbar-fixed-box');$(window).off('resize.redactor-toolbar.' + this.uuid);},setDropdownsFixed: function(){var position = (this.opts.toolbarFixedTarget === document && this.detect.isDesktop()) ? 'fixed' : 'absolute';this.toolbar.setDropdownPosition(position);},unsetDropdownsFixed: function(){this.toolbar.setDropdownPosition('absolute');},setDropdownPosition: function(position){var self = this;$('.redactor-dropdown-' + this.uuid).each(function(){var $el = $(this);var $button = self.button.get($el.attr('rel'));var top = (position === 'fixed') ? self.opts.toolbarFixedTopOffset : $button.offset().top;$el.css({ position: position, top: ($button.innerHeight() + top) + 'px' });});}};},upload: function(){return {init: function(id, url, callback){this.upload.direct = false;this.upload.callback = callback;this.upload.url = url;this.upload.$el = $(id);this.upload.$droparea = $('<div id="redactor-droparea" />');this.upload.$placeholdler = $('<div id="redactor-droparea-placeholder" />').text(this.lang.get('upload-label'));this.upload.$input = $('<input type="file" name="file" />');this.upload.$placeholdler.append(this.upload.$input);this.upload.$droparea.append(this.upload.$placeholdler);this.upload.$el.append(this.upload.$droparea);this.upload.$droparea.off('redactor.upload');this.upload.$input.off('redactor.upload');this.upload.$droparea.on('dragover.redactor.upload', $.proxy(this.upload.onDrag, this));this.upload.$droparea.on('dragleave.redactor.upload', $.proxy(this.upload.onDragLeave, this));this.upload.$input.on('change.redactor.upload', $.proxy(function(e){e = e.originalEvent || e;this.upload.traverseFile(this.upload.$input[0].files[0], e);}, this));this.upload.$droparea.on('drop.redactor.upload', $.proxy(function(e){e.preventDefault();this.upload.$droparea.removeClass('drag-hover').addClass('drag-drop');this.upload.onDrop(e);}, this));},directUpload: function(file, e){this.upload.direct = true;this.upload.traverseFile(file, e);},onDrop: function(e){e = e.originalEvent || e;var files = e.dataTransfer.files;if (this.opts.multipleImageUpload){var len = files.length;for (var i = 0; i < len; i++){this.upload.traverseFile(files[i], e);}}else{this.upload.traverseFile(files[0], e);}},traverseFile: function(file, e){if (this.opts.s3){this.upload.setConfig(file);this.uploads3.send(file, e);return;}var formData = !!window.FormData ? new FormData() : null;if (window.FormData){this.upload.setConfig(file);var name = (this.upload.type === 'image') ? this.opts.imageUploadParam : this.opts.fileUploadParam;formData.append(name, file);}this.progress.show();this.core.callback('uploadStart', e, formData);this.upload.send(formData, e);},setConfig: function(file){this.upload.getType(file);if (this.upload.direct){this.upload.url = (this.upload.type === 'image') ? this.opts.imageUpload : this.opts.fileUpload;this.upload.callback = (this.upload.type === 'image') ? this.image.insert : this.file.insert;}},getType: function(file){this.upload.type = (this.opts.imageTypes.indexOf(file.type) === -1) ? 'file' : 'image';if (this.opts.imageUpload === null && this.opts.fileUpload !== null){this.upload.type = 'file';}},getHiddenFields: function(obj, fd){if (obj === false || typeof obj !== 'object'){return fd;}$.each(obj, $.proxy(function(k, v){if (v !== null && v.toString().indexOf('#') === 0){v = $(v).val();}fd.append(k, v);}, this));return fd;},send: function(formData, e){if (this.upload.type === 'image'){formData = this.utils.appendFields(this.opts.imageUploadFields, formData);formData = this.utils.appendForms(this.opts.imageUploadForms, formData);formData = this.upload.getHiddenFields(this.upload.imageFields, formData);}else{formData = this.utils.appendFields(this.opts.fileUploadFields, formData);formData = this.utils.appendForms(this.opts.fileUploadForms, formData);formData = this.upload.getHiddenFields(this.upload.fileFields, formData);}var xhr = new XMLHttpRequest();xhr.open('POST', this.upload.url);xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");xhr.onreadystatechange = $.proxy(function(){if (xhr.readyState === 4){var data = xhr.responseText;data = data.replace(/^\[/, '');data = data.replace(/\]$/, '');var json;try{json = (typeof data === 'string' ? JSON.parse(data) : data);}catch(err){json = { error: true };}this.progress.hide();if (!this.upload.direct){this.upload.$droparea.removeClass('drag-drop');}this.upload.callback(json, this.upload.direct, e);}}, this);xhr.send(formData);},onDrag: function(e){e.preventDefault();this.upload.$droparea.addClass('drag-hover');},onDragLeave: function(e){e.preventDefault();this.upload.$droparea.removeClass('drag-hover');},clearImageFields: function(){this.upload.imageFields = {};},addImageFields: function(name, value){this.upload.imageFields[name] = value;},removeImageFields: function(name){delete this.upload.imageFields[name];},clearFileFields: function(){this.upload.fileFields = {};},addFileFields: function(name, value){this.upload.fileFields[name] = value;},removeFileFields: function(name){delete this.upload.fileFields[name];}};},uploads3: function(){return {send: function(file, e){this.uploads3.executeOnSignedUrl(file, $.proxy(function(signedURL){this.uploads3.sendToS3(file, signedURL, e);}, this));},executeOnSignedUrl: function(file, callback){var xhr = new XMLHttpRequest();var mark = (this.opts.s3.search(/\?/) === -1) ? '?' : '&';xhr.open('GET', this.opts.s3 + mark + 'name=' + file.name + '&type=' + file.type, true);if (xhr.overrideMimeType){xhr.overrideMimeType('text/plain; charset=x-user-defined');}var that = this;xhr.onreadystatechange = function(e){if (this.readyState === 4 && this.status === 200){that.progress.show();callback(decodeURIComponent(this.responseText));}};xhr.send();},createCORSRequest: function(method, url){var xhr = new XMLHttpRequest();if ("withCredentials" in xhr){xhr.open(method, url, true);}else if (typeof XDomainRequest !== "undefined"){xhr = new XDomainRequest();xhr.open(method, url);}else{xhr = null;}return xhr;},sendToS3: function(file, url, formData){var xhr = this.uploads3.createCORSRequest('PUT', url);if (!xhr){return;}xhr.onload = $.proxy(function(){var json;this.progress.hide();if (xhr.status !== 200){json = { error: true };this.upload.callback(json, this.upload.direct, xhr);return;}var s3file = url.split('?');if (!s3file[0]){ return false;}if (!this.upload.direct){this.upload.$droparea.removeClass('drag-drop');}json = { url: s3file[0], id: s3file[0], s3: true };if (this.upload.type === 'file'){var arr = s3file[0].split('/');json.name = arr[arr.length-1];}this.upload.callback(json, this.upload.direct, e);}, this);xhr.onerror = function() {};xhr.upload.onprogress = function(e) {};xhr.setRequestHeader('Content-Type', file.type);xhr.setRequestHeader('x-amz-acl', 'public-read');xhr.send(formData);}};},utils: function(){return {isEmpty: function(html){html = (typeof html === 'undefined') ? this.core.editor().html() : html;html = html.replace(/[\u200B-\u200D\uFEFF]/g, '');html = html.replace(/&nbsp;/gi, '');html = html.replace(/<\/?br\s?\/?>/g, '');html = html.replace(/\s/g, '');html = html.replace(/^<p>[^\W\w\D\d]*?<\/p>$/i, '');html = html.replace(/<iframe(.*?[^>])>$/i, 'iframe');html = html.replace(/<source(.*?[^>])>$/i, 'source');html = html.replace(/<[^\/>][^>]*><\/[^>]+>/gi, '');html = html.replace(/<[^\/>][^>]*><\/[^>]+>/gi, '');html = $.trim(html);return html === '';},isElement: function(obj){try {return obj instanceof HTMLElement;}catch(e){return (typeof obj === "object") && (obj.nodeType === 1) && (typeof obj.style === "object") && (typeof obj.ownerDocument === "object");}},strpos: function(haystack, needle, offset){var i = haystack.indexOf(needle, offset);return i >= 0 ? i : false;},dataURItoBlob: function(dataURI){var byteString;if (dataURI.split(',')[0].indexOf('base64') >= 0){byteString = atob(dataURI.split(',')[1]);}else{byteString = unescape(dataURI.split(',')[1]);}var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];var ia = new Uint8Array(byteString.length);for (var i = 0; i < byteString.length; i++){ia[i] = byteString.charCodeAt(i);}return new Blob([ia], { type:mimeString });},getOuterHtml: function(el){return $('<div>').append($(el).eq(0).clone()).html();},cloneAttributes: function(from, to){from = from[0] || from;to = $(to);var attrs = from.attributes;var len = attrs.length;while (len--){var attr = attrs[len];to.attr(attr.name, attr.value);}return to;},breakBlockTag: function(){var block = this.selection.block();if (!block){return false;}var isEmpty = this.utils.isEmpty(block.innerHTML);var tag = block.tagName.toLowerCase();if (tag === 'pre' || tag === 'li' || tag === 'td' || tag === 'th'){return false;}if (!isEmpty && this.utils.isStartOfElement(block)){return { $block: $(block), $next: $(block).next(), type: 'start' };}else if (!isEmpty && this.utils.isEndOfElement(block)){return { $block: $(block), $next: $(block).next(), type: 'end' };}else{var endOfNode = this.selection.extractEndOfNode(block);var $nextPart = $('<' + tag + ' />').append(endOfNode);$nextPart = this.utils.cloneAttributes(block, $nextPart);$(block).after($nextPart);return { $block: $(block), $next: $nextPart, type: 'break' };}},inBlocks: function(tags){tags = ($.isArray(tags)) ? tags : [tags];var blocks = this.selection.blocks();var len = blocks.length;var contains = false;for (var i = 0; i < len; i++){if (blocks[i] !== false){var tag = blocks[i].tagName.toLowerCase();if ($.inArray(tag, tags) !== -1){contains = true;}}}return contains;},inInlines: function(tags){tags = ($.isArray(tags)) ? tags : [tags];var inlines = this.selection.inlines();var len = inlines.length;var contains = false;for (var i = 0; i < len; i++){var tag = inlines[i].tagName.toLowerCase();if ($.inArray(tag, tags) !== -1){contains = true;}}return contains;},isTag: function(current, tag){var element = $(current).closest(tag, this.core.editor()[0]);if (element.length === 1){return element[0];}return false;},isBlock: function(block){if (block === null){return false;}block = block[0] || block;return block && this.utils.isBlockTag(block.tagName);},isBlockTag: function(tag){return (typeof tag === 'undefined') ? false : this.reIsBlock.test(tag);},isInline: function(inline){inline = inline[0] || inline;return inline && this.utils.isInlineTag(inline.tagName);},isInlineTag: function(tag){return (typeof tag === 'undefined') ? false : this.reIsInline.test(tag);},isRedactorParent: function(el){if (!el){return false;}if ($(el).parents('.redactor-in').length === 0 || $(el).hasClass('redactor-in')){return false;}return el;},isCurrentOrParentHeader: function(){return this.utils.isCurrentOrParent(['H1', 'H2', 'H3', 'H4', 'H5', 'H6']);},isCurrentOrParent: function(tagName){var parent = this.selection.parent();var current = this.selection.current();if ($.isArray(tagName)){var matched = 0;$.each(tagName, $.proxy(function(i, s){if (this.utils.isCurrentOrParentOne(current, parent, s)){matched++;}}, this));return (matched === 0) ? false : true;}else{return this.utils.isCurrentOrParentOne(current, parent, tagName);}},isCurrentOrParentOne: function(current, parent, tagName){tagName = tagName.toUpperCase();return parent && parent.tagName === tagName ? parent : current && current.tagName === tagName ? current : false;},isEditorRelative: function(){var position = this.core.editor().css('position');var arr = ['absolute', 'fixed', 'relative'];return ($.inArray(arr, position) !== -1);},setEditorRelative: function(){this.core.editor().addClass('redactor-relative');},getScrollTarget: function(){var $scrollTarget = $(this.opts.scrollTarget);return ($scrollTarget.length !== 0) ? $scrollTarget : $(document);},freezeScroll: function(){this.freezeScrollTop = this.utils.getScrollTarget().scrollTop();this.utils.getScrollTarget().scrollTop(this.freezeScrollTop);},unfreezeScroll: function(){if (typeof this.freezeScrollTop === 'undefined'){return;}this.utils.getScrollTarget().scrollTop(this.freezeScrollTop);},saveScroll: function(){this.tmpScrollTop = this.utils.getScrollTarget().scrollTop();},restoreScroll: function(){if (typeof this.tmpScrollTop === 'undefined'){return;}this.utils.getScrollTarget().scrollTop(this.tmpScrollTop);},isStartOfElement: function(element){if (typeof element === 'undefined'){element = this.selection.block();if (!element){return false;}}return (this.offset.get(element) === 0) ? true : false;},isEndOfElement: function(element){if (typeof element === 'undefined'){element = this.selection.block();if (!element){return false;}}var text = $.trim($(element).text()).replace(/[\t\n\r\n]/g, '').replace(/\u200B/g, '');var offset = this.offset.get(element);return (offset === text.length) ? true : false;},removeEmptyAttr: function(el, attr){var $el = $(el);if (typeof $el.attr(attr) === 'undefined'){return true;}if ($el.attr(attr) === ''){$el.removeAttr(attr);return true;}return false;},replaceToTag: function(node, tag){var replacement;$(node).replaceWith(function(){replacement = $('<' + tag + ' />').append($(this).contents());for (var i = 0; i < this.attributes.length; i++){replacement.attr(this.attributes[i].name, this.attributes[i].value);}return replacement;});return replacement;},isSelectAll: function(){return this.selectAll;},enableSelectAll: function(){this.selectAll = true;},disableSelectAll: function(){this.selectAll = false;},disableBodyScroll: function(){var $body = $('html');var windowWidth = window.innerWidth;if (!windowWidth){var documentElementRect = document.documentElement.getBoundingClientRect();windowWidth = documentElementRect.right - Math.abs(documentElementRect.left);}var isOverflowing = document.body.clientWidth < windowWidth;var scrollbarWidth = this.utils.measureScrollbar();$body.css('overflow', 'hidden');if (isOverflowing){$body.css('padding-right', scrollbarWidth);}},measureScrollbar: function(){var $body = $('body');var scrollDiv = document.createElement('div');scrollDiv.className = 'redactor-scrollbar-measure';$body.append(scrollDiv);var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;$body[0].removeChild(scrollDiv);return scrollbarWidth;},enableBodyScroll: function(){$('html').css({ 'overflow': '', 'padding-right': '' });$('body').remove('redactor-scrollbar-measure');},appendFields: function(appendFields, data){if (!appendFields){return data;}else if (typeof appendFields === 'object'){$.each(appendFields, function(k, v){if (v !== null && v.toString().indexOf('#') === 0){v = $(v).val();}data.append(k, v);});return data;}var $fields = $(appendFields);if ($fields.length === 0){return data;}else{var str = '';$fields.each(function(){data.append($(this).attr('name'), $(this).val());});return data;}},appendForms: function(appendForms, data){if (!appendForms){return data;}var $forms = $(appendForms);if ($forms.length === 0){return data;}else{var formData = $forms.serializeArray();$.each(formData, function(z,f){data.append(f.name, f.value);});return data;}},isRgb: function(str){return (str.search(/^rgb/i) === 0);},rgb2hex: function(rgb){rgb = rgb.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return (rgb && rgb.length === 4) ? "#" +("0" + parseInt(rgb[1],10).toString(16)).slice(-2) +("0" + parseInt(rgb[2],10).toString(16)).slice(-2) +("0" + parseInt(rgb[3],10).toString(16)).slice(-2) : '';},isCollapsed: function(){return this.selection.isCollapsed();},isMobile: function(){return this.detect.isMobile();},isDesktop: function(){return this.detect.isDesktop();},isPad: function(){return this.detect.isIpad();}};},browser: function(){return {webkit: function(){return this.detect.isWebkit();},ff: function(){return this.detect.isFirefox();},ie: function(){return this.detect.isIe();}};}};$(window).on('load.tools.redactor', function(){$('[data-tools="redactor"]').redactor();});Redactor.prototype.init.prototype = Redactor.prototype;})(jQuery);(function($){$.fn.redactorAnimation = function(animation, options, callback){return this.each(function(){new redactorAnimation(this, animation, options, callback);});};function redactorAnimation(element, animation, options, callback){var opts = {duration: 0.5,iterate: 1,delay: 0,prefix: 'redactor-',timing: 'linear'};this.animation = animation;this.slide = (this.animation === 'slideDown' || this.animation === 'slideUp');this.$element = $(element);this.prefixes = ['', '-moz-', '-o-animation-', '-webkit-'];this.queue = [];if (typeof options === 'function'){callback = options;this.opts = opts;}else{this.opts = $.extend(opts, options);}if (this.slide){this.$element.height(this.$element.height());}this.init(callback);}redactorAnimation.prototype = {init: function(callback){this.queue.push(this.animation);this.clean();if (this.animation === 'show'){this.opts.timing = 'linear';this.$element.removeClass('hide').show();if (typeof callback === 'function'){callback(this);}}else if (this.animation === 'hide'){this.opts.timing = 'linear';this.$element.hide();if (typeof callback === 'function'){callback(this);}}else{this.animate(callback);}},animate: function(callback){this.$element.addClass('redactor-animated').css('display', '').removeClass('hide');this.$element.addClass(this.opts.prefix + this.queue[0]);this.set(this.opts.duration + 's', this.opts.delay + 's', this.opts.iterate, this.opts.timing);var _callback = (this.queue.length > 1) ? null : callback;this.complete('AnimationEnd', $.proxy(function(){if (this.$element.hasClass(this.opts.prefix + this.queue[0])){this.clean();this.queue.shift();if (this.queue.length){this.animate(callback);}}}, this), _callback);},set: function(duration, delay, iterate, timing){var len = this.prefixes.length;while (len--){this.$element.css(this.prefixes[len] + 'animation-duration', duration);this.$element.css(this.prefixes[len] + 'animation-delay', delay);this.$element.css(this.prefixes[len] + 'animation-iteration-count', iterate);this.$element.css(this.prefixes[len] + 'animation-timing-function', timing);}},clean: function(){this.$element.removeClass('redactor-animated');this.$element.removeClass(this.opts.prefix + this.queue[0]);this.set('', '', '', '');},complete: function(type, make, callback){this.$element.one(type.toLowerCase() + ' webkit' + type + ' o' + type + ' MS' + type, $.proxy(function(){if (typeof make === 'function'){make();}if (typeof callback === 'function'){callback(this);}var effects = ['fadeOut', 'slideUp', 'zoomOut', 'slideOutUp', 'slideOutRight', 'slideOutLeft'];if ($.inArray(this.animation, effects) !== -1){this.$element.css('display', 'none');}if (this.slide){this.$element.css('height', '');}}, this));}};})(jQuery);(function($){$.Redactor.prototype.source = function(){return {init: function(){var button = this.button.addFirst('html', 'HTML');this.button.setIcon(button, '<i class="re-icon-html"></i>');this.button.addCallback(button, this.source.toggle);var style = {'width': '100%','margin': '0','background': '#1d1d1d','box-sizing': 'border-box','color': '#ccc','font-size': '15px','outline': 'none','padding': '20px','line-height': '24px','font-family': 'Consolas, Menlo, Monaco, "Courier New", monospace'};this.source.$textarea = $('<textarea />');this.source.$textarea.css(style).hide();if (this.opts.type === 'textarea'){this.core.box().append(this.source.$textarea);}else{this.core.box().after(this.source.$textarea);}this.core.element().on('destroy.callback.redactor', $.proxy(function(){this.source.$textarea.remove();}, this));},toggle: function(){if (this.source.$textarea.hasClass('open')){this.source.hide();}else{this.source.show();this.source.$textarea.on('keyup.redactor-source', $.proxy(function(){var html = this.source.$textarea.val();this.core.callback('change', html);}, this));}},setCaretOnShow: function(){this.source.offset = this.offset.get();var scroll = $(window).scrollTop();varwidth = this.core.editor().innerWidth();var height = this.core.editor().innerHeight();this.source.start = 0;this.source.end = 0;var $editorDiv = $("<div/>").append($.parseHTML(this.core.editor().html(), document, true));var $selectionMarkers = $editorDiv.find("span.redactor-selection-marker");if ($selectionMarkers.length > 0){var editorHtml = $editorDiv.html().replace(/&amp;/g, '&');if ($selectionMarkers.length === 1){this.source.start = this.utils.strpos(editorHtml, $editorDiv.find("#selection-marker-1").prop("outerHTML"));this.source.end = this.source.start;}else if ($selectionMarkers.length === 2){this.source.start = this.utils.strpos(editorHtml, $editorDiv.find("#selection-marker-1").prop("outerHTML"));this.source.end = this.utils.strpos(editorHtml, $editorDiv.find("#selection-marker-2").prop("outerHTML")) - $editorDiv.find("#selection-marker-1").prop("outerHTML").toString().length;}}},setCaretOnHide: function(html){this.source.start = this.source.$textarea.get(0).selectionStart;this.source.end = this.source.$textarea.get(0).selectionEnd;if (this.source.start > this.source.end && this.source.end > 0){var tempStart = this.source.end;var tempEnd = this.source.start;this.source.start = tempStart;this.source.end = tempEnd;}this.source.start = this.source.enlargeOffset(html, this.source.start);this.source.end = this.source.enlargeOffset(html, this.source.end);html = html.substr(0, this.source.start) + this.marker.html(1) + html.substr(this.source.start);if (this.source.end > this.source.start){var markerLength = this.marker.html(1).toString().length;html = html.substr(0, this.source.end + markerLength) + this.marker.html(2) + html.substr(this.source.end + markerLength);}return html;},hide: function(){this.source.$textarea.removeClass('open').hide();this.source.$textarea.off('.redactor-source');var code = this.source.$textarea.val();code = this.paragraphize.load(code);code = this.source.setCaretOnHide(code);code = code.replace('&amp;<span id="selection-marker-1" class="redactor-selection-marker">​</span>', '<span id="selection-marker-1" class="redactor-selection-marker">​</span>&amp;');this.code.start(code);this.button.enableAll();this.core.editor().show().focus();this.selection.restore();this.placeholder.enable();this.core.callback('visual');},show: function(){this.selection.save();this.source.setCaretOnShow();var height = this.core.editor().height();var code = this.code.get();code = this.core.callback('source', code);this.core.editor().hide();this.button.disableAll('html');this.source.$textarea.val(code).height(height).addClass('open').show();this.source.$textarea.on('keyup.redactor-source', $.proxy(function(){if (this.opts.type === 'textarea'){this.core.textarea().val(this.source.$textarea.val());}}, this));this.marker.remove();$(window).scrollTop(scroll);if (this.source.$textarea[0].setSelectionRange){this.source.$textarea[0].setSelectionRange(this.source.start, this.source.end);}this.source.$textarea[0].scrollTop = 0;setTimeout($.proxy(function(){this.source.$textarea.focus();}, this), 0);},enlargeOffset: function(html, offset){var htmlLength = html.length;var c = 0;if (html[offset] === '>'){c++;}else{for(var i = offset; i <= htmlLength; i++){c++;if (html[i] === '>'){break;}else if (html[i] === '<' || i === htmlLength){c = 0;break;}}}return offset + c;}};};})(jQuery);(function($){$.Redactor.prototype.imagemanager = function(){return {langs: {en: {"upload": "Upload","choose": "Choose"}},init: function(){if (!this.opts.imageManagerJson){return;}this.modal.addCallback('image', this.imagemanager.load);},load: function(){var $box = $('<div style="overflow: auto; height: 300px; display: none;" class="redactor-modal-tab" data-title="Choose">');this.modal.getModal().append($box);$.ajax({dataType: "json",cache: false,url: this.opts.imageManagerJson,success: $.proxy(function(data){$.each(data, $.proxy(function(key, val){var thumbtitle = '';if (typeof val.title !== 'undefined'){thumbtitle = val.title;}var img = $('<img src="' + val.thumb + '"  data-params="' + encodeURI(JSON.stringify(val)) + '" style="width: 100px; height: 75px; cursor: pointer;" />');$box.append(img);$(img).click($.proxy(this.imagemanager.insert, this));}, this));}, this)});},insert: function(e){var $el = $(e.target);var json = $.parseJSON(decodeURI($el.attr('data-params')));this.image.insert(json, null);}};};})(jQuery);class Router{constructor(){this.filters = null;window.onpopstate = this.history;}load(url,viewName,data,block,id){var url = new URL(location.origin + url);if(block)url.searchParams.set('block',block);if(window.screen.height > 900 && window.screen.height < 999)url.searchParams.set('limit',9);else if(window.screen.height > 1000)url.searchParams.set('limit',13);http.action = function(){if(block){$(block).html(http.response);}else{$('main').html(http.response);}$('main .load').on('click',function(event){router.get(this.get('href'),this.get('view'),false,this.get('item-id'));event.preventDefault();event.stopPropagation();return false;});if(viewName){if(view)view = undefined;view = eval(viewName.title());if(id)view = new view(id);else{view = new view();}}return false;};var href = url.pathname + url.search;var state = {'href':href,'view':viewName,'block':block};if(id)state.id = id;if(data){if(data instanceof FormData){state.data = {};for(item of data.entries()){state.data[item[0]] = item[1];}http.post(href,data);}else if(data && data instanceof Object){http.post(href,data);state.data = data;}}else{http.get(href);}history.pushState(state,'Title',state.href);}get(link,view,block,id){this.load(link,view,0,block,id);}post(link,view,data,block){this.load(link,view,data,block);}history(event){if(event.state){var state = event.state;state.href = router.checkState(state);if(state.view && state.view == 'reload' && !$(state.block).length)state.view = 'list';http.action = function(){if(state.block && $(state.block).length)$(state.block).html(http.response);else{$('main').html(http.response);}if(state.view){if(view)view = undefined;view = eval(state.view.title());if(state.id)view = new view(state.id);else{view = new view();}}if(state.view == 'edit'){autocomplete(window.jQuery);}$('.load').on('click',function(event){router.get(this.get('href'),this.get('view'),false,this.get('item-id'));event.preventDefault();event.stopPropagation();return false;});if(view.url){for(key of view.url.searchParams.entries()){if($(`#filters #${key[0]}`).length)$(`#filters #${key[0]}`)[0].value = key[1];}}};if(state.data && state.data instanceof Object)http.post(state.href,state.data);else{http.get(state.href);}}}checkState(state){var url = new URL(location.origin + state.href);if(state.block && !$(state.block).length){url.searchParams.delete('block');}return url.pathname + url.search;}}templates = {address: function(){if(view.address)return `<input type="text" name="address" value="${view.address}" placeholder="Адрес" id="id_address">`;else{return `<input type="text" name="address" value="" placeholder="Адрес" id="id_address">`;}},variants: function(items){result = '';for(item of items){result += `<div class="variant" value="${item.id}">${item.address}</div>`;}return result;},departaments: function(items,type){options = '<option value="-----" selected disabled>-----</option>';for(item in items){options += `<option value="${item}">${items[item]}</option>`;}return `<select autocomplete="off" id="id_${type}" name="${type}">${options}</select>`;},cart_new_item: function(){return `<div><div class="remove"></div></div><div class="image"></div><div class="name"><input type="text" name="name" value="" placeholder="Поиск" autocomplete="off"><div class="variants"></div></div><div><input type="text" name="qty" value="1"></div><div><input type="text" name="price" value=""></div><div class="total"></div><div class="store"></div>`;},add: function(item){return `<div><div class="remove" item-id=${item.get('item-id')}></div></div><div class="image"></div><div class="name"><a href="${item.get('href')}" target="_blank">${item.text()}</a></div><div><input type="text" name="qty" value="1"></div><div><input type="text" name="price" opt="${item.get('opt')}" value="${item.get('price')}"></div><div class="total">${item.get('price')} грн.</div><div class="store">${item.get('storage')}</div>`;},product: function(json){return `<div><div class="remove" item-id="${json.id}"></div></div><div class="name"><a href="http://${BASE_URL}/${json.slug}" target="_blank">${json.name}</a></div><div><input type="text" name="qty" value="1"></div><div><input type="text" name="price" value="${json.price}"></div><div class="total">${json.total} грн.</div><div class="storage">${json.storage}</div>`;}};function category(){$('#pic img').on('click',function(){input = $('#pic input')[0];input.on('change',function(){file = this.files[0];reader = new FileReader();reader.onload = function(e){image = $('#pic img')[0];image.src = e.target.result;};reader.readAsDataURL(file);});input.click();});$('#pic .remove').on('click',function(){if(confirm('Точн?')){http.func = function(){if(http.json.result){$('#pic img')[0].src = '/media/data/no_image_new.jpg';}};http.get('/category/pic/'+this.get('item-id')+'/delete');}});$('#delete').on('click',function(){if(confirm('Вы уверены что хотите удалить это?')){url = '/'+this.get('model')+'/delete/'+this.get('item-id');http.func = function(){if(http.json.result){load('/category/list','categories');}};http.get(url);}});$('main form *').on('change select input',function(){$('#save').removeAttr('disabled');});$('#id_name').on('input',function(){$('h1').text(this.value);});$('#save').on('click',function(){if(!this.get('disabled')){http.func = function(){if(http.json.result){http.alert('Сохранено успешно.');if(http.json.href){location.href = http.json.href;categories();}}else{errors = '';for(error in http.json.errors){errors += error + '<br>' + http.json.errors[error] + '<br>';}errors += http.json.nonferrs + '<br>';http.alert(errors);}};url = '/' + this.get('model') + '/category/save/' + this.get('item-id');http.post(url,$('#item form').serialize());}});$('#browse').on('click',function(){if(!this.get('slug')){http.alert('Нету URL');return false;}else{location.href = this.get('slug');}});jQuery('#id_description').redactor({plugins: ['source'],imageUpload: '/redactor/upload/image/'});$('#proms .ui-icon-trash').on('click',function(){prom = this;http.func = function(){if(http.json.result){prom.parent().remove();}};http.get('/pc/delete/'+this.get('item-id'));});$('#prom').on('keypress input paste',function(event){if(this.value.length >= 3){input = this;if(window.div){div.remove();}http.func = function(){div = create('div');div.set('class','result');for(i=0;i<http.json.length;i++){item = create('div');item.html(http.json[i]['repr']);item.id = http.json[i]['pk'];item.on('click',function(){input.value = this.first().text();input.name = this.id;div.remove();});div.append(item);};input.parent().append(div);};http.get('/ajax_select/ajax_lookup/prom?term='+this.value);}});$('#promid').on('keypress',function(event){if(event.keyCode == 13){input = this;data = new FormData();data.append('prom',$('#prom').name);data.append('prom_category_id',input.value);data.append('category',$('#save').get('item-id'));http.func = function(){if(http.json.result){div = create('div');div.set('class','prom results_on_deck');x = create('span');x.set('class','ui-icon ui-icon-trash');x.set('item-id',http.json.id);x.html('X');x.on('click',function(){prom = this;http.func = function(){if(http.json.result){prom.parent().remove();}};http.get('/pc/delete/'+this.get('item-id'));});prom_id = create('span');prom_id.html(' '+$('#prom').value);prom = create('span');prom.html(' '+input.value);div.append(x);div.append(prom_id);div.append(prom);$('#proms').append(div);$('#prom').name = '';$('#prom').value = '';input.value = '';}};http.post('/prom/save',data);}});}class View{constructor(){this.deleteButton = $('#delete');$('svg').on('mouseover',function(){this.set('fill','#888');});$('svg').on('mouseout',function(){this.set('fill','#aaa');});}static variants(div,model,action){div.find('input').on('paste keydown click',function(event){if(event.keyCode == 13){var item = div.find('.variants .active')[0];if(item){evnt = {};evnt.target = item;action(evnt);}event.stopPropagation();return false;}if(event.keyCode == 38){if(!vactive){vactive = div.find('.variants')[0].last();vactive.addClass('active');}else{vactive.removeClass('active');if(vactive.prev()){vactive = vactive.prev();}else{vactive = div.find('.variants')[0].last();}vactive.addClass('active');}return false;}if(event.keyCode == 40){if(!vactive){vactive = div.find('.variants')[0].first();vactive.addClass('active');}else{vactive.removeClass('active');if(vactive.next()){vactive = vactive.next();}else{vactive = div.find('.variants')[0].first();}vactive.addClass('active');}return false;}if(timeout)clearTimeout(timeout);var input = this;timeout = setTimeout(function() {if(input.value && input.value.length >= 3){http.action = function(){var variants = div.find('.variants')[0];variants.html(http.text);variants.show();variants.find('div').on('click',action);};http.get(`/autocomplete/${model}/${input.value}`);}}, 500);event.stopPropagation();return false;});}}function login(){$('body').on('keypress',function(event){if(event.keyCode == 13){login(event);}});$('#login').on('click',function(){login();});function login(){http.action = function(){if(http.json && http.json.next)location.href = http.json.next;else if(http.errors){http.alert(http.errors);}};data = $('#login-form').serialize();data.append('next',location.pathname);http.post('/user/signin/',data);}}class Edit extends View{constructor(id){super();this.id = id;this.saveButton = $('#save');this.saveButton.on('click',this.save);this.deleteButton.on('click',this.delete);$('main form *').on('change select input',function(){$('#save').removeAttr('disabled');});$('#id_name,#id_user-name').on('input',function(){$('h1').text(this.value)});autocomplete(window.jQuery);try{this.active = $('label[for="'+$('.tab:checked')[0].get('id')+'"]')[0];this.active.addClass('active');$('#item-menu label').on('click',this.menu);}catch(e){}try{this.activeLang = $('label[for="'+$('.meta .tab:checked')[0].get('id')+'"]')[0];this.activeLang.addClass('active');$('.fieldset.meta label').on('click',this.langMenu);}catch(e){}}menu(){if(view.active)view.active.removeClass('active');view.active = this;this.addClass('active');}langMenu(){if(view.activeLang)view.activeLang.removeClass('active');view.activeLang = this;this.addClass('active');}delete(){if(confirm('Удалить?')){http.action = function(){if(http.json.result){router.get(`/${view.model}/list`,'List');}};http.get(`/delete/${view.model}/${view.id}`);}}save(){if(!view.saveButton.get('disabled')){http.action = function(){if(http.json.result){http.alert('Сохранено успешно.');if(http.json && http.json.href){router.get(http.json.href,http.json.view,0,http.json.id);}view.extraAction();}else{var errors = '';for(var error in http.json.errors){errors += error + '<br>' + http.json.errors[error] + '<br>';}errors += http.json.nonferrs + '<br>';http.alert(errors,7000);}};if(view.id)var url = `/edit/${view.model}/${view.id}`;else{var url = `/add/${view.model}`;}http.post(url,$('#item form')[0].serializeJSON());}}extraAction(){}}class Image extends Edit{constructor(id){super(id);this.imageInput = $('#pic input')[0];$('#pic').on('click',function(){view.imageInput.click()});$('#pic .remove').on('click',this.removeImage);$('#pic input')[0].on('change',this.changeImage);}changeImage(){var file = this.files[0];var reader = new FileReader();reader.onload = function(e){var image = $('#pic img')[0];image.src = e.target.result;view.imageInput.set('value', e.target.result);};reader.readAsDataURL(file);}removeImage(event){if(confirm('Точн?')){$('#pic img')[0].src = '/media/data/no_image_new.jpg';view.imageInput.set('value','remove');$('#save').removeAttr('disabled');}event.stopPropagation();return false;}}class Brand extends Image{constructor(id){super(id);this.model = 'brand';jQuery('.meta textarea').redactor({plugins: ['source'],});}}var vactive;class Cart{constructor(){$('.remove').on('click',this.remove);$('#add-product').on('click',this.add);$('input[name="qty"], input[name="price"]').on('change',this.calculate_item);this.total = $('#total .sum')[0];this.discount = $('#discount .sum')[0];this.removeList = [];$('body').on('click',this.hide_variants);}hide_variants(){if($('#order-items .variants').length)$('#order-items .variants')[0].parent().parent().remove();}calculate(){var total = 0;var discount = 0;var items = $('#order-items .item');items.each(function(item){var qty = parseInt(item.find('input[name="qty"]')[0].value);var price = parseInt(item.find('input[name="price"]')[0].value);total += price * qty;discount += price * qty;});if(total > 5000){total = 0;discount = 0;items.each(function(item){var qty = parseInt(item.find('input[name="qty"]')[0].value);var price = parseInt(item.find('input[name="price"]')[0].value);var opt = parseInt(item.find('input[name="price"]')[0].get('opt'));total += opt * qty;discount += price * qty;});}if(discount > total){discount = discount - total;}else{discount = '0';}this.discount.text(discount);this.total.text(total);}calculate_item(){var item = this.parent().parent();var qty = parseInt(item.find('input[name="qty"]')[0].value);var price = parseInt(item.find('input[name="price"]')[0].value);item.find('.total').text(qty * price + ' грн.');view.cart.calculate();}remove(){view.cart.removeList.push(this.get('item-id'));this.parent().parent().remove();view.cart.calculate();$('#save').removeAttr('disabled');}add(event){var div = create('div');div.set('class','item visible');div.html(templates.cart_new_item());div.find('.remove').on('click',function(event){this.parent().parent().remove();event.stopPropagation();return false;});View.variants(div,'product',view.cart.save);$('#order-items').append(div);event.stopPropagation();return false;}save(event){var item = $('#order-items .variants')[0].parent().parent();var id = event.target.get('item-id');if($(`.item[product-id="${id}"]`).length){var qty = $(`.item[product-id="${id}"] input[name="qty"]`)[0];qty.value++;item.remove();}else{item.html(templates.add(event.target));item.find('.image')[0].html(event.target.get('image'));item.find('input[name="qty"], input[name="price"]').on('change',view.cart.calculate_item);item.set('product-id',event.target.get('item-id'));item.find('.remove').on('click',view.cart.remove);}item.removeClass('visible');view.cart.calculate();return false;}}class Category extends Image{constructor(id){super(id);this.model = 'category';jQuery('.meta textarea').redactor({plugins: ['source'],});$('#promList .ui-icon-trash').on('click',this.deleteProm);$('#prom').on('keypress input paste',this.addProm);$('#promid').on('keypress',this.renderProm);}renderProm(event){if(event.keyCode == 13){var div = create('div');var PromID = $('#prom').value;var template = `<span class="ui-icon ui-icon-trash">X</span><span>&nbsp;${PromID}</span><span>&nbsp;${this.value}</span><input type="hidden" name="proms[]" value="${PromID}|${this.value}">`;div.html(template);div.find('.ui-icon-trash')[0].on('click',view.deleteProm);$('#promList').append(div);$('#prom').value = '';this.value = '';}}addProm(event){if(this.value.length >= 3){var input = this;if(window.div){div.remove();}http.action = function(){var div = create('div');div.set('class','variants');for(var i=0;i<http.json.length;i++){var item = create('div');item.html(http.json[i]['repr']);item.id = http.json[i]['pk'];item.on('click',function(){input.value = this.first().text();input.name = this.id;$('.variants')[0].remove();});div.append(item);};input.parent().append(div);$('.variants').on('click',function(){this.remove()});};http.get('/ajax_select/ajax_lookup/prom?term='+this.value);}}deleteProm(){this.parent().remove();$('#save').removeAttr('disabled');}}class Page extends Edit{constructor(id){super(id);this.model = 'page';jQuery('.meta textarea').redactor({plugins: ['source'],});}}class City extends Edit{constructor(id){super(id);this.model = 'city';jQuery('.description textarea').redactor({plugins: ['source'],});}}class TigresCategory extends Edit{constructor(id){super(id);this.model = 'tigresCategory';}}class Featured extends Edit{constructor(id){super(id);this.model = 'featured';}}class Tigres extends Edit{constructor(id){super(id);this.model = 'tigres';}}class Site extends Edit{constructor(id){super(id);this.model = 'site';}}class GoogleFeed extends Edit{constructor(id){super(id);this.model = 'googleFeed';}}class Settings extends Edit{constructor(id){super(id);this.model = 'settings';}}class Language extends Image{constructor(id){super(id);this.model = 'language';}}class Percent extends Edit{constructor(id){super(id);this.model = 'percent';}}class BelesCategory extends Edit{constructor(id){super(id);this.model = 'belesCategory';}}class Review extends Edit{constructor(id){super(id);this.model = 'review';jQuery('#id_description').redactor({plugins: ['source'],});}}class Robots extends Edit{constructor(id){super(id);this.model = 'robots';}}class Sms extends Edit{constructor(id){super(id);this.model = 'sms';}}class Article extends Edit{constructor(id){super(id);this.model = 'article';jQuery('.meta textarea').redactor({plugins: ['source'],});}}class Slider extends Edit{constructor(id){super(id);this.model = 'slider';}}class Offer extends Edit{constructor(id){super(id);this.model = 'offer';}}class Special extends Edit{constructor(id){super(id);this.model = 'special';}}class User extends Edit{constructor(id){super(id);this.model = 'user';}}class Callback extends Edit{constructor(id){super(id);this.model = 'callback';}}class Attribute extends Edit{constructor(id){super(id);this.model = 'attribute';this.fgk = new OneToOne('value');}}class Prom extends Edit{constructor(id){super(id);this.model = 'prom';}}class Slug extends Edit{constructor(id){super(id);this.model = 'slug';}}class Redirect extends Edit{constructor(id){super(id);this.model = 'redirect';}}class OneToOne{constructor(model,field){this.model = model;$('#fgk .remove').on('click',this.remove);$('#fgk input').on('keypress input',this.add);}add(event){if(event.keyCode == 13){var value = this.value;if(value){var template = `<span class="ui-icon ui-icon-trash remove">X</span> <span class="tag">${value}</span><input type="hidden" name="${view.fgk.model}[]" value="${value}">`;var div = create('div');div.html(template);div.find('.remove')[0].on('click',view.fgk.remove);$('#id_fgk_on_deck').append(div);this.value = '';}}event.stopPropagation();return false;}remove(){this.parent().remove();$('#save').removeAttr('disabled');}}class Gallery{constructor(item){this.item = item;this.previewImage = $('#bigPhoto img')[0];this.fullSize = $('#bigPhoto');this.fullSize.on('click',function(){view.images.fullSize.hide();});this.stop = false;this.images = $('#images');$('#plus').on('click',this.add);$('#images .remove').on('click',this.remove);$('#images img').on('click',this.preview);jQuery('#images').sortable({placeholder: "state",items: "div:not(.not)",update: function(event){var ordering = {};var position = 1;$('#images .remove').each(function(elem){if(elem.get('item-id')){ordering[elem.get('item-id')] = position;position++;}});http.action = function(){};http.post(`/gallery/${view.id}/ordering`,ordering);},stop: function(){view.stop = true;}}).disableSelection();}preview(event){if(view.stop){view.stop = false;return;}var image = event.target;view.images.previewImage.set('src',image.get('original'));view.images.fullSize.css('display','flex');}remove(event){var parent = event.target.parent();var agree = confirm('Удалить картину?');if(this.get('item-id') && agree){http.action = function(){parent.remove();};http.get(`/delete/gallery/${this.get('item-id')}`);}else if(agree)parent.remove();event.stopPropagation();return false}add(){var input = create('input');input.set('type','file');input.hide();view.images.input = input;view.images.images.before(input,2);input.on('change',view.images.render);input.click();}render(){var file = this.files[0];var reader = new FileReader();reader.onload = function(e){var div = create('div');div.set('class','image ui-sortable-handle');div.html('<div class="remove"></div>');div.find('.remove')[0].on('click',view.images.remove);var image = create('img');image.src = e.target.result;image.set('original',e.target.result);image.on('click',view.images.preview);div.append(image);view.images.input.set('name','images');view.images.input.set('value',e.target.result);view.images.images.before(div,2);};reader.readAsDataURL(file);}}var timeout;class Order extends Edit{constructor(id){super(id);this.model = 'order';this.panel = $('#sms-panel');this.panelButtons = $('#sms-panel .buttons');this.cart = new Cart();this.address = $('#id_address').value;$('#save').on('click',this.save);$('#make-ttn').on('click',this.ttn);$('#sms').on('click',this.smsPanel);$('#sms-panel .buttons button').on('click',this.sms);$('#track').on('click',this.track);$('#id_delivery_type').on('change',this.delivery);$('#filter svg').on('click',this.showFilters);$('#filters *').on('click',function(event){event.stopPropagation();return false;});$('#filters').on('click',function(event){event.stopPropagation();return false;});$('#id_city').on('input keyup paste',this.city);var type = $('#id_delivery_type').value;if(type == 1 || type == 2){$('#city').show();$('#departament').show();}$('body').on('click',this.hide_variants);$('#id_city').on('click',function(event){var variants = $('#city .variants')[0];if(this.value && variants.children.length)variants.show();else{view.city(true);}event.stopPropagation();return false;});$('#id_departament').on('click',function(event){var variants = $('#departament .variants')[0];if(this.value && variants.children.length)variants.show();else{view.departament($('#id_delivery_type').value,$('input[name="city"]')[0].value);}event.stopPropagation();return false;});$('#copyFIO').on('click',this.copyFIO);}copyFIO(){var fio = `${$('#id_lname').value} ${$('#id_name').value} ${$('#id_sname').value}`;navigator.clipboard.writeText(fio).then(function() {/* clipboard successfully set */}, function() {/* clipboard write failed */});}hide_variants(){if($('#id_city').value && $('#city .variants')[0].style.display == 'block')$('#city .variants')[0].hide();if($('#id_departament').value && $('#departament .variants')[0].style.display == 'block')$('#departament .variants')[0].hide();}showFilters(event){var form = $('#filters');if(form.style.display == 'grid'){form.hide();}else{form.grid();}event.stopPropagation();return false;}delivery(){var type = $('#id_delivery_type').value;$('#city').hide();$('#departament').hide();$('input[name="city"]')[0].value = '';$('#id_city').value = '';$('input[name="departament"]')[0].value = '';$('#id_departament').value = '';if(type != 3 && $('#address') && !Array.isArray($('#address')))$('#address').remove();if(type == 1 || type == 2){$('#city').show();$('#departament').show();}if(type == 3){var div = create('div');var address = templates.address();div.html(address);div.set('id','address');$('#id_delivery_type').parent().after(div);}}city(click){if(timeout)clearTimeout(timeout);var type = $('#id_delivery_type').value;var city = $('#id_city').value;timeout = setTimeout(function(){if(city && city.length > 1){http.action = function(){$('#city').show();$('#city .variants')[0].clear();$('#city .variants')[0].html(templates.variants(http.json));$('#city .variant').on('click',function(){$('#id_city').value = this.text();$('input[name="city"]')[0].value = this.get('value');view.departament(type, this.get('value'));});for(var item of http.json){if(item.address == $('#id_city').value && !click){$('input[name="city"]')[0].value = item.id;view.departament(type, item.id);return;}}$('#city .variants')[0].show();};http.get(`/delivery/city/${type}/${city}`);}},500);}departament(type, city_id){http.action = function(){$('#departament').show();$('#departament .variants')[0].clear();$('#departament .variants')[0].show();$('#departament .variants')[0].html(templates.variants(http.json));$('#departament .variant').on('click',function(){$('#id_departament').value = this.text();$('input[name="departament"]')[0].value = this.get('value');});};http.get(`/delivery/departament/${type}/${city_id}`);}save(){var save = this;http.action = function(){if(http.json.result){view.cart.removeList = [];if(http.json.href){router.get(http.json.href,'order','',http.json.id);}else{http.alert('Сохранен успешно.',3000);}}else if(http.json.errors){var errors = '';for(var error in http.json.errors){errors += error + '<br>' + http.json.errors[error] + '<br>';}errors += http.json.nonferrs + '<br>';http.alert(errors,7000);}};if(!view.id){var url = '/add/order';}else{var url = '/edit/order/'+view.id;}var items = [];$('#order-items .item').each(function(item){var qty = parseInt(item.find('input[name="qty"]')[0].value);var price = parseInt(item.find('input[name="price"]')[0].value);items.push({id:item.get('product-id'),qty:qty,price:price});});var data = $('form').serializeJSON();data['items'] = items;data['remove'] = view.cart.removeList;http.post(url,data);}ttn(){http.action = function(){if(http.json.ref){/*win = window.open("https://my.novaposhta.ua/orders/printDocument/orders[]/"+http.json.ref+"/type/html/apiKey/a5d31efa7bc0f7b138a06a130d8e5327",'_blank');win.focus();win.print();*/$('#id_status').value = 8;http.alert('TTH создана')}};var data = new FormData();var order_data = $('#order').serialize();var ttn = $('#filters').serialize();for(var item of order_data){data.append(item[0],item[1]);};for(var item of ttn){data.append(item[0],item[1]);}data.append('total',$('#total .sum').text());http.post('/order/ttn',data);}smsPanel(event){view.panel.active();view.panelButtons.active();event.stopPropagation();}sms(){var summ = null;var delivery_type = $('#id_delivery_type');if(delivery_type.value == 3)summ = prompt('Введи сумму');if(delivery_type.value == 3 && !summ)return false;var type = this.get('id');if(type == 'ttn' && !$('#ttn_id').text()){http.alert('Создайте ТТН');return;}http.action = function(){if(http.json.result){http.alert('Отправлена.');}};if(summ)http.get(`/order/sms/${view.id}/${type}/${summ}`);else{http.get(`/order/sms/${view.id}/${type}`);}}track(){http.action = function(){http.render(http.json);};http.get(`/order/track/${view.id}`);}}class Product extends Edit{constructor(id){super(id);this.model = 'product';jQuery('#id_description').redactor({plugins: ['source'],imageUpload: '/redactor/upload/image/'});jQuery('.fieldset.meta textarea').redactor({plugins: ['source'],imageUpload: '/redactor/upload/image/'});this.images = new Gallery(this);this.fgk = new OneToOne('add_model');}extraAction(){if($('input[type="file"]').length){$('input[type="file"]').each(function(elem){elem.remove();});}}}class Storage extends Product{constructor(id){super(id);this.model = 'storage';}save(){super.save();}extraAction(){super.extraAction();var active = $('.load[model="product"]')[0];active.active();if(current)current.active();current = active;}}class Beles extends Product{constructor(id){super(id);this.model = 'beles';}}class Tag extends Image{constructor(id){super(id);this.model = 'tag';jQuery('.meta textarea').redactor({plugins: ['source'],});}}var timeout = false;class List extends View{constructor(){super();this.url = new URL(location.href);$('#list-all').on('click',this.showAll);$('#pagination .step-links a').on('click',this.pagination);$('#check-all').on('click',this.checkAll);$('#head a').on('click',this.ordering);$('#items-search input').on('input paste keypress',this.search);$('#delete').on('click',this.delete);$('#add').on('click',function(event){router.get(this.get('href'),this.get('view'));});$('#filters *,#filters').on('click',function(event){event.stopPropagation();});$('#filter svg').on('click',this.showFilters);$('#filters button').on('click',this.filter);$('#items-search .clear-search').on('click',this.clearSearch);}showAll(event){view.url.searchParams.set('all',true);var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');event.stopPropagation();event.preventDefault();return false;}clearSearch(){var input = this.prev();if(input.value){input.value = '';view.url.searchParams.delete(input.get('name'));var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');}this.hide();}filter(){var filters = $('#filters').serializeJSON();for(key of view.url.searchParams.keys()){view.url.searchParams.delete(key);}for(var key of Object.keys(filters)){view.url.searchParams.set(key,filters[key]);}router.get(view.url.pathname + view.url.search,'reload','#items');$('#filters').hide();}showFilters(event){var form = $('#filters');if(form.style.display == 'grid'){form.hide();}else{form.grid();}event.stopPropagation();}delete(){var checkboxes = $('input[type=checkbox]');if(checkboxes.length){var data = [];for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].checked && checkboxes[i].value*1){data.push(checkboxes[i].value);}}if(!data.length)return;else if(confirm('Are U sure?')){http.action = function(){if(http.json.result){for(i=0;i<checkboxes.length;i++){checkboxes[i].checked = false;}location.reload();}};http.post('/delete/'+this.get('model'),data);}}}ordering(){var ordering = this.get('ordering');if(!view.url.search.includes('o=-'))ordering = '-' + ordering;view.url.searchParams.set('o',ordering);var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');}search(){if(this.value){var input = this;if(timeout)clearTimeout(timeout);timeout = setTimeout(function(){input.next().show();if(input.value)view.url.searchParams.set(input.name,input.value);else{view.url.searchParams.delete(input.name);}var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');},500);}}checkAll(){var checkboxes = $('input[type=checkbox]');for(var i=0, n=checkboxes.length;i<n;i++) {checkboxes[i].checked = this.checked;}}pagination(event){view.url.searchParams.set('page',this.get('page'));var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');event.stopPropagation();}}class Reload{constructor(){this.url = new URL(location.href);$('#list-all').on('click',this.showAll);$('#pagination .step-links a').on('click',this.pagination);}pagination(event){view.url.searchParams.set('page',this.get('page'));var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');event.stopPropagation();}showAll(event){view.url.searchParams.set('all',true);var href = view.url.pathname + view.url.search;router.get(href,'reload','#items');event.stopPropagation();event.preventDefault();return false;}categoryAutocomplete(target){var category = $('#category');category.find('.variants')[0].hide();category.find('input')[0].value = target.text();}brandAutocomplete(target){var brand = $('#brand');brand.find('.variants')[0].hide();brand.find('input')[0].value = target.text();}}class CategoryList{constructor(){$('.parent-arrow').on('click',function(){var sub = this.parent().find('.sub')[0];if(sub.style.display == 'block'){this.css('background','url(/static/image/disclosure-right.png) no-repeat');sub.hide();}else{this.css('background','url(/static/image/disclosure-down.png) no-repeat');sub.show();}});jQuery('#categories .category').sortable({placeholder: "state",items: "div:not(.not)",update: function(event){var items = jQuery('#categories .category').sortable('toArray');log(items);},}).disableSelection();$('#add').on('click',function(event){router.get(this.get('href'),this.get('view'));});}}class GoogleFeedList extends List{    constructor(){        super();        View.variants($('#category'),'category',function(event){view.categoryAutocomplete(event.target)});        View.variants($('#brand'),'brand',function(event){view.brandAutocomplete(event.target)});        $('#addProducts').on('click',this.addProducts.bind(this));        $('#filters button').on('click',this.filter);    }    filter(){        var filters = $('#filters').serializeJSON();        for(key of view.url.searchParams.keys()){            view.url.searchParams.delete(key);        }        for(var key of Object.keys(filters)){            view.url.searchParams.set(key,filters[key]);        }        http.action = function(){            $('#items').html(http.response);        };        view.url.searchParams.set('block','reload');        view.url.searchParams.set('googlefeed__isnull','True');        view.url.searchParams.set('all',true);        http.get('/product/list' + view.url.search);        $('#filters').hide();    }    addProducts(){        http.action = function(){            if(http.json && http.json.result)                http.alert('Добавлено');        };        var items = [];        for(var item of $('.item input:checked'))            items.push(item.get('value'));        http.post('/addGoogleProducts',{'items':items});    }    categoryAutocomplete(target){        var category = $('#category');        category.find('.variants')[0].hide();        category.find('input')[0].value = target.text();    }    brandAutocomplete(target){        var brand = $('#brand');        brand.find('.variants')[0].hide();        brand.find('input')[0].value = target.text();    }}class ListOrder extends List{constructor(){super();$('#tracking button').on('click',this.tracking);$('#sms').on('click',this.sms);}sms(){http.action = function(){if(http.json.result)http.alert('SMS разошлись успешно.');};http.get('/order/mass_sms');}tracking(){http.action = function(){if(http.json.items){var items = http.json.items;for(var i in items){var item = items[i];var ul = create('ul');ul.html(`${i}:`);for(var value in item){var li = create('li');li.html(`${value}: ${item[value]}`);ul.append(li);}$('#tracking #result')[0].append(ul);}$('#tracking #result')[0].show();}else{http.alert('Нет таких заказов.');}};http.get('/order/tracking');}}var timeout;class ListProduct extends List{constructor(){super();View.variants($('#category'),'category',function(event){view.categoryAutocomplete(event.target)});View.variants($('#brand'),'brand',function(event){view.brandAutocomplete(event.target)});}categoryAutocomplete(target){var category = $('#category');category.find('.variants')[0].hide();category.find('input')[0].value = target.text();}brandAutocomplete(target){var brand = $('#brand');brand.find('.variants')[0].hide();brand.find('input')[0].value = target.text();}}